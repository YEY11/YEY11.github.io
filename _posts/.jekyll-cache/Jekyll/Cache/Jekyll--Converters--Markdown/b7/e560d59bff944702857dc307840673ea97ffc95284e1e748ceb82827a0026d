I"¨-<!-- æ•°å­¦å…¬å¼ -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>

<h1 id="lecture-14-è´å¶æ–¯å›å½’">Lecture 14 è´å¶æ–¯å›å½’</h1>
<h2 id="ä¸»è¦å†…å®¹">ä¸»è¦å†…å®¹</h2>
<ul>
  <li><strong>ç‚¹ä¼°è®¡æœªæ•è·åˆ°çš„ä¸ç¡®å®šæ€§</strong></li>
  <li><strong>è´å¶æ–¯æ–¹æ³•ä¿ç•™ä¸ç¡®å®šæ€§</strong></li>
  <li><strong>é¡ºåºè´å¶æ–¯æ›´æ–°</strong></li>
  <li><strong>å…±è½­å…ˆéªŒï¼ˆNormal-Normalï¼‰</strong></li>
  <li><strong>åˆ©ç”¨åéªŒåœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œè´å¶æ–¯é¢„æµ‹</strong></li>
</ul>

<h2 id="1-å›é¡¾è´å¶æ–¯">1. å›é¡¾è´å¶æ–¯</h2>
<h3 id="11-è®­ç»ƒ--ä¼˜åŒ–">1.1 è®­ç»ƒ = ä¼˜åŒ–ï¼Ÿ</h3>
<p><strong>å­¦ä¹ ä¸æ¨æ–­é˜¶æ®µï¼š</strong></p>
<ul>
  <li><strong><span style="color:steelblue">å¯¹äºåˆ†ç±»é—®é¢˜ï¼š</span></strong>
    <ul>
      <li>
        <p>å»ºæ¨¡ï¼ˆä»¥ Logistic å›å½’ä¸ºä¾‹ï¼‰</p>

        <script type="math/tex; mode=display">p(y|\boldsymbol x)=\text{sigmoid}(\boldsymbol x'\boldsymbol w)</script>
      </li>
      <li>
        <p>å‚æ•°æ‹Ÿåˆæ•°æ®</p>

        <script type="math/tex; mode=display">\hat{\boldsymbol w}=\mathop{\operatorname{arg\,max}}\limits_{\boldsymbol w}p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)</script>
      </li>
      <li>
        <p>è¿›è¡Œé¢„æµ‹</p>

        <script type="math/tex; mode=display">p(y_*|\boldsymbol x_*)=\text{sigmoid}(\boldsymbol x_*'\hat{\boldsymbol w})</script>
      </li>
    </ul>
  </li>
  <li><strong><span style="color:steelblue">å¯¹äºå›å½’é—®é¢˜ï¼š</span></strong>
    <ul>
      <li>
        <p>å»ºæ¨¡</p>

        <script type="math/tex; mode=display">p(y|\boldsymbol x)=\text{Normal}(\boldsymbol x'\boldsymbol w;\sigma^2)</script>
      </li>
      <li>
        <p>å‚æ•°æ‹Ÿåˆæ•°æ®</p>

        <script type="math/tex; mode=display">\hat{\boldsymbol w}=\mathop{\operatorname{arg\,max}}\limits_{\boldsymbol w}p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)</script>
      </li>
      <li>
        <p>è¿›è¡Œé¢„æµ‹</p>

        <script type="math/tex; mode=display">E[y_* ]=\boldsymbol x_*'\hat{\boldsymbol w}</script>
      </li>
    </ul>
  </li>
</ul>

<p><span style="color:red"><script type="math/tex">\hat{\boldsymbol w}</script> å¯¹åº”äº â€œç‚¹ä¼°è®¡â€</span></p>

<h3 id="12-è´å¶æ–¯æ›¿ä»£">1.2 è´å¶æ–¯æ›¿ä»£</h3>
<p><strong><script type="math/tex">\hat{\boldsymbol w}</script> å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„â€¦â€¦å¦‚æœæˆ‘ä»¬ä¸åªæ˜¯ä½¿ç”¨å‚æ•°çš„ä¸€ä¸ªä¼°è®¡å€¼å‘¢ï¼Ÿ</strong></p>
<ul>
  <li><strong><span style="color:steelblue">å¯¹äºåˆ†ç±»é—®é¢˜ï¼š</span></strong>
    <ul>
      <li>
        <p>å»ºæ¨¡</p>

        <script type="math/tex; mode=display">p(y|\boldsymbol x)=\text{sigmoid}(\boldsymbol x'\boldsymbol w)</script>
      </li>
      <li>
        <p>è€ƒè™‘é‚£äº›å¯ä»¥æ¯”è¾ƒå¥½åœ°æ‹Ÿåˆæ•°æ®çš„ <span style="color:red">å¯èƒ½çš„å‚æ•°ç©ºé—´</span></p>

        <script type="math/tex; mode=display">p(\boldsymbol w|\boldsymbol X,\boldsymbol y)</script>
      </li>
      <li>
        <p>è¿›è¡Œ <span style="color:red">â€œæœŸæœ›çš„â€</span> é¢„æµ‹</p>

        <script type="math/tex; mode=display">p(y_*|\boldsymbol x_*)=E_{p(\boldsymbol w|\boldsymbol X,\boldsymbol y)}\left[\text{sigmoid}(\boldsymbol x_*'\boldsymbol w)\right]</script>
      </li>
    </ul>
  </li>
  <li><strong><span style="color:steelblue">å¯¹äºå›å½’é—®é¢˜ï¼š</span></strong>
    <ul>
      <li>
        <p>å»ºæ¨¡</p>

        <script type="math/tex; mode=display">p(y|\boldsymbol x)=\text{Normal}(\boldsymbol x'\boldsymbol w;\sigma^2)</script>
      </li>
      <li>
        <p>è€ƒè™‘é‚£äº›å¯ä»¥æ¯”è¾ƒå¥½åœ°æ‹Ÿåˆæ•°æ®çš„ <span style="color:red">å¯èƒ½çš„å‚æ•°ç©ºé—´</span></p>

        <script type="math/tex; mode=display">p(\boldsymbol w|\boldsymbol X,\boldsymbol y)</script>
      </li>
      <li>
        <p>è¿›è¡Œ <span style="color:red">â€œæœŸæœ›çš„â€</span> é¢„æµ‹</p>

        <script type="math/tex; mode=display">p(y_*|\boldsymbol x_*)=E_{p(\boldsymbol w|\boldsymbol X,\boldsymbol y)}\left[\text{Normal}(\boldsymbol x_*'\boldsymbol w;\sigma^2)\right]</script>
      </li>
    </ul>
  </li>
</ul>

<h2 id="2-ä¸ç¡®å®šæ€§">2. ä¸ç¡®å®šæ€§</h2>
<p><strong>å¦‚æœç”¨äºè®­ç»ƒçš„æ•°æ®é›†å¾ˆå°ï¼Œæˆ‘ä»¬å¾ˆå°‘ä¼šå®Œå…¨ä¿¡ä»»ä»»ä½•ä»ä¸­å­¦ä¹ åˆ°çš„æ¨¡å‹ã€‚æˆ‘ä»¬èƒ½å¦é‡åŒ–è¿™ç§ä¸ç¡®å®šæ€§ï¼Œå¹¶å°†å…¶ç”¨äºé¢„æµ‹å‘¢ï¼Ÿ</strong></p>
<h3 id="21-é‡æ–°å®¡è§†å›å½’é—®é¢˜">2.1 é‡æ–°å®¡è§†å›å½’é—®é¢˜</h3>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200219-145612%402x.png" width="60%" /></p>

<p><span style="color:red">çº¿æ€§å›å½’ï¼š</span> $y=w_0+w_1x$<br />
è¿™é‡Œï¼Œ$y=$ humidityï¼ˆæ¹¿åº¦ï¼‰ï¼Œ$x=$ temperatureï¼ˆæ¸©åº¦ï¼‰</p>

<ul>
  <li>ä»æ•°æ®ä¸­å­¦ä¹ æ¨¡å‹
    <ul>
      <li>
        <p>é€šè¿‡é€‰æ‹©æƒé‡æ¥æœ€å°åŒ–è¯¯å·®æ®‹å·®</p>

        <script type="math/tex; mode=display">\hat{\boldsymbol w}=(\boldsymbol X'\boldsymbol X)^{-1}\boldsymbol X'\boldsymbol y</script>
      </li>
    </ul>
  </li>
  <li>ä½†æ˜¯æˆ‘ä»¬å¯¹äºå¾—åˆ°çš„ $\hat{\boldsymbol w}$ å’Œé¢„æµ‹å€¼æœ‰å¤šå¤§çš„ä¿¡å¿ƒï¼Ÿ</li>
</ul>

<h3 id="22-æˆ‘ä»¬åº”è¯¥ç›¸ä¿¡ç‚¹ä¼°è®¡-hatboldsymbol-w-å—">2.2 æˆ‘ä»¬åº”è¯¥ç›¸ä¿¡ç‚¹ä¼°è®¡ $\hat{\boldsymbol w}$ å—ï¼Ÿ</h3>
<ul>
  <li>æˆ‘ä»¬çš„å­¦ä¹ ç®—æ³•æœ‰å¤šç¨³å®šï¼Ÿ
<img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200219-152254%402x.png" width="80%" /><br />
<strong><center><span style="font-size:10pt">ä¸¤ä¸ªå…·æœ‰ä¸åŒå™ªå£°æ°´å¹³çš„æ•°æ®é›†ä»¥åŠå®ƒä»¬å„è‡ªå¯¹åº”çš„ä¼¼ç„¶å‡½æ•°</span></center></strong>
    <center><span style="font-size:10pt">ï¼ˆæ¥æºï¼š<span style="font-style:italic">A First Course in Machine Learning (p.81)</span> by Rogers &amp; Girolamiï¼‰</span></center>

    <ul>
      <li>$\hat{\boldsymbol w}$ å¯¹äºå™ªå£°é«˜åº¦æ•æ„Ÿ</li>
      <li>å‚æ•°ä¼°è®¡çš„ä¸ç¡®å®šæ€§æœ‰å¤šå°‘ï¼Ÿ</li>
      <li>å¦‚æœç›®æ ‡å‚æ•°çš„ <strong>è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆNegative Log Likelihood, NLLï¼‰</strong> çš„åœ¨å³°å€¼å¤„è¶Šé«˜ä¸”çª„ï¼Œè¯´æ˜æˆ‘ä»¬æŒæ¡çš„ä¿¡æ¯é‡è¶Šå¤§</li>
    </ul>
  </li>
  <li>å½¢å¼åŒ–ä¸º <strong>è´¹é›ªä¿¡æ¯çŸ©é˜µï¼ˆFisher Information Matrixï¼‰</strong>
    <ul>
      <li>$E[ 2^{nd} \text{ deriv of NLL}]$<br />
$\cal I$ $=\dfrac{1}{\sigma^2}\boldsymbol Xâ€™\boldsymbol X$</li>
    </ul>
  </li>
  <li>è¡¡é‡å…³äº $\hat{\boldsymbol w}$ çš„ç›®æ ‡å‡½æ•°çš„æ›²ç‡</li>
</ul>

<h2 id="3-è´å¶æ–¯è§†è§’">3. è´å¶æ–¯è§†è§’</h2>
<p><strong>ä¿ç•™æ‰€æœ‰çš„æœªçŸ¥å› ç´ ï¼ˆä¾‹å¦‚ï¼šå‚æ•°çš„ä¸ç¡®å®šæ€§ï¼‰å¹¶å¯¹å®ƒä»¬è¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸”åœ¨è¿›è¡Œç»Ÿè®¡æ¨æ–­æ—¶åˆ©ç”¨è¿™äº›ä¿¡æ¯ã€‚</strong></p>
<h3 id="31-ä¸€ä¸ªè´å¶æ–¯äººçš„è§†è§’">3.1 ä¸€ä¸ªè´å¶æ–¯äººçš„è§†è§’</h3>
<ul>
  <li>æˆ‘ä»¬æœ‰ç†ç”±è®¤ä¸º <strong>æ‰€æœ‰çš„</strong> å‚æ•°å¯¹äºæ•°æ®è€Œè¨€éƒ½æ˜¯å¸¸æ•°å—ï¼Ÿ
    <ul>
      <li>å¯¹äºè®­ç»ƒæ•°æ®æ‹Ÿåˆæ›´å¥½çš„æƒé‡çš„æ¦‚ç‡åº”è¯¥å¤§äºå…¶ä»–æƒé‡çš„æ¦‚ç‡</li>
      <li>åˆ©ç”¨æ‰€æœ‰å¯èƒ½çš„æƒé‡è¿›è¡Œé¢„æµ‹ï¼Œä¹˜ä»¥å„è‡ªçš„æ¦‚ç‡ä½œä¸ºç¼©æ”¾ç³»æ•°</li>
    </ul>
  </li>
  <li>è¿™å°±æ˜¯ <span style="color:red">è´å¶æ–¯æ¨æ–­</span> èƒŒåçš„æ€æƒ³</li>
</ul>

<h3 id="32-å‚æ•°çš„ä¸ç¡®å®šæ€§">3.2 å‚æ•°çš„ä¸ç¡®å®šæ€§</h3>
<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200219-191611%402x.png" width="40%" align="right" /></p>

<ul>
  <li>ç›®æ ‡å‡½æ•°æœ‰å¾ˆå¤šåˆç†çš„è§£
    <ul>
      <li>ä¸ºä»€ä¹ˆåªé€‰æ‹©å…¶ä¸­çš„æŸä¸€ä¸ªå‘¢ï¼Ÿ</li>
    </ul>
  </li>
  <li>è€ƒè™‘ <span style="color:red">æ‰€æœ‰</span> å¯èƒ½çš„å‚æ•°å€¼èƒŒåçš„åŸå› 
    <ul>
      <li>ä¹˜ä»¥å®ƒä»¬çš„ <span style="color:red">åéªŒæ¦‚ç‡</span> ä½œä¸ºåŠ æƒé¡¹</li>
    </ul>
  </li>
  <li>æ›´å…·é²æ£’æ€§çš„é¢„æµ‹
    <ul>
      <li>å¯ä»¥æ›´å¥½åœ°é¿å…è¿‡æ‹Ÿåˆï¼Œå°¤å…¶æ˜¯å¯¹äºå°çš„è®­ç»ƒé›†è€Œè¨€</li>
      <li>å¯ä»¥å¾—åˆ°è¡¨è¾¾èƒ½åŠ›æ›´å¼ºçš„æ¨¡å‹ç±»åˆ«ï¼ˆä¾‹å¦‚ï¼šè´å¶æ–¯ Logistic å›å½’æ˜¯éçº¿æ€§æ¨¡å‹ï¼‰</li>
    </ul>
  </li>
</ul>

<h3 id="33-é¢‘ç‡å­¦å®¶-vs-è´å¶æ–¯äººçš„-åˆ†æ­§">3.3 é¢‘ç‡å­¦å®¶ vs. è´å¶æ–¯äººçš„ â€œåˆ†æ­§â€</h3>
<ul>
  <li><strong><span style="color:red">é¢‘ç‡å­¦å®¶ï¼š</span></strong> ä½¿ç”¨ <strong>ç‚¹ä¼°è®¡</strong>ã€<strong>æ­£åˆ™åŒ–</strong>ã€<strong>på€¼</strong> â€¦ è¿›è¡Œå­¦ä¹ 
    <ul>
      <li>ç®€å•çš„å‡è®¾èƒŒåæ˜¯å¤æ‚çš„ç†è®ºæ”¯æ’‘</li>
      <li>å¤§éƒ¨åˆ†ç®—æ³•éƒ½æ¯”è¾ƒç®€å•ï¼Œéå¸¸åå®ç”¨çš„æœºå™¨å­¦ä¹ ç ”ç©¶</li>
    </ul>
  </li>
  <li><strong><span style="color:red">è´å¶æ–¯äººï¼š</span></strong> ä¿ç•™ <strong>ä¸ç¡®å®šæ€§</strong>ï¼Œåœ¨è¿›è¡Œç»Ÿè®¡æ¨æ–­æ—¶å¯¹æœªçŸ¥å› ç´ è¿›è¡Œ <strong>è¾¹ç¼˜åŒ–ï¼ˆæ±‚å’Œï¼‰</strong>
    <ul>
      <li>ä¸€äº›ç†è®º</li>
      <li>ç®—æ³•é€šå¸¸æ›´åŠ å¤æ‚ï¼Œä½†å¹¶éæ€»æ˜¯å¦‚æ­¤</li>
      <li>é€šå¸¸ï¼ˆå¹¶éç»å¯¹ï¼‰åœ¨è®¡ç®—ä¸Šå¼€é”€æ›´é«˜</li>
    </ul>
  </li>
</ul>

<h2 id="4-è´å¶æ–¯å›å½’">4. è´å¶æ–¯å›å½’</h2>
<p><strong>å°†è´å¶æ–¯æ¨æ–­åº”ç”¨äºçº¿æ€§å›å½’ï¼Œå¯¹äº $\boldsymbol w$ ä½¿ç”¨æ­£æ€å…ˆéªŒ</strong></p>
<h3 id="41-å†è°ˆçº¿æ€§å›å½’">4.1 å†è°ˆçº¿æ€§å›å½’</h3>
<ul>
  <li>
    <p>å›å¿†çº¿æ€§å›å½’çš„æ¦‚ç‡å…¬å¼</p>

    <script type="math/tex; mode=display">y\sim \text{Normal}(\boldsymbol x'\boldsymbol w, \sigma^2)</script>

    <script type="math/tex; mode=display">\boldsymbol w\sim \text{Normal}(\boldsymbol 0,\gamma^2 \boldsymbol I_D)</script>

    <p>å…¶ä¸­ï¼Œ$\boldsymbol I_D$ æ˜¯ $D\times D$ çš„å•ä½çŸ©é˜µ</p>
  </li>
  <li>
    <p>è´å¶æ–¯è§„åˆ™</p>

    <script type="math/tex; mode=display">p(\boldsymbol w|\boldsymbol X,\boldsymbol y)=\dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X)}</script>

    <p>è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾ $\boldsymbol w$ ä¸ $\boldsymbol X$ ä¹‹é—´äº’ç›¸ç‹¬ç«‹ï¼š<br />
<script type="math/tex">p(\boldsymbol w|\boldsymbol X,\boldsymbol y) = \dfrac{p(\boldsymbol w,\boldsymbol X,\boldsymbol y)}{p(\boldsymbol X,\boldsymbol y)}
=\dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol X,\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X)p(\boldsymbol X)}
=\dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol X)p(\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X)p(\boldsymbol X)}
=\dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X)}</script></p>

    <script type="math/tex; mode=display">\max \limits_{\boldsymbol w}p(\boldsymbol w|\boldsymbol X,\boldsymbol y)=\max \limits_{\boldsymbol w}p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)</script>

    <p>è¿™é‡Œï¼Œæˆ‘ä»¬é‡‡ç”¨ç‚¹ä¼°è®¡é¿å…è®¡ç®—è¾¹ç¼˜ä¼¼ç„¶é¡¹ã€‚</p>
  </li>
  <li>
    <p>å¯¼è‡´ç›®æ ‡å‡½æ•°æƒ©ç½šåŒ–ï¼ˆå²­å›å½’ï¼‰</p>
  </li>
</ul>

<h3 id="42-è´å¶æ–¯çº¿æ€§å›å½’">4.2 è´å¶æ–¯çº¿æ€§å›å½’</h3>
<ul>
  <li>
    <p>å›é€€ä¸€æ­¥ï¼Œè€ƒè™‘å®Œå…¨åéªŒ</p>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{align}
p(\boldsymbol w|\boldsymbol X,\boldsymbol y,\sigma^2)
&= \dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w,\sigma^2)p(\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X,\sigma^2)} \\
&= \dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w,\sigma^2)p(\boldsymbol w)}{\int p(\boldsymbol y|\boldsymbol X,\boldsymbol w,\sigma^2)p(\boldsymbol w)d \boldsymbol w}
\end{align} %]]></script>
  </li>
</ul>

<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p><script type="math/tex">% <![CDATA[
\begin{align}
\sqrt{37} & = \sqrt{\frac{73^2-1}{12^2}} \\
 & = \sqrt{\frac{73^2}{12^2}\cdot\frac{73^2-1}{73^2}} \\ 
 & = \sqrt{\frac{73^2}{12^2}}\sqrt{\frac{73^2-1}{73^2}} \\
 & = \frac{73}{12}\sqrt{1 - \frac{1}{73^2}} \\ 
 & \approx \frac{73}{12}\left(1 - \frac{1}{2\cdot73^2}\right)
\end{align} %]]></script></p>

<p>ä¸‹èŠ‚å†…å®¹ï¼š</p>
:ET