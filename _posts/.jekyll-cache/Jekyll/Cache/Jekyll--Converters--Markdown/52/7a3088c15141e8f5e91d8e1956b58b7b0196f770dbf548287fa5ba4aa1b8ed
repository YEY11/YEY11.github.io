I"Ùh<!-- æ•°å­¦å…¬å¼ -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>

<h1 id="lecture-18-é«˜æ–¯æ··åˆæ¨¡å‹å’Œ-em-ç®—æ³•">Lecture 18 é«˜æ–¯æ··åˆæ¨¡å‹å’Œ EM ç®—æ³•</h1>
<h2 id="ä¸»è¦å†…å®¹">ä¸»è¦å†…å®¹</h2>
<ul>
  <li><strong>æ— ç›‘ç£å­¦ä¹ </strong>
    <ul>
      <li>é—®é¢˜çš„å¤šæ ·æ€§</li>
    </ul>
  </li>
  <li><strong>é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰</strong>
    <ul>
      <li>ä¸€ç§ç”¨äºèšç±»çš„æ¦‚ç‡æ–¹æ³•</li>
      <li>GMM</li>
      <li>ä¼˜åŒ–é—®é¢˜çš„ GMM èšç±»</li>
    </ul>
  </li>
  <li><strong>æœŸæœ›æœ€å¤§åŒ–ï¼ˆEMï¼‰ç®—æ³•</strong>
    <h2 id="1-æ— ç›‘ç£å­¦ä¹ ">1. æ— ç›‘ç£å­¦ä¹ </h2>
    <p><strong>æœºå™¨å­¦ä¹ ä¸­çš„ä¸€ä¸ªå¤§çš„åˆ†æ”¯ï¼Œå…³æ³¨åœ¨æ ‡ç­¾ç¼ºå¤±çš„æ•°æ®ä¸Šå­¦ä¹ å…¶ç»“æ„</strong></p>
    <h3 id="11-åœ¨æ­¤ä¹‹å‰ç›‘ç£å­¦ä¹ ">1.1 åœ¨æ­¤ä¹‹å‰ï¼šç›‘ç£å­¦ä¹ </h3>
  </li>
  <li>ç›‘ç£å­¦ä¹ ï¼šæ€»ä½“ç›®æ ‡æ˜¯æ ¹æ®æ•°æ®åšå‡ºé¢„æµ‹</li>
  <li>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å­¦ä¹ äº†è¯¸å¦‚ï¼šéšæœºæ£®æ—ã€ANN å’Œ SVM ç­‰ç®—æ³•</li>
  <li>æˆ‘ä»¬æœ‰å®ä¾‹ $\boldsymbol x_i\in \boldsymbol R^m\;(i=1,â€¦,n)$ï¼Œä»¥åŠå¯¹åº”çš„æ ‡ç­¾ $y_i$ ä½œä¸ºè¾“å…¥ï¼Œç›®æ ‡æ˜¯é¢„æµ‹æ–°çš„å®ä¾‹çš„æ ‡ç­¾ã€‚</li>
  <li>å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå‡½æ•°é€¼è¿‘é—®é¢˜ï¼Œä½†è¯·æ³¨æ„ï¼šæ³›åŒ–èƒ½åŠ›å¾ˆå…³é”®</li>
  <li>è€è™æœºï¼šéƒ¨åˆ†ç›‘ç£çš„è®¾å®š</li>
</ul>

<h3 id="12-ç°åœ¨æ— ç›‘ç£å­¦ä¹ ">1.2 ç°åœ¨ï¼šæ— ç›‘ç£å­¦ä¹ </h3>
<ul>
  <li>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»‹ç»æ— ç›‘ç£å­¦ä¹ æ–¹æ³•</li>
  <li>åœ¨æ— ç›‘ç£å­¦ä¹ ä¸­ï¼Œæ²¡æœ‰æ‰€è°“å«åš â€œæ ‡ç­¾â€ çš„ä¸“é—¨å˜é‡</li>
  <li>ç›¸åº”åœ°ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªæ•°æ®ç‚¹çš„é›†åˆ $\boldsymbol x_i\in \boldsymbol R^m\;(i=1,â€¦,n)$</li>
  <li>æ— ç›‘ç£å­¦ä¹ çš„ç›®çš„æ˜¯ <span style="color:red">æ¢ç´¢æ•°æ®çš„ç»“æ„ï¼ˆæ¨¡å¼ã€è§„å¾‹ç­‰ï¼‰</span></li>
  <li>â€œæ¢ç´¢æ•°æ®ç»“æ„â€ çš„ç›®çš„æ˜¯æ¨¡ç³Šçš„</li>
</ul>

<h3 id="13-æ— ç›‘ç£å­¦ä¹ ä»»åŠ¡">1.3 æ— ç›‘ç£å­¦ä¹ ä»»åŠ¡</h3>
<ul>
  <li>æ— ç›‘ç£å­¦ä¹ åŒ…æ‹¬å¾ˆå¤šä¸åŒç±»åˆ«çš„ä»»åŠ¡ï¼š
    <ul>
      <li>èšç±»</li>
      <li>é™ç»´</li>
      <li>æ¦‚ç‡æ¨¡å‹çš„å‚æ•°å­¦ä¹ </li>
    </ul>
  </li>
  <li>ç›¸å…³åº”ç”¨ï¼š
    <ul>
      <li>å¸‚åœºç¯®å­åˆ†æã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨è¶…å¸‚çš„äº¤æ˜“æ—¥å¿—æŸ¥æ‰¾ç»å¸¸è¢«ä¸€èµ·è´­ä¹°çš„å•†å“</li>
      <li>ç¦»ç¾¤å€¼æ£€æµ‹ã€‚ä¾‹å¦‚ï¼Œå‘ç°æ½œåœ¨çš„ä¿¡ç”¨å¡äº¤æ˜“æ¬ºè¯ˆ</li>
      <li>ç»å¸¸ç”¨äºï¼ˆæœ‰ç›‘ç£ï¼‰æœºå™¨å­¦ä¹  pipeline ä¸­çš„æ— ç›‘ç£ä»»åŠ¡</li>
    </ul>
  </li>
</ul>

<h3 id="14-å›é¡¾k-means-èšç±»">1.4 å›é¡¾ï¼šk-means èšç±»</h3>
<p><strong><span style="color:steelblue">k-means ç®—æ³•æè¿°ï¼š</span></strong><br />
1.$\,$<strong>åˆå§‹åŒ–ï¼š</strong> éšæœºé€‰æ‹© $k$ ä¸ªé›†ç¾¤ <span style="color:red">ä¸­å¿ƒ</span><br />
2.$\,$<strong>æ›´æ–°ï¼š</strong><br />
$\qquad$a. <span style="color:red">åˆ†é…æ•°æ®ç‚¹</span> åˆ°æœ€è¿‘çš„é›†ç¾¤ä¸­å¿ƒ<br />
$\qquad$b. åœ¨å½“å‰çš„åˆ†é…ä¸‹ï¼Œ<span style="color:red">é‡æ–°è®¡ç®—é›†ç¾¤ä¸­å¿ƒ</span><br />
3.$\,$<strong>ç»ˆæ­¢ï¼š</strong> å¦‚æœé›†ç¾¤ä¸­å¿ƒæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆ <span style="color:purple">ç®—æ³•åœæ­¢</span><br />
4.$\,$è¿”å› <span style="color:purple">æ­¥éª¤ 2</span></p>

<p>é€‰æ‹©å…¸å‹çš„ $L_2$ èŒƒæ•°æ¥è¡¨ç¤ºè·ç¦»ã€‚<br />
K-means ä»ç„¶æ˜¯æœ€å—æ¬¢è¿çš„æ•°æ®æŒ–æ˜ç®—æ³•ä¹‹ä¸€ã€‚</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-25-WX20200225-164732%402x.png" /></p>

<p><strong><center><span style="font-size:10pt">ä½¿ç”¨é‡æ–°ç¼©æ”¾çš„ Old Faithful æ®é›†çš„ K-means ç®—æ³•çš„å›¾ç¤º</span></center></strong><center><span style="font-size:10pt">Source: <span style="font-style:italic">Pattern Recognition and Machine Learning (p.426)</span> by Bishop</span></center></p>

<ul>
  <li>éœ€è¦é¢„å…ˆæŒ‡å®šé›†ç¾¤æ•° $k$</li>
  <li>ä½¿ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»è¡¡é‡ â€œå·®å¼‚æ€§â€</li>
  <li>å¯»æ‰¾ â€œçƒå½¢â€ é›†ç¾¤</li>
  <li>è¿­ä»£ä¼˜åŒ–è¿‡ç¨‹</li>
</ul>

<h2 id="2-é«˜æ–¯æ··åˆæ¨¡å‹gmm">2. é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰</h2>
<p><strong>ä»æ¦‚ç‡çš„è§†è§’çœ‹èšç±»ç®—æ³•</strong></p>
<h3 id="21-å¯¹æ•°æ®èšç±»ä¸­çš„ä¸ç¡®å®šæ€§å»ºæ¨¡">2.1 å¯¹æ•°æ®èšç±»ä¸­çš„ä¸ç¡®å®šæ€§å»ºæ¨¡</h3>
<ul>
  <li>k-means èšç±»å°†æ¯ä¸ªæ•°æ®ç‚¹éƒ½ç²¾ç¡®åœ°åˆ†é…åˆ°æŸä¸€ä¸ªé›†ç¾¤</li>
  <li>ç±»ä¼¼äº k-meansï¼Œä¸€ä¸ªæ¦‚ç‡çš„æ··åˆæ¨¡å‹åŒæ ·éœ€è¦é¢„å…ˆæŒ‡å®šé›†ç¾¤æ•° $k$</li>
  <li>ä¸åŒäº k-meansï¼Œæ¦‚ç‡æ¨¡å‹è®©æˆ‘ä»¬å¾—ä»¥è¡¨è¾¾æœ‰å…³æ¯ä¸ªæ•°æ®ç‚¹ <span style="color:red">æ¥æºçš„ä¸ç¡®å®šæ€§</span>
    <ul>
      <li>æ¯ä¸ªæ•°æ®ç‚¹æ¥è‡ªé›†ç¾¤ $c$ çš„æ¦‚ç‡ä¸º $w_c$ï¼Œå…¶ä¸­ $c=1,â€¦,k$</li>
    </ul>
  </li>
  <li>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªæ•°æ®ç‚¹ä»ç„¶åªæ¥è‡ªæŸä¸ªç‰¹å®šçš„é›†ç¾¤ï¼ˆåˆç§° â€œç»„åˆ†â€ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸ç¡®å®šæ¥è‡ªå“ªä¸€ä¸ª</li>
  <li>æ¥ä¸‹æ¥
    <ul>
      <li>å°†å„ä¸ªç»„åˆ†å»ºæ¨¡ä¸ºé«˜æ–¯åˆ†å¸ƒ</li>
      <li>æ‹Ÿåˆè¿‡ç¨‹å±•ç¤ºäº†ä¸€èˆ¬çš„æœŸæœ›æœ€å¤§åŒ–ï¼ˆEMï¼‰ç®—æ³•</li>
    </ul>
  </li>
</ul>

<h3 id="22-èšç±»æ¦‚ç‡æ¨¡å‹">2.2 èšç±»ï¼šæ¦‚ç‡æ¨¡å‹</h3>
<p>æ•°æ®ç‚¹ $\boldsymbol x_i$ æ˜¯æ¥è‡ª $K$ ä¸ªåˆ†å¸ƒï¼ˆæˆ–è€…è¯´ â€œç»„åˆ†â€ï¼‰çš„æ··åˆçš„ç‹¬ç«‹åŒåˆ†å¸ƒï¼ˆi.i.d.ï¼‰æ ·æœ¬</p>

<center><span style="font-size:10pt">æ··åˆä¸­çš„æ¯ä¸ªç»„åˆ†å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ä¸€ä¸ªé›†ç¾¤</span></center>
<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-25-WX20200225-182850%402x.png" /></p>

<p>åŸåˆ™ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å°† <span style="color:red">ç»„åˆ†</span> å‡è®¾ä¸ºä»»ä½•åˆ†å¸ƒï¼Œä½†æ˜¯ï¼Œæ­£æ€åˆ†å¸ƒæ˜¯ä¸€ç§å¸¸è§çš„å»ºæ¨¡é€‰æ‹© $\to$ é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGaussian Mixture Model, GMMï¼‰</p>

<h3 id="23-æ­£æ€åˆç§°-é«˜æ–¯åˆ†å¸ƒ">2.3 æ­£æ€ï¼ˆåˆç§° â€œé«˜æ–¯â€ï¼‰åˆ†å¸ƒ</h3>
<ul>
  <li>
    <p>å›å¿† $1$-ç»´ é«˜æ–¯åˆ†å¸ƒï¼š</p>

    <script type="math/tex; mode=display">N(x|\mu,\sigma)\equiv \dfrac{1}{\sqrt{2\pi \sigma^2}}\exp \left(-\dfrac{(x-\mu)^2}{2\sigma^2}\right)</script>
  </li>
  <li>
    <p>ç„¶åï¼Œä¸€ä¸ª $d$-ç»´ é«˜æ–¯åˆ†å¸ƒä¸ºï¼š</p>

    <script type="math/tex; mode=display">N(\boldsymbol x|\boldsymbol{\mu},\mathbf{\Sigma})\equiv (2\pi)^{-\frac{d}{2}}|\mathbf{\Sigma}|^{-\frac{1}{2}}\exp \left(-\dfrac{1}{2}(\boldsymbol x-\boldsymbol \mu)^T \mathbf{\Sigma}^{-1}(\boldsymbol x-\boldsymbol \mu)\right)</script>

    <ul>
      <li>$\mathbf{\Sigma}$ æ˜¯ <span style="color:red">åæ–¹å·®çŸ©é˜µ</span>ï¼Œæ˜¯ä¸€ä¸ª PSDï¼ˆåŠæ­£å®šï¼‰å¯¹ç§° $d\times d$ çŸ©é˜µ</li>
      <li>$|\mathbf{\Sigma}|$ è¡¨ç¤ºè¡Œåˆ—å¼</li>
      <li>ä¸éœ€è¦è®°ä½å®Œæ•´çš„å…¬å¼</li>
    </ul>
  </li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-25-WX20200225-185102%402x.png" width="80%" /></p>

<h3 id="24-é«˜æ–¯æ··åˆæ¨¡å‹gmm">2.4 é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰</h3>
<ul>
  <li>
    <p>é«˜æ–¯æ··åˆåˆ†å¸ƒï¼ˆå¯¹äºå•ä¸ªæ•°æ®ç‚¹ï¼‰ï¼š</p>

    <script type="math/tex; mode=display">p(\boldsymbol x)\equiv \sum_{j=1}^{k}w_j \mathcal N(\boldsymbol x|\boldsymbol{\mu}_j,\mathbf{\Sigma}_j)\equiv \sum_{j=1}^{k}p(\boldsymbol C_j)p(\boldsymbol x|\boldsymbol C_j)</script>
  </li>
  <li><script type="math/tex">p(\boldsymbol x|\boldsymbol C_j)\equiv \mathcal N(\boldsymbol x|\boldsymbol{\mu}_j,\mathbf{\Sigma}_j)</script>
æ˜¯ç±»åˆ« $j$ çš„ç±»åˆ« / ç»„åˆ†æ¡ä»¶å¯†åº¦ï¼ˆå»ºæ¨¡ä¸ºé«˜æ–¯åˆ†å¸ƒï¼‰</li>
  <li>è¿™é‡Œï¼Œ$p(\boldsymbol C_j)\ge 0$ï¼Œå¹¶ä¸” $\sum_{j=1}^{k}p(\boldsymbol C_j)=1$</li>
  <li>æ¨¡å‹çš„å‚æ•°ä¸º $p(\boldsymbol C_j),\boldsymbol \mu_j,\mathbf{\Sigma}_j$ï¼Œå…¶ä¸­ $j=1,â€¦,k$</li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-25-WX20200225-192451%402x.png" width="50%" /></p>

<p><strong><center><span style="font-size:10pt">å‡ºäºå¯è§†åŒ–çš„ç›®çš„ï¼Œæ··åˆä¸å•ç‹¬ç»„åˆ†å¯†åº¦ç»è¿‡äº†ç¼©æ”¾å¤„ç†</span></center></strong></p>

<p><strong><span style="color:steelblue">æ€è€ƒï¼š</span></strong> è€ƒè™‘ä¸€ä¸ª 3D æ•°æ®çš„ GMM æ¨¡å‹ï¼Œè¯¥æ¨¡å‹åŒ…å« 5 ä¸ªç»„åˆ†ã€‚è¯·é—®è¯¥æ¨¡å‹æœ‰å¤šå°‘ä¸ªç‹¬ç«‹çš„ <span style="color:red">æ ‡é‡å‚æ•°</span>ï¼Ÿ<br />
<br />
è¯·æ³¨æ„ï¼Œè¿™é‡Œè¦æ±‚ç‹¬ç«‹çš„æ ‡é‡å‚æ•°ã€‚<br />
å¯¹äºæŸä¸ªé›†ç¾¤ <script type="math/tex">\boldsymbol C_j\;(j=1,...,5)</script> è€Œè¨€ï¼š<br />
é¦–å…ˆï¼Œ3D æ•°æ®çš„åæ–¹å·®çŸ©é˜µ <script type="math/tex">\mathbf{\Sigma}_j</script> æ˜¯ä¸€ä¸ª <script type="math/tex">3\times 3</script> çš„å¯¹ç§°çŸ©é˜µï¼Œæ‰€ä»¥æœ‰ 6 ä¸ªï¼ˆå¯¹è§’çº¿ + æŸä¸€ä¾§çš„å…ƒç´ ï¼‰ä¸åŒçš„æ ‡é‡å‚æ•°ï¼›<br />
ç„¶åï¼Œå‡å€¼ <script type="math/tex">\boldsymbol{\mu}_j</script> æ˜¯ä¸€ä¸ª <script type="math/tex">3 \times 1</script> çš„å‘é‡ï¼Œæ‰€ä»¥æœ‰ 3 ä¸ªä¸åŒçš„æ ‡é‡å‚æ•°ï¼›<br />
æœ€åï¼Œæ¯ä¸ªé›†ç¾¤ <script type="math/tex">\boldsymbol C_j\;(j=1,...,5)</script> å¯¹åº”ä¸€ä¸ªæƒé‡å‚æ•° $w_j$ï¼ˆå³è¯¥é›†ç¾¤å¯¹åº”çš„æ¦‚ç‡ï¼‰ï¼Œä½†æ˜¯ç”±äºå­˜åœ¨å½’ä¸€åŒ–çº¦æŸ <script type="math/tex">\sum_{j=1}^{5}w_j=1</script>ï¼Œæ‰€ä»¥ï¼Œæƒé‡çš„ç‹¬ç«‹æ ‡é‡ä¸ªæ•°ä¸º 4 ä¸ªï¼ˆæœ€åä¸€ä¸ªæƒé‡å¯ä»¥ç”¨ 1 å‡å»å…¶ä½™æƒé‡ä¹‹å’Œè¡¨ç¤ºï¼‰ï¼›<br />
å› æ­¤ï¼Œè¯¥æ¨¡å‹ç‹¬ç«‹çš„æ ‡é‡å‚æ•°çš„ä¸ªæ•°ä¸º <script type="math/tex">6 \times 5+3\times 5+1\times 4=49</script></p>

<h3 id="25-èšç±»çš„æ¨¡å‹ä¼°è®¡">2.5 èšç±»çš„æ¨¡å‹ä¼°è®¡</h3>
<ul>
  <li>ç»™å®šä¸€ç»„æ•°æ®ç‚¹ï¼Œæˆ‘ä»¬å‡è®¾æ•°æ®ç‚¹æ˜¯ç”± GMM ç”Ÿæˆçš„
    <ul>
      <li>æˆ‘ä»¬æ•°æ®é›†ä¸­çš„æ¯ä¸ªç‚¹æ¥æºäºç¬¬ $j$ ä¸ªæ­£æ€åˆ†å¸ƒç»„åˆ†çš„æ¦‚ç‡ä¸º $w_j=p(\boldsymbol C_j)$</li>
    </ul>
  </li>
  <li>ç°åœ¨ï¼Œèšç±»ç­‰åŒäºå¯»æ‰¾ â€œæœ€ä½³è§£é‡Šâ€ è§‚æµ‹æ•°æ®çš„ GMM å‚æ•°</li>
  <li>åˆ©ç”¨ä¹‹å‰å­¦è¿‡çš„ <span style="color:red">MLE</span> æ–¹æ³•å¯»æ‰¾èƒ½å¤Ÿæœ€å¤§åŒ– $p(\boldsymbol x_1,â€¦,\boldsymbol x_n)$ çš„å‚æ•°</li>
</ul>

<h3 id="26-æ‹Ÿåˆ-gmm">2.6 æ‹Ÿåˆ GMM</h3>
<ul>
  <li>
    <p>å»ºæ¨¡å‡è®¾æ•°æ®ç‚¹ä¹‹é—´äº’ç›¸ç‹¬ç«‹ï¼Œç›®æ ‡æ˜¯æ‰¾åˆ° $p(\boldsymbol C_j),\boldsymbol \mu_j,\mathbf \Sigma_j\;(j=1,â€¦,k)$ï¼Œä½¿å¾—æœ€å¤§åŒ–</p>

    <script type="math/tex; mode=display">p(\boldsymbol x_1,...,\boldsymbol x_n)=\prod_{i=1}^{n}\sum_{j=1}^{k}p(\boldsymbol C_j)p(\boldsymbol x_i|\boldsymbol C_j)</script>

    <p>å…¶ä¸­ï¼Œ
<script type="math/tex">p(\boldsymbol x|\boldsymbol C_j)\equiv \mathcal N(\boldsymbol x|\boldsymbol \mu_j,\mathbf \Sigma_j)</script></p>

    <p>æˆ‘ä»¬å¯ä»¥å¯¹å…¶è§£ææ±‚è§£å—ï¼Ÿ</p>
  </li>
  <li>
    <p>æˆ‘ä»¬å¾ˆéš¾ç›´æ¥å¯¹åŸå¼æ±‚å¯¼ï¼Œå¯ä»¥åˆ©ç”¨å¸¸è§çš„ <span style="color:red">å–å¯¹æ•°æŠ€å·§</span></p>

    <script type="math/tex; mode=display">\log p(\boldsymbol x_1,...,\boldsymbol x_n)=\sum_{i=1}^{n}\log \left(\sum_{j=1}^{k}p(\boldsymbol C_j)p(\boldsymbol x_i|\boldsymbol C_j)\right)</script>

    <p><span style="color:red">$\to$ æœŸæœ›æœ€å¤§åŒ–ï¼ˆEMï¼‰</span></p>
  </li>
</ul>

<h2 id="3-æœŸæœ›æœ€å¤§åŒ–emç®—æ³•">3. æœŸæœ›æœ€å¤§åŒ–ï¼ˆEMï¼‰ç®—æ³•</h2>
<h3 id="31-em-çš„åŠ¨æœº">3.1 EM çš„åŠ¨æœº</h3>
<ul>
  <li>è€ƒè™‘ä¸€ä¸ªå‚æ•°æ¦‚ç‡æ¨¡å‹ $p(\boldsymbol X|\boldsymbol{\theta})$ï¼Œå…¶ä¸­ $\boldsymbol X$ è¡¨ç¤ºæ•°æ®ï¼Œ$\boldsymbol{\theta}$ è¡¨ç¤ºä¸€ä¸ªå‚æ•°å‘é‡</li>
  <li>æ ¹æ® MLEï¼Œæˆ‘ä»¬éœ€è¦æœ€å¤§åŒ–å…³äº $\boldsymbol{\theta}$ çš„å‡½æ•° $p(\boldsymbol X|\boldsymbol{\theta})$
    <ul>
      <li>ç­‰ä»·äºæœ€å¤§åŒ– $\log p(\boldsymbol X|\boldsymbol{\theta})$</li>
    </ul>
  </li>
  <li>ç„¶è€Œï¼Œå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š
    <ol>
      <li>æœ‰æ—¶æˆ‘ä»¬ <span style="color:red">æ²¡æœ‰è§‚æµ‹åˆ°</span> å…¶ä¸­ä¸€äº›è®¡ç®—å¯¹æ•°ä¼¼ç„¶æ‰€éœ€çš„å˜é‡<br />
 ä¾‹å¦‚ï¼šæˆ‘ä»¬å¹¶ä¸èƒ½é¢„å…ˆçŸ¥é“ GMM é›†ç¾¤å½’å±</li>
      <li>æœ‰æ—¶å¯¹æ•°ä¼¼ç„¶çš„å½¢å¼å¤„ç†èµ·æ¥ä¸æ–¹ä¾¿<br />
 ä¾‹å¦‚ï¼šå¯¹ä¸€ä¸ª GMM å¯¹æ•°ä¼¼ç„¶æ±‚å¯¼ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªå¾ˆéº»çƒ¦çš„ç­‰å¼</li>
    </ol>
  </li>
</ul>

<h3 id="32-mle-vs-em">3.2 MLE vs EM</h3>
<ul>
  <li>MLE æ˜¯é¢‘ç‡å­¦å®¶çš„åšæ³•ï¼Œå…¶å»ºè®®åœ¨ç»™å®šæ•°æ®é›†çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨çš„ â€œæœ€ä½³â€ å‚æ•°æ˜¯ä½¿æ•°æ®æ¦‚ç‡æœ€å¤§åŒ–çš„å‚æ•°
    <ul>
      <li>MLE æ˜¯ä¸€ç§æ­£å¼æå‡ºé—®é¢˜çš„æ–¹æ³•</li>
    </ul>
  </li>
  <li>EM æ˜¯ä¸€ç§ç®—æ³•
    <ul>
      <li>EM æ˜¯ä¸€ç§ç”¨æ¥è§£å†³ MLE æ‰€æå‡ºçš„é—®é¢˜çš„æ–¹æ³•</li>
      <li>å°¤å…¶æ˜¯å­˜åœ¨æœªè§‚æµ‹åˆ°çš„éšå˜é‡æ—¶ï¼ŒEM ç®—æ³•éå¸¸ä¾¿æ·</li>
    </ul>
  </li>
  <li>MLE å¯ä»¥é€šè¿‡å…¶ä»–æ–¹æ³•æ±‚è§£ï¼Œä¾‹å¦‚ï¼šæ¢¯åº¦ä¸‹é™ï¼ˆä½†æ˜¯æ¢¯åº¦ä¸‹é™å¹¶ä¸æ€»æ˜¯æœ€ä¾¿æ·çš„æ–¹æ³•ï¼‰</li>
</ul>

<h3 id="33-æœŸæœ›æœ€å¤§åŒ–emç®—æ³•">3.3 æœŸæœ›æœ€å¤§åŒ–ï¼ˆEMï¼‰ç®—æ³•</h3>
<p><strong><span style="color:steelblue">EM ç®—æ³•æè¿°ï¼š</span></strong><br />
1.$\,$åˆå§‹åŒ–æ­¥éª¤ï¼š<br />
$\qquad$åˆå§‹åŒ– $K$ ä¸ªé›†ç¾¤ï¼š$\boldsymbol C_1,â€¦,\boldsymbol C_K$<br />
$\qquad$å¯¹äºæ¯ä¸ªé›†ç¾¤ $j$ï¼Œéƒ½æœ‰å‚æ•° $(\boldsymbol \mu_j,\mathbf \Sigma_j)$ å’Œ $p(\boldsymbol C_j)$<br />
2.$\,$è¿­ä»£æ­¥éª¤ï¼š<br />
$\qquad$a. ä¼°è®¡æ¯ä¸ªæ•°æ®ç‚¹çš„æ‰€å±é›†ç¾¤ $p(\boldsymbol C_j|\boldsymbol x_i)$ $\qquad \color{blue}{\Longrightarrow} \qquad$ <span style="color:red">æœŸæœ›</span><br />
$\qquad$b. é‡æ–°ä¼°è®¡æ¯ä¸ªé›†ç¾¤ $j$ çš„å‚æ•° $(\boldsymbol \mu_j,\mathbf \Sigma_j)$ å’Œ $p(\boldsymbol C_j)$ $\qquad \color{blue}{\Longrightarrow} \qquad$ <span style="color:red">æœ€å¤§åŒ–  </span></p>

<h3 id="34-å°†-em-ç®—æ³•ç”¨äº-gmm-å’Œæ³›åŒ–">3.4 å°† EM ç®—æ³•ç”¨äº GMM å’Œæ³›åŒ–</h3>
<ul>
  <li>EM æ˜¯ä¸€ç§é€šç”¨æ–¹æ³•ï¼Œä¸ä»…ä»…å±€é™äº GMM
    <ul>
      <li>ç›®çš„ï¼šåœ¨å­˜åœ¨ <span style="color:red">éšå˜é‡</span> $\boldsymbol Z$ çš„æƒ…å†µä¸‹ï¼Œå®ç° <span style="color:red">MLE</span></li>
    </ul>
  </li>
  <li>GMM ä¸­çš„å˜é‡å’Œå‚æ•°åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
    <ul>
      <li><strong>å˜é‡ï¼š</strong> ç‚¹çš„ä½ç½® $\boldsymbol X$ å’Œé›†ç¾¤åˆ†é… $\boldsymbol Z$<br />
ä»¤ $z_i$ è¡¨ç¤ºæ¯ä¸ªæ•°æ®ç‚¹ $\boldsymbol x_i$ çš„çœŸå®é›†ç¾¤å½’å±ï¼Œåœ¨ $\boldsymbol z$ å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—ä¼¼ç„¶å‡½æ•°å¾ˆç®€å•</li>
      <li><strong>å‚æ•°ï¼š</strong> $\boldsymbol \theta$ è¡¨ç¤ºé›†ç¾¤çš„ä½ç½®ä¸å¤§å°</li>
    </ul>
  </li>
  <li>EM ç®—æ³•åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ
    <ul>
      <li>åœ¨å¯¹æ•°ä¼¼ç„¶çš„ä¸‹ç•Œä¸Šçš„ <span style="color:red">åæ ‡ä¸Šå‡æ³•</span>
        <ul>
          <li>M æ­¥éª¤ï¼šåœ¨æ¨¡å‹å‚æ•° $\boldsymbol \theta$ ä¸­çš„ä¸Šå‡</li>
          <li>E æ­¥éª¤ï¼šåœ¨è¾¹ç¼˜åŒ–ä¼¼ç„¶ $p(\boldsymbol Z)$ ä¸­çš„ä¸Šå‡</li>
        </ul>
      </li>
      <li>æ¯ä¸€æ­¥éƒ½æœç€ <span style="color:red">å±€éƒ¨</span> æœ€ä¼˜æ–¹å‘ç§»åŠ¨</li>
      <li>å¯èƒ½ä¸­é€”ä¼šå¡ä½ï¼Œå¯èƒ½éœ€è¦ <span style="color:red">éšæœºé‡å¯</span></li>
    </ul>
  </li>
</ul>

<h3 id="35-æ‰€éœ€å·¥å…·jensen-ä¸ç­‰å¼">3.5 æ‰€éœ€å·¥å…·ï¼šJensen ä¸ç­‰å¼</h3>
<ul>
  <li>
    <p>æ¯”è¾ƒå°†å¹³å‡å‡½æ•°ä½œç”¨åœ¨ä¸€ä¸ªå‡¸å‡½æ•°å‰åçš„å½±å“ï¼š</p>

    <script type="math/tex; mode=display">f\left(Average(\boldsymbol x)\right)\le Average\left(f(\boldsymbol x)\right)</script>
  </li>
  <li>ä¾‹å­ï¼š
    <ul>
      <li>ä»¤ $f$ ä¸ºæŸä¸ªå‡¸å‡½æ•°ï¼Œä¾‹å¦‚ $f(x)=x^2$</li>
      <li>è€ƒè™‘ $\boldsymbol x=[1,2,3,4,5]â€™$ï¼Œé‚£ä¹ˆ $f(\boldsymbol x)=[1,4,9,16,25]â€™$</li>
      <li>è¾“å…¥çš„å¹³å‡å€¼ä¸º $Average(\boldsymbol x)=3$</li>
      <li>$f\left(Average(\boldsymbol x)\right)=9$</li>
      <li>è¾“å‡ºçš„å¹³å‡å€¼ä¸º $Average\left(f(\boldsymbol x)\right)=12.4$</li>
    </ul>

    <p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-26-WX20200226-151822%402x.png" width="30%" align="right" /></p>
  </li>
  <li>è¯æ˜æ¥è‡ªå‡¸åº¦çš„å®šä¹‰
    <ul>
      <li>å½’çº³è¯æ˜</li>
    </ul>
  </li>
  <li>ä¸€èˆ¬è¡¨è¿°ï¼š
    <ul>
      <li>å¦‚æœ $\boldsymbol X$ æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œ$f$ æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°</li>
      <li>é‚£ä¹ˆï¼Œ$\color{red}{f\left(\mathbb{E}[\boldsymbol X] \right)\le \mathbb{E}\left[f(\boldsymbol X)\right]}$</li>
    </ul>
  </li>
</ul>

<h3 id="36-åˆ©ç”¨éšå˜é‡"><a name="anchor1"><span style="color:black">3.6 åˆ©ç”¨éšå˜é‡</span></a></h3>
<p>æˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ– $\log p(\boldsymbol X|\boldsymbol \theta)$ï¼Œæˆ‘ä»¬æ²¡æœ‰è§‚æµ‹åˆ° $\boldsymbol Z$ï¼ˆè¿™é‡Œä¸ºç¦»æ•£ï¼‰ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥å¼•å…¥å®ƒã€‚<br />
<br /></p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\color{steelblue}{\fbox{$\color{black}{\log p(\boldsymbol X|\boldsymbol \theta)}$}} &= \log \sum_{\boldsymbol Z}p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta) \qquad \color{steelblue}{\leftarrow \,è¾¹ç¼˜åŒ–ï¼ˆè¿™é‡Œ\, \sum_{\boldsymbol Z}...\,åœ¨æ‰€æœ‰å¯èƒ½çš„\,\boldsymbol Z\,çš„å–å€¼ä¸Šè¿­ä»£ï¼‰}\\
&= \log \sum_{\boldsymbol Z}\left(p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)\cdot \dfrac{p(\boldsymbol Z)}{p(\boldsymbol Z)} \right)
\qquad \color{steelblue}{\leftarrow \,éœ€è¦\,\boldsymbol Z\,å…·æœ‰éé›¶çš„è¾¹ç¼˜æ¦‚ç‡}\\
&= \log \sum_{\boldsymbol Z}\left(p(\boldsymbol Z)\cdot \dfrac{p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)}{p(\boldsymbol Z)} \right)\\
&= \log \mathbb{E}_{\boldsymbol Z}\left[\dfrac{p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)}{p(\boldsymbol Z)}\right]\\
&\ge \mathbb{E}_{\boldsymbol Z}\left[ \log \dfrac{p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)}{p(\boldsymbol Z)}\right] \qquad \color{steelblue}{\leftarrow \,\text{Jesen ä¸ç­‰å¼å¯ä»¥æ»¡è¶³ï¼Œå› ä¸º }\log(...)\,æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°}\\
&= \color{steelblue}{\fbox{$\color{black}{\mathbb{E}_{\boldsymbol Z}\left[ \log p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta) \right] - \mathbb{E}_{\boldsymbol Z}\left[ \log p(\boldsymbol Z)\right]}$}}
\end{align} %]]></script>

<h3 id="37-æœ€å¤§åŒ–ä¸‹ç•Œ">3.7 æœ€å¤§åŒ–ä¸‹ç•Œ</h3>
<ul>
  <li>$\,$
<script type="math/tex">\log p(\boldsymbol X|\boldsymbol \theta)\ge \mathbb{E}_{\boldsymbol Z}\left[ \log p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta) \right] - \mathbb{E}_{\boldsymbol Z}\left[ \log p(\boldsymbol Z)\right]\\</script></li>
  <li>ä¸ç­‰å¼å³è¾¹çš„éƒ¨åˆ†ï¼ˆRight Hand Side, RHSï¼‰æ˜¯åŸå§‹å¯¹æ•°ä¼¼ç„¶çš„ä¸€ä¸ª <span style="color:red">ä¸‹ç•Œ</span>
    <ul>
      <li>è¿™å¯¹äºä»»ä½• $\boldsymbol \theta$ å’Œä»»ä½•éé›¶ $p(\boldsymbol Z)$ éƒ½æ»¡è¶³</li>
    </ul>
  </li>
  <li>ç›´è§‰ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›å°†ä¸‹ç•Œå°½å¯èƒ½å¾€ä¸Šæ¨è¿›</li>
  <li>è¿™ä¸ªä¸‹ç•Œæ˜¯ä¸€ä¸ªå…³äº <span style="color:red">ä¸¤ä¸ª â€œå˜é‡â€ $\boldsymbol \theta$ å’Œ $p(\boldsymbol Z)$</span> çš„å‡½æ•°ã€‚æˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ– RHSï¼ˆä¸ç­‰å¼å³è¾¹çš„éƒ¨åˆ†ï¼‰ï¼Œå°†å…¶è§†ä¸ºå…³äºè¿™ä¸¤ä¸ª â€œå˜é‡â€ çš„ä¸€ä¸ªå‡½æ•°ã€‚</li>
  <li>åŒæ—¶å¯¹ä¸¤ä¸ª â€œå˜é‡â€ è¿›è¡Œä¼˜åŒ–æ˜¯éå¸¸å›°éš¾çš„ï¼Œå› æ­¤ï¼ŒEM ç®—æ³•é‡‡ç”¨äº†ä¸€ç§è¿­ä»£è¿‡ç¨‹</li>
  <li>EM æœ¬è´¨ä¸Šæ˜¯ <span style="color:red">åæ ‡ä¸Šå‡</span>ï¼š
    <ul>
      <li>å›ºå®š $\boldsymbol \theta$ï¼Œä¼˜åŒ–å…³äº $p(\boldsymbol Z)$ çš„ä¸‹ç•Œå‡½æ•°</li>
      <li>å›ºå®š $p(\boldsymbol Z)$ï¼Œä¼˜åŒ– $\boldsymbol \theta$</li>
    </ul>
  </li>
  <li>EM ç®—æ³•çš„æ–¹ä¾¿ä¹‹å¤„åœ¨äºï¼š
    <ul>
      <li>å¯¹äºä»»ä½•ç‚¹ $\boldsymbol \theta^*$ï¼Œå¯ä»¥è¯æ˜è®¾å®š $p(\boldsymbol Z)=p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta^*)$ ä½¿å¾—ä¸‹ç•Œæ›´ç´§ï¼ˆ<a name="anchor2">å…³äºè¿™ç‚¹ï¼Œæˆ‘ä»¬å°†åœ¨åé¢ç»™å‡ºç®€ç•¥è¯æ˜</a>ï¼‰</li>
      <li>å¯¹äºä»»ä½• $p(\boldsymbol Z)$ï¼Œä¸ç­‰å¼å³è¾¹ç¬¬äºŒé¡¹ä¸ $\boldsymbol \theta$ æ— å…³</li>
      <li>å½“ $p(\boldsymbol Z)=p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta^*)$ æ—¶ï¼Œä¸ç­‰å¼å³è¾¹ç¬¬ä¸€é¡¹å¯ä»¥è§†ä¸ºä¸€ä¸ªå…³äº $\boldsymbol \theta$ çš„å‡½æ•°ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä½¿å¾—è¯¥å‡½æ•°æœ€å¤§åŒ–çš„ $\boldsymbol \theta$ çš„é—­åˆè§£
        <ul>
          <li>å¦‚æœä¸èƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¸ä¼šé‡‡ç”¨ EM ç®—æ³•</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="38-ç¤ºä¾‹">3.8 ç¤ºä¾‹</h3>

<script type="math/tex; mode=display">\log p(\boldsymbol X|\boldsymbol \theta)\ge \underbrace{\mathbb{E}_{\boldsymbol Z}\left[ \log p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta) \right] - \mathbb{E}_{\boldsymbol Z}\left[ \log p(\boldsymbol Z)\right]}_{\equiv \,G\left(\boldsymbol \theta,\,p(\boldsymbol Z)\right)}\\</script>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-26-WX20200226-170945%402x.png" width="60%" /></p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-26-WX20200226-171003%402x.png" width="60%" /></p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-26-WX20200226-171022%402x.png" width="60%" /></p>

<h3 id="39-em-ä½œä¸ºè¿­ä»£ä¼˜åŒ–">3.9 EM ä½œä¸ºè¿­ä»£ä¼˜åŒ–</h3>
<p><strong><span style="color:steelblue">EM ç®—æ³•æè¿°ï¼š</span></strong><br />
1.$\,$<strong>åˆå§‹åŒ–ï¼š</strong> é€‰æ‹©ï¼ˆéšæœºï¼‰åˆå§‹å€¼ $\boldsymbol \theta^{(1)}$<br />
2.$\,$<strong>æ›´æ–°ï¼š</strong><br />
$\qquad$a. <span style="color:red">E æ­¥éª¤ï¼š</span>è®¡ç®— $Q\left(\boldsymbol \theta,\boldsymbol \theta^{(t)}\right)\equiv \mathbb E_{\boldsymbol Z|\boldsymbol X,\boldsymbol \theta^{(t)}}\left[\log p(\boldsymbol X,\boldsymbol Z| \boldsymbol \theta)\right]$<br />
$\qquad$b. <span style="color:red">M æ­¥éª¤ï¼š</span>$\boldsymbol \theta^{(t+1)}=\mathop{\operatorname{arg\,max}}\limits_{\boldsymbol \theta}Q\left(\boldsymbol \theta,\boldsymbol \theta^{(t)}\right)$<br />
3.$\,$<strong>ç»ˆæ­¢ï¼š</strong> å¦‚æœæ²¡æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆ <span style="color:purple">ç®—æ³•åœæ­¢</span><br />
4.$\,$è¿”å› <span style="color:purple">æ­¥éª¤ 2</span><br />
<br />
<span style="color:red">è¯¥ç®—æ³•æœ€ç»ˆå°†ä¼šåœæ­¢ï¼ˆæ”¶æ•›ï¼‰ï¼Œä½†æœ€ç»ˆå¾—åˆ°çš„ä¼°è®¡å€¼å¯èƒ½åªæ˜¯ä¸€ä¸ªå±€éƒ¨æœ€å¤§å€¼</span></p>

<h3 id="310-è®¾å®šä¸€ä¸ªç´§çš„ä¸‹ç•Œ">3.10 è®¾å®šä¸€ä¸ªç´§çš„ä¸‹ç•Œ</h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†è¯æ˜ä¹‹å‰ <a href="#anchor2">â€œ3.7 æœ€å¤§åŒ–ä¸‹ç•Œâ€</a> ä¸­æåˆ°çš„ï¼š</p>

<blockquote>
  <p>å¯¹äºä»»ä½•ç‚¹ $\boldsymbol \theta^*$ï¼Œå¯ä»¥è¯æ˜è®¾å®š $p(\boldsymbol Z)=p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta^*)$ ä½¿å¾—ä¸‹ç•Œæ›´ç´§</p>
</blockquote>

<p>å›é¡¾ä¹‹å‰<a href="#anchor1">â€œ3.6 åˆ©ç”¨éšå˜é‡â€</a> ä¸­çš„æ¨å¯¼è¿‡ç¨‹ï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\color{steelblue}{\fbox{$\color{black}{\log p(\boldsymbol X|\boldsymbol \theta)}$}} &= \log \sum_{\boldsymbol Z}p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)\\
&= \log \sum_{\boldsymbol Z}\left(p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)\cdot \dfrac{p(\boldsymbol Z)}{p(\boldsymbol Z)} \right)\\
&= \log \sum_{\boldsymbol Z}\left(p(\boldsymbol Z)\cdot \dfrac{p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)}{p(\boldsymbol Z)} \right)\\
&= \log \mathbb{E}_{\boldsymbol Z}\left[\dfrac{p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)}{p(\boldsymbol Z)}\right]\\
&\color{steelblue}{\fbox{$\color{black}{\ge \mathbb{E}_{\boldsymbol Z}\left[ \log \dfrac{p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)}{p(\boldsymbol Z)}\right]}$}}\\
&= \mathbb{E}_{\boldsymbol Z}\left[ \log p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta) \right] - \mathbb{E}_{\boldsymbol Z}\left[ \log p(\boldsymbol Z)\right]
\end{align} %]]></script>

<p>æˆ‘ä»¬å°†æœ€ç»ˆç»“æœå›é€€ä¸€æ­¥ï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\log p(\boldsymbol X|\boldsymbol \theta) &\ge \mathbb{E}_{\boldsymbol Z}\left[ \log \dfrac{p(\boldsymbol X,\boldsymbol Z|\boldsymbol \theta)}{p(\boldsymbol Z)}\right]\\
&= \mathbb{E}_{\boldsymbol Z}\left[ \log \dfrac{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)p(\boldsymbol X|\boldsymbol \theta)}{p(\boldsymbol Z)}\right] \qquad \color{steelblue}{\leftarrow \,æ¦‚ç‡çš„é“¾å¼æ³•åˆ™}\\
&= \mathbb{E}_{\boldsymbol Z}\left[ \log \dfrac{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)}{p(\boldsymbol Z)}+\log p(\boldsymbol X|\boldsymbol \theta)\right]\\
&= \mathbb{E}_{\boldsymbol Z}\left[ \log \dfrac{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)}{p(\boldsymbol Z)}\right] + \mathbb{E}_{\boldsymbol Z}\left[\log p(\boldsymbol X|\boldsymbol \theta)\right] \qquad \color{steelblue}{\leftarrow \, \mathbb{E}[.]\,çš„çº¿æ€§æ€§è´¨}\\
&= \mathbb{E}_{\boldsymbol Z}\left[ \log \dfrac{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)}{p(\boldsymbol Z)}\right] + \log p(\boldsymbol X|\boldsymbol \theta) \qquad \color{steelblue}{\leftarrow \, å¸¸æ•°çš„\,\mathbb{E}[.]\,æ˜¯å…¶æœ¬èº«}\\
\end{align} %]]></script>

<p>æœ€åï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>

<script type="math/tex; mode=display">\color{steelblue}{\overbrace{\color{black}{\log p(\boldsymbol X|\boldsymbol \theta)}}^{æœ€ç»ˆç›®æ ‡ï¼šæœ€å¤§åŒ–}} \ge\, \color{steelblue}{\overbrace{\color{orange}{\underbrace{\color{black}{\mathbb{E}_{\boldsymbol Z}\left[ \log \dfrac{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)}{p(\boldsymbol Z)}\right]}}_{é¦–å…ˆï¼Œæ³¨æ„åˆ°è¯¥é¡¹\,\le\,0 \\è¯¥é¡¹ä¹Ÿç§°ä¸º\,p(\boldsymbol Z)\,å’Œ\, p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)\,ä¹‹é—´çš„\\è´Ÿçš„ \text{ KL (Kullback-Leibler) } æ•£åº¦}} \color{black}{+ \log p(\boldsymbol X|\boldsymbol \theta)}}^{æˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ–çš„ä¸‹ç•Œ}}</script>

<p>å…¶æ¬¡ï¼Œæ³¨æ„åˆ°å¦‚æœ $p(\boldsymbol Z)=p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)$ï¼Œé‚£ä¹ˆ</p>

<script type="math/tex; mode=display">\mathbb{E}_{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)}\left[\log \dfrac{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)}{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)}\right]=\mathbb{E}_{p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta)}[\log 1]=0</script>

<p>å¯¹äºä»»ä½• $\boldsymbol \theta^*$ï¼Œè®¾å®š $p(\boldsymbol Z)=p(\boldsymbol Z|\boldsymbol X,\boldsymbol \theta^*)$ é€šè¿‡åœ¨ $\log p(\boldsymbol X| \boldsymbol \theta^{*})$ ä¸Šæœ€å¤§åŒ–ä¸‹ç•Œï¼Œä½¿å¾—å…¶æ›´ç´§</p>

<h2 id="4-é«˜æ–¯æ··åˆæ¨¡å‹çš„å‚æ•°ä¼°è®¡">4. é«˜æ–¯æ··åˆæ¨¡å‹çš„å‚æ•°ä¼°è®¡</h2>
<p><strong>EM ç®—æ³•çš„ä¸€ä¸ªç»å…¸åº”ç”¨</strong></p>
<h3 id="41-gmm-çš„éšå˜é‡">4.1 GMM çš„éšå˜é‡</h3>
<ul>
  <li>ä»¤ $z_1,â€¦,z_n$ è¡¨ç¤ºå¯¹åº”æ•°æ®ç‚¹ $\boldsymbol x_1,â€¦,\boldsymbol x_n$ çš„ <span style="color:red">çœŸå®æ¥æº</span>ã€‚æ¯ä¸ª $z_i$ éƒ½æ˜¯ä¸€ä¸ªå–å€¼åœ¨ $1,â€¦,k$ ä¹‹é—´çš„ç¦»æ•£å˜é‡ï¼Œå…¶ä¸­ï¼Œ$k$ æ˜¯é›†ç¾¤çš„æ•°é‡</li>
  <li>
    <p>ç°åœ¨ï¼Œå¯¹æ¯”åŸå§‹å¯¹æ•°ä¼¼ç„¶</p>

    <script type="math/tex; mode=display">\log p(\boldsymbol x_1,...,\boldsymbol x_n)=\sum_{i=1}^{n}\log \left(\sum_{c=1}^{k}w_c \mathcal N(\boldsymbol x_i|\boldsymbol \mu_c,\mathbf \Sigma_c)\right)</script>
  </li>
  <li>
    <p>æ ¹æ® <span style="color:red">å®Œå…¨å¯¹æ•°ä¼¼ç„¶</span>ï¼ˆå¦‚æœæˆ‘ä»¬çŸ¥é“ $\boldsymbol z$ï¼‰</p>

    <script type="math/tex; mode=display">\log p(\boldsymbol x_1,...,\boldsymbol x_n,\boldsymbol z)=\sum_{i=1}^{n}\log \left(w_{z_i} \mathcal N(\boldsymbol x_i|\boldsymbol \mu_{z_i},\mathbf \Sigma_{z_i})\right)</script>
  </li>
  <li>å›å¿†ä¸€ä¸‹ï¼Œå¯¹ä¸€ä¸ªæ­£æ€å¯†åº¦å‡½æ•°å–å¯¹æ•°ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ª <span style="color:red">å®¹æ˜“å¤„ç†</span> çš„è¡¨è¾¾å¼</li>
</ul>

<h3 id="42-å¤„ç†å…³äº-boldsymbol-z-çš„ä¸ç¡®å®šæ€§">4.2 å¤„ç†å…³äº $\boldsymbol z$ çš„ä¸ç¡®å®šæ€§</h3>
<ul>
  <li>æˆ‘ä»¬æ— æ³•è®¡ç®—å®Œå…¨å¯¹æ•°ä¼¼ç„¶ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“ $\boldsymbol z$</li>
  <li>EM ç®—æ³•å¤„ç†è¿™ç§ä¸ç¡®å®šæ€§çš„æ–¹æ³•æ˜¯ï¼šå°† $\log p(\boldsymbol X,\boldsymbol z|\boldsymbol \theta)$ ç”¨å…¶æœŸæœ› $\mathbb{E}_{\boldsymbol z|\boldsymbol X,\boldsymbol \theta^{(t)}}\left[\log p(\boldsymbol X,\boldsymbol z|\boldsymbol \theta)\right]$ æ¥æ›¿ä»£</li>
  <li>è¿™åè¿‡æ¥éœ€è¦ç»™å®šå½“å‰å‚æ•°ä¼°è®¡çš„ $\color{red}{p\left(\boldsymbol z|\boldsymbol X,\boldsymbol \theta^{(t)}\right)}$ çš„åˆ†å¸ƒ</li>
  <li></li>
</ul>

<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>ä¸‹èŠ‚å†…å®¹ï¼šé«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰å’ŒæœŸæœ›æœ€å¤§åŒ–ï¼ˆEMï¼‰</p>
:ET