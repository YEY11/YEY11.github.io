I"¼!<!-- æ•°å­¦å…¬å¼ -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>

<h1 id="lecture-00-02-æ•°å€¼ä¼˜åŒ–åŸºç¡€">Lecture 00-02 æ•°å€¼ä¼˜åŒ–åŸºç¡€</h1>

<blockquote>
  <p>å‚è€ƒèµ„æ–™ï¼šNatural Language Processing: Appendix B (p.485-488) â€”â€” by Eisenstein, Jacob</p>
</blockquote>

<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>æ— çº¦æŸæ•°å€¼ä¼˜åŒ–æ¶‰åŠåˆ°æ±‚è§£å…·æœ‰ä»¥ä¸‹å½¢å¼çš„é—®é¢˜ï¼š</p>

<script type="math/tex; mode=display">\min \limits_{\boldsymbol x\in \mathbb R^D}f(\boldsymbol x) \tag{1}</script>

<p>å…¶ä¸­ï¼Œ$x\in \mathbb R^D$ æ˜¯ä¸€ä¸ªç”± $D$ ä¸ªå®æ•°æ„æˆçš„å‘é‡ã€‚</p>

<p>å¾®åˆ†æ˜¯æ•°å€¼ä¼˜åŒ–çš„åŸºç¡€ã€‚å‡è®¾åœ¨æŸä¸ªç‚¹ $\boldsymbol x^*$ å¤„ï¼Œ$f$ çš„æ¯ä¸ªåå¯¼æ•°éƒ½ç­‰äº $0$ï¼šå½¢å¼ä¸Šï¼Œ$\left. \frac{\partial f}{\partial x_i}\right| _{\boldsymbol x^*}=0$ã€‚é‚£ä¹ˆ $\boldsymbol x^*$ è¢«ç§°ä¸º $f$ çš„ä¸€ä¸ª <strong>ä¸´ç•Œç‚¹</strong>ã€‚ å¦‚æœ $f$ æ˜¯ä¸€ä¸ª <strong>å‡¸å‡½æ•°</strong>ï¼Œé‚£ä¹ˆ $f(\boldsymbol x^*)$ çš„å€¼ç­‰äº $f$ çš„å…¨å±€æœ€å°å€¼ï¼Œå½“ä¸”ä»…å½“ $\boldsymbol x^*$ æ˜¯ $f$ çš„ä¸´ç•Œç‚¹æ—¶ã€‚</p>

<p>ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªå‡¸å‡½æ•° $f(x)=(x-2)^2+3$ï¼Œå¦‚ <a href="#fig1">å›¾ 1(a)</a> æ‰€ç¤ºã€‚å…¶å¯¼æ•°ä¸º $\frac{\partial f}{\partial x}=2x-4$ã€‚é€šè¿‡å°†å¯¼æ•°è®¾ç½®ä¸ºé›¶å¹¶æ±‚è§£ $x$ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªå”¯ä¸€çš„æœ€å°å€¼ $x^* = 2$ã€‚ç°åœ¨è€ƒè™‘ä¸€ä¸ªå¤šå…ƒå‡¸å‡½æ•° $f(\boldsymbol x)=\frac{1}{2}\|\boldsymbol x-[2,1]^{\top}\|^2$ ï¼Œå…¶ä¸­ $\|\boldsymbol x \|^2$ æ˜¯å¹³æ–¹æ¬§å‡ é‡Œå¾—èŒƒæ•°ã€‚åå¯¼æ•°ä¸ºï¼š</p>

<script type="math/tex; mode=display">\dfrac{\partial d}{\partial x_1}=x_1-2  \tag{2}</script>

<script type="math/tex; mode=display">\dfrac{\partial d}{\partial x_2}=x_2-1  \tag{3}</script>

<p>å”¯ä¸€æœ€å°å€¼ä¸º $\boldsymbol x^*=[2,1]^{\top}$ã€‚</p>

<p><a name="fig1"><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-28-WX20200228-231327%402x.png" /></a></p>

<p><strong><center><span style="font-size:10pt">å›¾ 1ï¼šä¸¤ä¸ªå…·æœ‰å”¯ä¸€å…¨å±€æœ€å°å€¼çš„å‡½æ•°</span></center></strong></p>

<p>å¯¹äºéå‡¸å‡½æ•°ï¼Œä¸´ç•Œç‚¹ä¸ä¸€å®šæ˜¯å…¨å±€æœ€å°å€¼ã€‚ä¸€ä¸ªå±€éƒ¨æœ€å°å€¼ $\boldsymbol x^*$ æ„å‘³ç€å‡½æ•°åœ¨è¯¥ç‚¹å¤„çš„å–å€¼å°äºåœ¨å…¶æ‰€æœ‰è¿‘é‚»ç‚¹çš„å–å€¼ï¼šå½¢å¼ä¸Šï¼Œ$\boldsymbol x^*$ æ˜¯ä¸€ä¸ªå±€éƒ¨æœ€å°å€¼ï¼Œå¦‚æœå­˜åœ¨æŸä¸ªæ­£å€¼ $\epsilon$ ä½¿å¾— $f(\boldsymbol x^*)\le f(\boldsymbol x)$ å¯¹äºæ‰€æœ‰å’Œ $\boldsymbol x^*$ è·ç¦»åœ¨ $\epsilon$ ä»¥å†…çš„ $\boldsymbol x$ éƒ½æˆç«‹ã€‚<a href="#fig1">å›¾ 1(b)</a> æç»˜äº†å‡½æ•° $f(x)=|x|-2\cos(x)$ï¼Œå®ƒå…·æœ‰è®¸å¤šå±€éƒ¨æœ€å°å€¼ï¼Œå¹¶ä¸”åœ¨ $x = 0$ å¤„è¿˜å…·æœ‰ä¸€ä¸ªå”¯ä¸€çš„å…¨å±€æœ€å°å€¼ã€‚ä¸´ç•Œç‚¹ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°çš„å±€éƒ¨æœ€å¤§å€¼æˆ–è€…å…¨å±€æœ€å¤§å€¼ï¼›å®ƒä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª <strong>éç‚¹</strong>ï¼Œè‡³å°‘åœ¨ä¸€ä¸ªåæ ‡æ–¹å‘ä¸Šæ˜¯æœ€å°å€¼ï¼Œè€Œåœ¨è‡³å°‘ä¸€ä¸ªå…¶ä½™çš„åæ ‡æ–¹å‘ä¸Šæ˜¯æœ€å¤§å€¼ï¼›å®ƒè¿˜å¯ä»¥æ˜¯ä¸€ä¸ª <strong>æ‹ç‚¹</strong>ï¼Œæ—¢ä¸æ˜¯æœ€å°å€¼ï¼Œä¹Ÿä¸æ˜¯æœ€å¤§å€¼ã€‚å¦‚æœå¯ä»¥çš„è¯ï¼Œ$f$ çš„äºŒé˜¶å¯¼æ•°å¯ä»¥å¸®åŠ©åŒºåˆ†è¿™äº›æƒ…å†µã€‚</p>

<h2 id="1-æ¢¯åº¦ä¸‹é™">1. æ¢¯åº¦ä¸‹é™</h2>
<p>å¯¹äºè®¸å¤šå‡¸å‡½æ•°ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æ±‚å¾— $\boldsymbol x^*$ çš„é—­åˆè§£ã€‚åœ¨æ¢¯åº¦ä¸‹é™ä¸­ï¼Œæˆ‘ä»¬è®¡ç®—ä¸€ç³»åˆ—çš„è§£ï¼Œ$\boldsymbol x^{(0)},\boldsymbol x^{(1)},â€¦$ æ–¹æ³•æ˜¯é€šè¿‡æ²¿ç€å±€éƒ¨æ¢¯åº¦ $\nabla_{\boldsymbol x^{(t)}}f$ çš„æ–¹å‘ä¸€æ­¥æ­¥å‰è¿›ï¼Œè¿™é‡Œçš„æ¢¯åº¦æ˜¯åœ¨ç‚¹ $\boldsymbol x^{(t)}$ å¤„æ±‚å¾—çš„å‡½æ•° $f$ çš„åå¯¼æ•°æ„æˆçš„å‘é‡ã€‚æ¯ä¸ªè§£ $\boldsymbol x^{(t+1)}$ å¯ä»¥æ ¹æ®ä¸‹å¼è®¡ç®—å¾—åˆ°ï¼š</p>

<script type="math/tex; mode=display">\boldsymbol x^{(t+1)} \leftarrow \boldsymbol x^{(t)} - \eta^{(t)}\nabla_{\boldsymbol x^{(t)}}f  \tag{4}</script>

<p>å…¶ä¸­ï¼Œ$\eta^{(t)}&gt;0$ æ˜¯ä¸€ä¸ª <strong>æ­¥é•¿</strong>ã€‚å¦‚æœé€‚å½“é€‰æ‹©æ­¥é•¿ï¼Œé‚£ä¹ˆæ­¤è¿‡ç¨‹å°†ä¼šæ‰¾åˆ°ä¸€ä¸ªå¯å¾®å‡¸å‡½æ•°çš„å…¨å±€æœ€å°å€¼ã€‚å¯¹äºéå‡¸å‡½æ•°ï¼Œæ¢¯åº¦ä¸‹é™å°†æ‰¾åˆ°ä¸€ä¸ªå±€éƒ¨æœ€å°å€¼ã€‚</p>

<h2 id="2-çº¦æŸä¼˜åŒ–">2. çº¦æŸä¼˜åŒ–</h2>
<p>å¾ˆå¤šæ—¶å€™ï¼Œä¼˜åŒ–å¿…é¡»åœ¨çº¦æŸæ¡ä»¶ä¸‹è¿›è¡Œï¼šä¾‹å¦‚ï¼Œå½“å¯¹ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°è¿›è¡Œä¼˜åŒ–æ—¶ï¼Œæ‰€æœ‰äº‹ä»¶çš„æ¦‚ç‡ä¹‹å’Œå¿…é¡»ç­‰äº $1$ã€‚çº¦æŸä¼˜åŒ–é—®é¢˜å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>

<script type="math/tex; mode=display">\min \limits_{\boldsymbol x}f(\boldsymbol x) \tag{5}</script>

<script type="math/tex; mode=display">\text{s.t.} \quad g_c(\boldsymbol x)\le 0,\qquad \forall c=1,2,...,C  \tag{6}</script>

<p>å…¶ä¸­ï¼Œæ¯ä¸ª $g_c(\boldsymbol x)$ éƒ½æ˜¯ $\boldsymbol x$ çš„ä¸€ä¸ªæ ‡é‡å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ $\boldsymbol x$ å¿…é¡»ä¸ºéè´Ÿï¼Œå¹¶ä¸”å…¶æ€»å’Œä¸èƒ½è¶…è¿‡é¢„è®¾çš„ $b$ã€‚ç„¶åï¼Œå­˜åœ¨ $D+1$ ä¸ªä¸ç­‰å¼çº¦æŸï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
g_i(\boldsymbol x) &= -x_i,\qquad \forall i=1,2,...,D  \tag{7}\\
g_{D+1}(\boldsymbol x) &= -b+\sum_{i=1}^{D}x_i \tag{8}
\end{align} %]]></script>

<p>ä¸ç­‰å¼çº¦æŸå¯ä»¥ä¸åŸå§‹ç›®æ ‡å‡½æ•° $f$ ç»“åˆèµ·æ¥ï¼Œè¿™å¯ä»¥é€šè¿‡æ„é€ ä¸€ä¸ª <strong>æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹</strong> å®ç°ï¼š</p>

<script type="math/tex; mode=display">L(\boldsymbol x,\boldsymbol \lambda)=f(\boldsymbol x)+\sum_{c=1}^{C}\lambda_c g_c(\boldsymbol x)  \tag{9}</script>

<p>å…¶ä¸­ï¼Œ$\lambda_c$ æ˜¯ä¸€ä¸ª <strong>æ‹‰æ ¼æœ—æ—¥ä¹˜å­</strong>ã€‚å¯¹äºä»»ä½•æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªå¯¹åº”çš„å¯¹å¶å½¢å¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…³äº $\boldsymbol \lambda$ çš„å‡½æ•°ï¼š</p>

<script type="math/tex; mode=display">D(\boldsymbol \lambda)=\min \limits_{\boldsymbol x} L(\boldsymbol x,\boldsymbol \lambda)  \tag{10}</script>

<p>æˆ‘ä»¬å¯ä»¥å°†æ‹‰æ ¼æœ—æ—¥å‡½æ•° $L$ ç§°ä¸ºé—®é¢˜çš„åŸå§‹å½¢å¼ã€‚</p>

<h2 id="3-ä¾‹å­è¢«åŠ¨æ”»å‡»åœ¨çº¿å­¦ä¹ ">3. ä¾‹å­ï¼šè¢«åŠ¨æ”»å‡»åœ¨çº¿å­¦ä¹ </h2>
<p>æœ‰æ—¶å¯ä»¥é€šè¿‡æ”¹é€ æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹æ¥è§£å†³çº¦æŸä¼˜åŒ–é—®é¢˜ã€‚ä¸€ä¸ªä¾‹å­æ˜¯æœ´ç´ è´å¶æ–¯æ¦‚ç‡æ¨¡å‹çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸å¿…æ˜¾å¼è®¡ç®—æ‹‰æ ¼æœ—æ—¥ä¹˜å­ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯ç”¨äºåœ¨çº¿å­¦ä¹ çš„ <strong>è¢«åŠ¨æ”»å‡»ç®—æ³•ï¼ˆpassive-aggressive algorithmï¼‰</strong>ï¼ˆCrammer ç­‰ï¼Œ2006ï¼‰ã€‚è¯¥ç®—æ³•ä¸æ„ŸçŸ¥å™¨ç±»ä¼¼ï¼Œä½†å…¶åœ¨æ¯ä¸€æ­¥çš„ç›®æ ‡æ˜¯è¿›è¡Œæœ€ä¿å®ˆçš„æ›´æ–°ï¼Œä½¿å¾—å½“å‰æ ·æœ¬ä¸Šçš„è¾¹ç¼˜æŸå¤±ä¸ºé›¶ã€‚ï¼ˆ<em><span style="font-size:10pt">è¿™æ˜¯è¯¥ç®—æ³•åç§°çš„åŸºç¡€ï¼šå½“æŸå¤±ä¸ºé›¶æ—¶å®ƒæ˜¯è¢«åŠ¨çš„ï¼Œä½†åœ¨å¿…è¦æ—¶ä¼šä¸»åŠ¨å‡ºå‡»ä½¿æŸå¤±ä¸ºé›¶ã€‚</span></em>ï¼‰æ¯æ¬¡æ›´æ–°éƒ½å¯ä»¥è¡¨è¿°ä¸ºä¸€ä¸ªæƒé‡ $\boldsymbol \theta$ ä¸Šçš„çº¦æŸä¼˜åŒ–ï¼š</p>

<script type="math/tex; mode=display">\min \limits_{\boldsymbol \theta}\dfrac{1}{2}\|\boldsymbol \theta-\boldsymbol \theta^{(i-1)}\|^2 \tag{11}</script>

<script type="math/tex; mode=display">\text{s.t.}\quad \ell^{(i)}(\boldsymbol \theta)=0 \tag{12}</script>

<p>å…¶ä¸­ï¼Œ$\boldsymbol \theta^{(i-1)}$ æ˜¯å…ˆå‰çš„æƒé‡é›†åˆï¼Œ$\ell^{(i)}(\boldsymbol \theta)$ æ˜¯å®ä¾‹ $i$ ä¸Šçš„è¾¹ç¼˜æŸå¤±ã€‚è¯¥æŸå¤±å®šä¹‰ä¸ºï¼š</p>

<script type="math/tex; mode=display">\ell^{(i)}(\boldsymbol \theta)=1-\boldsymbol \theta \cdot \boldsymbol f(\boldsymbol x^{(i)},y^{(i)})+\max \limits_{y\ne y^{(i)}}\boldsymbol \theta \cdot \boldsymbol f(\boldsymbol x^{(i)},y)  \tag{13}</script>

<p>å½“ $\boldsymbol \theta^{(i-1)}$ çš„è¾¹ç¼˜æŸå¤±ä¸ºé›¶æ—¶ï¼Œæœ€ä¼˜è§£ä¸º $\boldsymbol \theta^*= \boldsymbol \theta^{(i-1)}$ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°†ä¸»è¦å…³æ³¨ $\ell^{(i)}(\boldsymbol \theta^{(i-1)})&gt;0$ çš„æƒ…å†µã€‚è¯¥é—®é¢˜çš„æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹ä¸ºï¼š</p>

<script type="math/tex; mode=display">L(\boldsymbol \theta,\lambda)=\dfrac{1}{2}\|\boldsymbol \theta-\boldsymbol \theta^{(i-1)}\|^2 + \lambda \ell^{(i)}(\boldsymbol \theta)  \tag{14}</script>

<p>ä¿æŒ $\lambda$ ä¸å˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¾®åˆ†æ¥æ±‚è§£ $\boldsymbol \theta$ï¼š</p>

<script type="math/tex; mode=display">\nabla_{\boldsymbol \theta}L=\boldsymbol \theta-\boldsymbol \theta^{(i-1)}+\lambda \dfrac{\partial}{\partial \boldsymbol \theta}\ell^{(i)}(\boldsymbol \theta) \tag{15}</script>

<script type="math/tex; mode=display">\boldsymbol \theta^*=\boldsymbol \theta^{(i-1)}+\lambda \boldsymbol \delta  \tag{16}</script>

<p>å…¶ä¸­ï¼Œ$\boldsymbol \delta=\boldsymbol f(\boldsymbol x^{(i)},y^{(i)})-\boldsymbol f(\boldsymbol x^{(i)},\hat y)$ï¼Œå¹¶ä¸” $\hat y=\mathop{\operatorname{arg\,max}}_{y\ne y^{(i)}}\boldsymbol \theta \cdot \boldsymbol f(\boldsymbol x^{(i)},y)$</p>

<p>æ‹‰æ ¼æœ—æ—¥ä¹˜å­ $\lambda$ çš„ä½œç”¨ç›¸å½“äºæ„ŸçŸ¥å™¨ä¸­æ›´æ–° $\boldsymbol \theta$ çš„å­¦ä¹ ç‡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°† $\boldsymbol \theta^*$ å›ä»£å…¥æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹ä¸­ï¼Œå¾—åˆ°å¯¹å¶å‡½æ•°æ¥æ±‚è§£ $\lambda$ï¼š</p>

<p>ä¸‹èŠ‚å†…å®¹ï¼šæ•°å€¼ä¼˜åŒ–åŸºç¡€</p>
:ET