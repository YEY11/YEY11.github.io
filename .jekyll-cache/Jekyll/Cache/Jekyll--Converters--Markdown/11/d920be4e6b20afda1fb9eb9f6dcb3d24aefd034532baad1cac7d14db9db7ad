I" <h1 id="lecture-07-å› å­åˆ†æ">Lecture 07 å› å­åˆ†æ</h1>

<p><strong>å‚è€ƒæ•™æ</strong>ï¼š</p>

<ul>
  <li><em>Hardle, W. and Simar, L (2015). Applied multivariate statistical analysis, 4th edition.</em></li>
  <li><em>Hastie, T. Tibshirani, R. and Friedman, J. (2009). The elements of statistical learning, 2nd edition</em></li>
</ul>

<h2 id="1-æ­£äº¤å› å­æ¨¡å‹">1. æ­£äº¤å› å­æ¨¡å‹</h2>

<p>ä»¤ $X \sim (\mu, \Sigma)$ ä¸ºä¸€ä¸ª $p$ ç»´çš„éšæœºå‘é‡ã€‚åœ¨ PCA ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœ $\Sigma$ åªæœ‰ $q&lt; p$ ä¸ªéé›¶ç‰¹å¾å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°† $X$ è¡¨ç¤ºä¸º</p>

<script type="math/tex; mode=display">X-\mu =\Gamma_{(1)}Y_{(1)} \tag{1}</script>

<p>(ä¹‹æ‰€ä»¥å‡å» $\mu$ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬çš„è®¡ç®—æ˜¯é’ˆå¯¹å‡å€¼ä¸ºé›¶çš„ $X$)ã€‚</p>

<p>å…¶ä¸­ï¼Œ</p>

<script type="math/tex; mode=display">\Gamma_{(1)}=\underbrace{(\gamma_1,\dots,\gamma_q)}_{p \times q}</script>

<p>å¹¶ä¸”</p>

<script type="math/tex; mode=display">Y_{(1)}=\underbrace{(Y_1,\dots,Y_q)^{\mathrm T}}_{q \times 1}</script>

<p>æ˜¯ä¸»æˆåˆ† (PCs) çš„ $p$ ç»´å‘é‡ $Y=\Gamma^{\mathrm T} X$ çš„å‰ $q$ ä¸ªåˆ†é‡ã€‚</p>

<p>å›å¿†ä¸€ä¸‹ï¼Œ$Y_{(1)}\sim (0, \Lambda_1)$ï¼Œå…¶ä¸­ $\Lambda_1=\text{diag}(\lambda_1,\dots,\lambda_q)$ã€‚</p>

<p>ä»¤ $Q=\Gamma_{(1)}\Lambda_{(1)}^{1/2}$ å’Œ $F=\Lambda_{(1)}^{-1/2}Y_{(1)}$ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¼ $(1)$ é‡å†™ä¸º</p>

<script type="math/tex; mode=display">X=QF+\mu</script>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\mathrm{E}(F) &= 0 \\[2ex]
\mathrm{Var}(F) &= \Lambda_{(1)}^{-1/2}\mathrm{Var}(Y_{(1)})\Lambda_{(1)}^{-1/2}=I_q \\[2ex]
\Sigma &= \mathrm{Var}(X)=Q\mathrm{Var}(F)Q^{\mathrm T} = QQ^{\mathrm T} = \sum_{j=1}^{q}\lambda_j \gamma_j \gamma_j^{\mathrm T}
\end{align} %]]></script>

<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ$X$ å¯ä»¥å®Œå…¨ç”± $F=(F_1,\dots,F_q)^{\mathrm T}$ ä¸­çš„ $q &lt; p$ ä¸ª <strong>ä¸ç›¸å…³</strong> å› å­çš„åŠ æƒå’Œç¡®å®šã€‚</p>

<ul>
  <li>
    <p>æ³¨æ„ï¼ŒåŸå§‹ç»´åº¦ä¸º ${p \choose 2} + p = \frac{p(p+1)}{2}$ çš„ $\mathrm{Var}(X)$ å¯ä»¥ç”±å…·æœ‰ $qp$ é¡¹çš„è½½è·çŸ©é˜µ $Q$ çš„å› å­å®Œå…¨è§£é‡Šã€‚</p>
  </li>
  <li>
    <p>å½“ $q \ll p$ æ—¶ï¼Œ$\frac{p(p+1)}{2}$ çš„é˜¶æ•°çº¦ä¸º $O(p^2)$ï¼Œè€Œ $qp$ çš„é˜¶æ•°çº¦ä¸º $O(p)$ã€‚ $\Rightarrow$ æˆ‘ä»¬å®ç°äº† <strong>é™ç»´</strong>ã€‚</p>
  </li>
  <li>
    <p>$Q$ çš„ç»´æ•°æ˜¯ä¸€ä¸ªå¾®å¦™çš„é—®é¢˜ï¼Œä¸ä»…ä»…æ˜¯ $qp$ã€‚æˆ‘ä»¬ç¨åä¼šå¯¹æ­¤è¯¦ç»†ä»‹ç»ã€‚</p>
  </li>
</ul>

<p>ä½†äº‹æƒ…å¾€å¾€ä¸ä¼šå¦‚æ­¤ç†æƒ³ã€‚</p>

<p>é€šå¸¸ï¼Œåœ¨ <strong>æ­£äº¤å› å­æ¨¡å‹ (orthogonal factor model)</strong> ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ä»¥ä¸‹æ•°æ®ç”Ÿæˆæœºåˆ¶ï¼šå­˜åœ¨ç”± $q$ ä¸ª <strong>å…¬å…±å› å­ (common factors)</strong> ç»„æˆçš„éšæœºå‘é‡ $F =(F_1,\dots,F_q)^{\mathrm T}$ å’Œ ç”± $p$ ä¸ª <strong>ç‰¹å®šå› å­ (speciï¬c factors)</strong> ç»„æˆçš„éšæœºå‘é‡ $U =(U_1,\dots,U_p)$ï¼Œä½¿å¾—</p>

<script type="math/tex; mode=display">X=QF+U+\mu</script>

<p>å¹¶ä¸”</p>

<ul>
  <li>$\mathrm{E}(F)=0$</li>
  <li>$\mathrm{Var}(F)=I_q$</li>
  <li>$\mathrm{E}(U)=0$</li>
  <li>$\mathrm{Cov}(U_i,U_j)=0 \quad \text{if} \quad i\ne j$</li>
  <li>$\mathrm{Cov}(F,U)=0$</li>
</ul>

<p>$Q$ æ˜¯ä¸€ä¸ª $p\times q$ çš„ééšæœºçŸ©é˜µï¼Œå…¶åˆ†é‡ç§°ä¸º <strong>è½½è· (loadings)</strong>ã€‚</p>

<p>ç‰¹åˆ«åœ°ï¼Œ$\mathrm{Var}(U)\equiv \Psi \equiv \mathrm{diag}(\psi_1,\dots,\psi_p)$ æ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µã€‚</p>

<p>ç°åœ¨ï¼Œå¯¹äº $\Sigma := \mathrm{Var}(X)$ï¼Œæˆ‘ä»¬æœ‰</p>

<script type="math/tex; mode=display">\Sigma = \mathrm{Var}(QF+U)=\mathrm{Var}(QF) + \mathrm{Var}(U)= QQ^{\mathrm T} + \Psi</script>

<p>å¦‚æœ $q \ll p$ï¼Œæ˜¯å¦å®ç°äº†é™ç»´ï¼Ÿæ˜¯çš„ï¼Œ$Q$ å’Œ $\Psi$ ä¸­æ€»å…±åªæœ‰ $qp + p$ é¡¹ï¼Œè¿™è¦è¿œå°‘äº $p(p + 1)/ 2$ã€‚</p>

<p>ä»æŸç§æ„ä¹‰ä¸Šçœ‹ï¼Œ$X$ çš„ $p$ ä¸ªåˆ†é‡ä¹‹é—´çš„ç›¸å…³æ€§å®Œå…¨æ˜¯é€šè¿‡è½½è·çš„å› å­æ¥è§£é‡Šçš„ï¼Œè€Œ $U_i$ ä¼šä¸ºæ¯ä¸ªåˆ†é‡æ·»åŠ ä¸€äº›ç‰¹å®šçš„å™ªå£°ã€‚</p>

<ul>
  <li>å†å²ï¼šSpearman å°†å› å­åˆ†ææ¨¡å‹å¼•å…¥äº†å¿ƒç†å­¦é¢†åŸŸä¸­çš„ä¸€äº›é‡è¦åº”ç”¨ã€‚(åœ¨å…¶ä»–ä¸€äº›ç»Ÿè®¡å­¦è¯¾ç¨‹ä¸­ï¼Œä¹Ÿè¢«ç§°ä¸ºâ€œ Spearmanâ€™s $\rho$â€ï¼‰</li>
  <li>å¦‚æœ $q = 1$ï¼Œåˆ™ $F$ ä¸ºä¸å¯è§‚æµ‹å±æ€§ (ä¾‹å¦‚ï¼Œæ™ºåŠ›ç­‰å› ç´ )ï¼Œè€Œ $X_i$ å¯èƒ½æ˜¯åœ¨ä¸åŒè®¤çŸ¥ä»»åŠ¡ä¸­è·å¾—çš„åˆ†æ•°ã€‚</li>
  <li>å‚è§ Hardle å’Œ Simar æ•™æçš„ç¬¬ 363 é¡µã€‚</li>
</ul>

<h2 id="2-è§£é‡Šå› å­">2. è§£é‡Šå› å­</h2>

<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸ PCA ä¸­ç±»ä¼¼çš„å·¥å…·æ¥è§£é‡Šè¿™äº›å› å­ã€‚</p>

<p>æˆ‘ä»¬å¯ä»¥ä¾æ¬¡ç”¨å„åˆ†é‡è¡¨ç¤ºæ¨¡å‹</p>

<script type="math/tex; mode=display">X=QF+U+\mu</script>

<p>å³ï¼Œå¯¹äº $j=1,\dots,p$ï¼Œ</p>

<script type="math/tex; mode=display">X_j = \sum_{\ell=1}^{q}q_{j\ell}F_{\ell} + U_j + \mu_j</script>

<p>å…¶ä¸­ï¼Œ$q_{j\ell}$ æ˜¯ $Q$ ä¸­çš„ç¬¬ $(j,\ell)$ ä¸ªå…ƒç´ ã€‚</p>

<p>å›å¿† $\mathrm{Cov}(U,F)=0$ï¼Œ$\mathrm{Var}(F)=I_q$ï¼Œ$\mathrm{Var}(U) = \mathrm{diag}(\psi_1,\dots,\psi_p)$ï¼Œå¯ä»¥æ¨æ–­å‡º</p>

<script type="math/tex; mode=display">\mathrm{Var}(X_j)=\sum_{\ell=1}^{q}q_{j\ell}^2 + \psi_j</script>

<p>å…¶ä¸­ï¼Œ$\sum_{\ell=1}^{q}q_{j\ell}^2$ è¢«ç§°ä¸º <strong>å…¬å…±æ–¹å·® (communality variance)</strong>ï¼Œ$\psi_j$ åˆ™è¢«ç§°ä¸º <strong>ç‰¹å®šæ–¹å·® (speciï¬c variance)</strong>ã€‚</p>

<p>ç„¶åï¼Œ</p>

<script type="math/tex; mode=display">\dfrac{\sum_{\ell=1}^{q}q_{j\ell}^2}{\mathrm{Var}(X_j)} \tag{2}</script>

<p>æ˜¯ $X_j$ çš„æ–¹å·®ä¸­ç”± $q$ ä¸ªå› å­è§£é‡Šçš„éƒ¨åˆ†æ‰€å çš„æ¯”ä¾‹ã€‚å…¶å€¼è¶Šæ¥è¿‘ $1$ï¼Œåˆ™è¯´æ˜è¿™ $q$ ä¸ªå› å­å¯¹ $X_j$ çš„æ–¹å·®è§£é‡Šç¨‹åº¦è¶Šå¥½ã€‚</p>

<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº›å› å­ä¸ $X_j$ ä¹‹é—´çš„ç›¸å…³ç³»æ•°å°†äºŒè€…è”ç³»èµ·æ¥ã€‚ç”±äº $X=QF+U+\mu$ï¼Œæˆ‘ä»¬æœ‰</p>

<script type="math/tex; mode=display">\mathrm{Cov}(X,F)=\mathrm{Cov}(QF+U,F)=\mathrm{Cov}(QF,F)=Q\mathrm{Cov}(F,F)=Q</script>

<p>å¹¶ä¸”ï¼Œç”±äº $\mathrm{Var}(X_j)=\sigma_{jj}$ å’Œ $\mathrm{Var}(F_j)=1$ï¼Œå¯ä»¥æ¨æ–­å‡º</p>

<script type="math/tex; mode=display">\mathrm{Corr}(X,F)=D^{-1/2}Q</script>

<p>å…¶ä¸­ï¼Œ$D=\mathrm{diag}(\sigma_{11},\dots,\sigma_{pp})$ã€‚</p>

<p>å°±åƒæˆ‘ä»¬åœ¨ PCA ä¸­æ‰€åšçš„ä¸€æ ·ï¼Œé€šè¿‡åˆ†æè¿™äº›ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“ªäº› $X_j$ ä¸æ¯ä¸ªå› å­éƒ½é«˜åº¦ç›¸å…³ï¼Œå¹¶ç”±æ­¤æ¨æ–­å‡ºè¿™äº›å› å­çš„ä¸€ç§è§£é‡Šã€‚</p>

<h2 id="3-ç¼©æ”¾æ•°æ®">3. ç¼©æ”¾æ•°æ®</h2>

<p>å¦‚æœæˆ‘ä»¬æ”¹å˜ $X_j$ çš„æµ‹é‡å°ºåº¦ä¼šæ€æ ·ï¼Ÿå‡è®¾æˆ‘ä»¬ä½¿ç”¨ $Y = CX$ æ¥ä»£æ›¿ $X$ï¼Œå…¶ä¸­ $C = \mathrm{diag}(c_1,\dots,c_p)$ã€‚å›æƒ³ä¸€ä¸‹</p>

<script type="math/tex; mode=display">X=QF+U+\mu</script>

<p>å¯ä»¥æ¨æ–­å‡º</p>

<script type="math/tex; mode=display">Y=Q_Y F+U_Y+\mu_Y</script>

<p>å…¶ä¸­ï¼Œ$U_Y=CU$ï¼Œ$\mathrm{Var}(U_Y)=\Psi_Y$ï¼Œå¹¶ä¸”æˆ‘ä»¬å®šä¹‰</p>

<script type="math/tex; mode=display">Q_Y=CQ, \quad \Psi_Y=C\Psi C^{\mathrm T}, \quad \mu_Y=C\mu \tag{3}</script>

<p>è¿™ç§æƒ…å†µä¸‹ï¼Œå› å­ $F$ å¹¶æ²¡æœ‰æ”¹å˜ï¼Œå¹¶ä¸”æ–°æ¨¡å‹ä»ç„¶æ˜¯ä¸€ä¸ªæ­£äº¤å› å­æ¨¡å‹ï¼š</p>

<ul>
  <li>$\mathrm{E}(F)=0$</li>
  <li>$\mathrm{Var}(F)=I_q$</li>
  <li>$\mathrm{E}(U_Y)=0$</li>
  <li>$\mathrm{Cov}(U_{Y,i},U_{Y,j})=0 \quad \text{if} \quad i\ne j$</li>
  <li>$\mathrm{Cov}(F,U_Y)=0$</li>
</ul>

<p>ç”±äºç¼©æ”¾ä¸ä¼šå½±å“ $F$ï¼Œå› æ­¤åœ¨è®¸å¤šåº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç»è¿‡ç¼©æ”¾å’Œä¸­å¿ƒåŒ–çš„æ•°æ®æ¥æœç´¢è½½è·ï¼Œå³ä½¿ç”¨æ•°æ®</p>

<script type="math/tex; mode=display">Y=D^{-1/2}(X-\mu)</script>

<p>å…¶ä¸­ï¼Œ$D=\mathrm{diag}(\sigma_{11},\dots,\sigma_{pp})$ã€‚</p>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨ä»¥ä¸‹æ¨¡å‹ä¸­æœç´¢ $Q_Y$ å’Œ $\Psi_Y$ï¼Œ</p>

<script type="math/tex; mode=display">Y=Q_YF+U_Y</script>

<p>åœ¨ä¸ä»¥å‰ç›¸åŒçš„å‡è®¾ä¸‹ï¼š</p>

<ul>
  <li>$\mathrm{E}(F)=0$</li>
  <li>$\mathrm{Var}(F)=I_q$</li>
  <li>$\mathrm{E}(U_Y)=0$</li>
  <li>$\mathrm{Cov}(U_{Y,i},U_{Y,j})=0 \quad \text{if} \quad i\ne j$</li>
  <li>$\mathrm{Cov}(F,U_Y)=0$</li>
</ul>

<p>å¹¶ä¸”ï¼Œ$\mathrm{Var}(Y)=\mathrm{Corr}(Y)=Q_Y Q_Y^{\mathrm T} + \Psi_Y$ã€‚</p>

<p>ä»¤ $q_{Y,j\ell}$ è¡¨ç¤º $Q_Y$ çš„ç¬¬ $(j,\ell)$ ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆï¼Œå¯¹äº $j=1,\dots,p$ï¼Œ</p>

<script type="math/tex; mode=display">\sum_{ell=1}^{q}q_{Y,j\ell}^2 +\psi_{Y,j}=\mathrm{Var}()</script>

<p>====================================================================</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-09-27-WX20200927-224826%402x.png" width="80%" /></p>

<p><span><center> <span style="font-size:10pt"> <span style="color:steelblue;font-weight:bold">å›¾ 1</span>ï¼š2 ç»´æ•°æ®çš„æ•£ç‚¹å›¾</span></center></span></p>

<p>ä¸‹èŠ‚å†…å®¹ï¼šä¸»æˆåˆ†åˆ†æ</p>
:ET