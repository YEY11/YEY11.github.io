I"ŞN<h1 id="lecture-14-è´å¶æ–¯å›å½’">Lecture 14 è´å¶æ–¯å›å½’</h1>
<h2 id="ä¸»è¦å†…å®¹">ä¸»è¦å†…å®¹</h2>
<ul>
  <li><strong>ç‚¹ä¼°è®¡æ²¡æœ‰æ•æ‰åˆ°çš„ä¸ç¡®å®šæ€§</strong></li>
  <li><strong>è´å¶æ–¯æ–¹æ³•ä¿ç•™äº†ä¸ç¡®å®šæ€§</strong></li>
  <li><strong>é¡ºåºè´å¶æ–¯æ›´æ–°</strong></li>
  <li><strong>å…±è½­å…ˆéªŒï¼ˆNormal-Normalï¼‰</strong></li>
  <li><strong>åˆ©ç”¨åéªŒåœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œè´å¶æ–¯é¢„æµ‹</strong></li>
</ul>

<h2 id="1-å›é¡¾è´å¶æ–¯">1. å›é¡¾è´å¶æ–¯</h2>
<h3 id="11-è®­ç»ƒ--ä¼˜åŒ–">1.1 è®­ç»ƒ = ä¼˜åŒ–ï¼Ÿ</h3>
<p><strong>å­¦ä¹ ä¸æ¨æ–­é˜¶æ®µï¼š</strong></p>
<ul>
  <li><strong><span style="color:steelblue">å¯¹äºåˆ†ç±»é—®é¢˜ï¼š</span></strong>
    <ul>
      <li>
        <p>å»ºæ¨¡ï¼ˆä»¥ Logistic å›å½’ä¸ºä¾‹ï¼‰</p>

\[p(y|\boldsymbol x)=\text{sigmoid}(\boldsymbol x'\boldsymbol w)\]
      </li>
      <li>
        <p>å‚æ•°æ‹Ÿåˆæ•°æ®</p>

\[\hat{\boldsymbol w}=\mathop{\operatorname{arg\,max}}\limits_{\boldsymbol w}p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)\]
      </li>
      <li>
        <p>è¿›è¡Œé¢„æµ‹</p>

\[p(y_*|\boldsymbol x_*)=\text{sigmoid}(\boldsymbol x_*'\hat{\boldsymbol w})\]
      </li>
    </ul>
  </li>
  <li><strong><span style="color:steelblue">å¯¹äºå›å½’é—®é¢˜ï¼š</span></strong>
    <ul>
      <li>
        <p>å»ºæ¨¡</p>

\[p(y|\boldsymbol x)=\text{Normal}(\boldsymbol x'\boldsymbol w;\sigma^2)\]
      </li>
      <li>
        <p>å‚æ•°æ‹Ÿåˆæ•°æ®</p>

\[\hat{\boldsymbol w}=\mathop{\operatorname{arg\,max}}\limits_{\boldsymbol w}p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)\]
      </li>
      <li>
        <p>è¿›è¡Œé¢„æµ‹</p>

\[E[y_* ]=\boldsymbol x_*'\hat{\boldsymbol w}\]
      </li>
    </ul>
  </li>
</ul>

<p><span style="color:red">\(\hat{\boldsymbol w}\) å¯¹åº”äº â€œç‚¹ä¼°è®¡â€</span></p>

<h3 id="12-è´å¶æ–¯æ›¿ä»£">1.2 è´å¶æ–¯æ›¿ä»£</h3>
<p><strong>\(\hat{\boldsymbol w}\) å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„â€¦â€¦å¦‚æœæˆ‘ä»¬ä¸åªæ˜¯ä½¿ç”¨å‚æ•°çš„ä¸€ä¸ªä¼°è®¡å€¼å‘¢ï¼Ÿ</strong></p>
<ul>
  <li><strong><span style="color:steelblue">å¯¹äºåˆ†ç±»é—®é¢˜ï¼š</span></strong>
    <ul>
      <li>
        <p>å»ºæ¨¡</p>

\[p(y|\boldsymbol x)=\text{sigmoid}(\boldsymbol x'\boldsymbol w)\]
      </li>
      <li>
        <p>è€ƒè™‘é‚£äº›å¯ä»¥æ¯”è¾ƒå¥½åœ°æ‹Ÿåˆæ•°æ®çš„ <span style="color:red">å¯èƒ½çš„å‚æ•°ç©ºé—´</span></p>

\[p(\boldsymbol w|\boldsymbol X,\boldsymbol y)\]
      </li>
      <li>
        <p>è¿›è¡Œ <span style="color:red">â€œæœŸæœ›çš„â€</span> é¢„æµ‹</p>

\[p(y_*|\boldsymbol x_*)=E_{p(\boldsymbol w|\boldsymbol X,\boldsymbol y)}\left[\text{sigmoid}(\boldsymbol x_*'\boldsymbol w)\right]\]
      </li>
    </ul>
  </li>
  <li><strong><span style="color:steelblue">å¯¹äºå›å½’é—®é¢˜ï¼š</span></strong>
    <ul>
      <li>
        <p>å»ºæ¨¡</p>

\[p(y|\boldsymbol x)=\text{Normal}(\boldsymbol x'\boldsymbol w;\sigma^2)\]
      </li>
      <li>
        <p>è€ƒè™‘é‚£äº›å¯ä»¥æ¯”è¾ƒå¥½åœ°æ‹Ÿåˆæ•°æ®çš„ <span style="color:red">å¯èƒ½çš„å‚æ•°ç©ºé—´</span></p>

\[p(\boldsymbol w|\boldsymbol X,\boldsymbol y)\]
      </li>
      <li>
        <p>è¿›è¡Œ <span style="color:red">â€œæœŸæœ›çš„â€</span> é¢„æµ‹</p>

\[p(y_*|\boldsymbol x_*)=E_{p(\boldsymbol w|\boldsymbol X,\boldsymbol y)}\left[\text{Normal}(\boldsymbol x_*'\boldsymbol w;\sigma^2)\right]\]
      </li>
    </ul>
  </li>
</ul>

<h2 id="2-ä¸ç¡®å®šæ€§">2. ä¸ç¡®å®šæ€§</h2>
<p><strong>å¦‚æœç”¨äºè®­ç»ƒçš„æ•°æ®é›†å¾ˆå°ï¼Œæˆ‘ä»¬å¾ˆå°‘ä¼šå®Œå…¨ä¿¡ä»»ä»»ä½•ä»ä¸­å­¦ä¹ åˆ°çš„æ¨¡å‹ã€‚æˆ‘ä»¬èƒ½å¦é‡åŒ–è¿™ç§ä¸ç¡®å®šæ€§ï¼Œå¹¶å°†å…¶ç”¨äºé¢„æµ‹å‘¢ï¼Ÿ</strong></p>
<h3 id="21-é‡æ–°å®¡è§†å›å½’é—®é¢˜">2.1 é‡æ–°å®¡è§†å›å½’é—®é¢˜</h3>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200219-145612%402x.png" width="60%" /></p>

<p><span style="color:red">çº¿æ€§å›å½’ï¼š</span> $y=w_0+w_1x$<br />
è¿™é‡Œï¼Œ$y=$ humidityï¼ˆæ¹¿åº¦ï¼‰ï¼Œ$x=$ temperatureï¼ˆæ¸©åº¦ï¼‰</p>

<ul>
  <li>ä»æ•°æ®ä¸­å­¦ä¹ æ¨¡å‹
    <ul>
      <li>
        <p>é€šè¿‡é€‰æ‹©æƒé‡æ¥æœ€å°åŒ–è¯¯å·®æ®‹å·®</p>

\[\hat{\boldsymbol w}=(\boldsymbol X'\boldsymbol X)^{-1}\boldsymbol X'\boldsymbol y\]
      </li>
    </ul>
  </li>
  <li>ä½†æ˜¯æˆ‘ä»¬å¯¹äºå¾—åˆ°çš„ $\hat{\boldsymbol w}$ å’Œé¢„æµ‹å€¼æœ‰å¤šå¤§çš„ä¿¡å¿ƒï¼Ÿ</li>
</ul>

<h3 id="22-æˆ‘ä»¬åº”è¯¥ç›¸ä¿¡ç‚¹ä¼°è®¡-hatboldsymbol-w-å—">2.2 æˆ‘ä»¬åº”è¯¥ç›¸ä¿¡ç‚¹ä¼°è®¡ $\hat{\boldsymbol w}$ å—ï¼Ÿ</h3>
<ul>
  <li>
    <p>æˆ‘ä»¬çš„å­¦ä¹ ç®—æ³•æœ‰å¤šç¨³å®šï¼Ÿ</p>

    <p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200219-152254%402x.png" width="80%" /></p>

    <p><strong><center><span style="font-size:10pt">ä¸¤ä¸ªå…·æœ‰ä¸åŒå™ªå£°æ°´å¹³çš„æ•°æ®é›†ä»¥åŠå®ƒä»¬å„è‡ªå¯¹åº”çš„ä¼¼ç„¶å‡½æ•°</span></center></strong> <center><span style="font-size:10pt">Source: <span style="font-style:italic">A First Course in Machine Learning (p.81)</span> by Rogers &amp; Girolami</span></center><br />
<br /></p>

    <ul>
      <li>$\hat{\boldsymbol w}$ å¯¹äºå™ªå£°é«˜åº¦æ•æ„Ÿ</li>
      <li>å‚æ•°ä¼°è®¡çš„ä¸ç¡®å®šæ€§æœ‰å¤šå°‘ï¼Ÿ</li>
      <li>å¦‚æœç›®æ ‡å‚æ•°çš„ <strong>è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆNegative Log Likelihood, NLLï¼‰</strong> çš„åœ¨å³°å€¼å¤„è¶Šé«˜ä¸”çª„ï¼Œè¯´æ˜æˆ‘ä»¬æŒæ¡çš„ä¿¡æ¯é‡è¶Šå¤§</li>
    </ul>
  </li>
  <li>å½¢å¼åŒ–ä¸º <strong>è´¹é›ªä¿¡æ¯çŸ©é˜µï¼ˆFisher Information Matrixï¼‰</strong>
    <ul>
      <li>$E[ 2^{nd} \text{ deriv of NLL}]$<br />
$\cal I$ $=\dfrac{1}{\sigma^2}\boldsymbol Xâ€™\boldsymbol X$</li>
    </ul>
  </li>
  <li>è¡¡é‡å…³äº $\hat{\boldsymbol w}$ çš„ç›®æ ‡å‡½æ•°çš„æ›²ç‡</li>
</ul>

<h2 id="3-è´å¶æ–¯è§†è§’">3. è´å¶æ–¯è§†è§’</h2>
<p><strong>ä¿ç•™æ‰€æœ‰çš„æœªçŸ¥å› ç´ ï¼ˆä¾‹å¦‚ï¼šå‚æ•°çš„ä¸ç¡®å®šæ€§ï¼‰å¹¶å¯¹å®ƒä»¬è¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸”åœ¨è¿›è¡Œç»Ÿè®¡æ¨æ–­æ—¶åˆ©ç”¨è¿™äº›ä¿¡æ¯ã€‚</strong></p>
<h3 id="31-ä¸€ä¸ªè´å¶æ–¯äººçš„è§†è§’">3.1 ä¸€ä¸ªè´å¶æ–¯äººçš„è§†è§’</h3>
<ul>
  <li>æˆ‘ä»¬æœ‰ç†ç”±è®¤ä¸º <strong>æ‰€æœ‰çš„</strong> å‚æ•°å¯¹äºæ•°æ®è€Œè¨€éƒ½æ˜¯å¸¸æ•°å—ï¼Ÿ
    <ul>
      <li>å¯¹äºè®­ç»ƒæ•°æ®æ‹Ÿåˆæ›´å¥½çš„æƒé‡çš„æ¦‚ç‡åº”è¯¥å¤§äºå…¶ä»–æƒé‡çš„æ¦‚ç‡</li>
      <li>åˆ©ç”¨æ‰€æœ‰å¯èƒ½çš„æƒé‡è¿›è¡Œé¢„æµ‹ï¼Œä¹˜ä»¥å„è‡ªçš„æ¦‚ç‡ä½œä¸ºç¼©æ”¾ç³»æ•°</li>
    </ul>
  </li>
  <li>è¿™å°±æ˜¯ <span style="color:red">è´å¶æ–¯æ¨æ–­</span> èƒŒåçš„æ€æƒ³</li>
</ul>

<h3 id="32-å‚æ•°çš„ä¸ç¡®å®šæ€§">3.2 å‚æ•°çš„ä¸ç¡®å®šæ€§</h3>
<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200219-191611%402x.png" width="40%" align="right" /></p>

<ul>
  <li>ç›®æ ‡å‡½æ•°æœ‰å¾ˆå¤šåˆç†çš„è§£
    <ul>
      <li>ä¸ºä»€ä¹ˆåªé€‰æ‹©å…¶ä¸­çš„æŸä¸€ä¸ªå‘¢ï¼Ÿ</li>
    </ul>
  </li>
  <li>è€ƒè™‘ <span style="color:red">æ‰€æœ‰</span> å¯èƒ½çš„å‚æ•°å€¼èƒŒåçš„åŸå› 
    <ul>
      <li>ä¹˜ä»¥å®ƒä»¬çš„ <span style="color:red">åéªŒæ¦‚ç‡</span> ä½œä¸ºåŠ æƒé¡¹</li>
    </ul>
  </li>
  <li>æ›´å…·é²æ£’æ€§çš„é¢„æµ‹
    <ul>
      <li>å¯ä»¥æ›´å¥½åœ°é¿å…è¿‡æ‹Ÿåˆï¼Œå°¤å…¶æ˜¯å¯¹äºå°çš„è®­ç»ƒé›†è€Œè¨€</li>
      <li>å¯ä»¥å¾—åˆ°è¡¨è¾¾èƒ½åŠ›æ›´å¼ºçš„æ¨¡å‹ç±»åˆ«ï¼ˆä¾‹å¦‚ï¼šè´å¶æ–¯ Logistic å›å½’æ˜¯éçº¿æ€§æ¨¡å‹ï¼‰</li>
    </ul>
  </li>
</ul>

<h3 id="33-é¢‘ç‡å­¦å®¶-vs-è´å¶æ–¯äººçš„-åˆ†æ­§">3.3 é¢‘ç‡å­¦å®¶ vs. è´å¶æ–¯äººçš„ â€œåˆ†æ­§â€</h3>
<ul>
  <li><strong><span style="color:red">é¢‘ç‡å­¦å®¶ï¼š</span></strong> ä½¿ç”¨ <strong>ç‚¹ä¼°è®¡</strong>ã€<strong>æ­£åˆ™åŒ–</strong>ã€<strong>på€¼</strong> â€¦ è¿›è¡Œå­¦ä¹ 
    <ul>
      <li>ç®€å•çš„å‡è®¾èƒŒåæ˜¯å¤æ‚çš„ç†è®ºæ”¯æ’‘</li>
      <li>å¤§éƒ¨åˆ†ç®—æ³•éƒ½æ¯”è¾ƒç®€å•ï¼Œéå¸¸åå®ç”¨çš„æœºå™¨å­¦ä¹ ç ”ç©¶</li>
    </ul>
  </li>
  <li><strong><span style="color:red">è´å¶æ–¯äººï¼š</span></strong> ä¿ç•™ <strong>ä¸ç¡®å®šæ€§</strong>ï¼Œåœ¨è¿›è¡Œç»Ÿè®¡æ¨æ–­æ—¶å¯¹æœªçŸ¥å› ç´ è¿›è¡Œ <strong>è¾¹ç¼˜åŒ–ï¼ˆæ±‚å’Œï¼‰</strong>
    <ul>
      <li>ä¸€äº›ç†è®º</li>
      <li>ç®—æ³•é€šå¸¸æ›´åŠ å¤æ‚ï¼Œä½†å¹¶éæ€»æ˜¯å¦‚æ­¤</li>
      <li>é€šå¸¸ï¼ˆå¹¶éç»å¯¹ï¼‰åœ¨è®¡ç®—ä¸Šå¼€é”€æ›´é«˜</li>
    </ul>
  </li>
</ul>

<h2 id="4-è´å¶æ–¯å›å½’">4. è´å¶æ–¯å›å½’</h2>
<p><strong>å°†è´å¶æ–¯æ¨æ–­åº”ç”¨äºçº¿æ€§å›å½’ï¼Œå¯¹äº $\boldsymbol w$ ä½¿ç”¨æ­£æ€å…ˆéªŒ</strong></p>
<h3 id="41-å†è°ˆçº¿æ€§å›å½’">4.1 å†è°ˆçº¿æ€§å›å½’</h3>
<ul>
  <li>
    <p>å›å¿†çº¿æ€§å›å½’çš„æ¦‚ç‡å…¬å¼</p>

\[y\sim \text{Normal}(\boldsymbol x'\boldsymbol w, \sigma^2)\]

\[\boldsymbol w\sim \text{Normal}(\boldsymbol 0,\gamma^2 \boldsymbol I_D)\]

    <p>å…¶ä¸­ï¼Œ$\boldsymbol I_D$ æ˜¯ $D\times D$ çš„å•ä½çŸ©é˜µ</p>
  </li>
  <li>
    <p>è´å¶æ–¯è§„åˆ™</p>

\[p(\boldsymbol w|\boldsymbol X,\boldsymbol y)=\dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X)}\]

    <p>è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾ $\boldsymbol w$ ä¸ $\boldsymbol X$ ä¹‹é—´äº’ç›¸ç‹¬ç«‹ï¼š<br />
\(p(\boldsymbol w|\boldsymbol X,\boldsymbol y) = \dfrac{p(\boldsymbol w,\boldsymbol X,\boldsymbol y)}{p(\boldsymbol X,\boldsymbol y)}
=\dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol X,\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X)p(\boldsymbol X)}
=\dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol X)p(\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X)p(\boldsymbol X)}
=\dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X)}\)</p>

    <p><br /></p>

\[\max \limits_{\boldsymbol w}p(\boldsymbol w|\boldsymbol X,\boldsymbol y)=\max \limits_{\boldsymbol w}p(\boldsymbol y|\boldsymbol X,\boldsymbol w)p(\boldsymbol w)\]

    <p>è¿™é‡Œï¼Œæˆ‘ä»¬é‡‡ç”¨ç‚¹ä¼°è®¡é¿å…è®¡ç®—è¾¹ç¼˜ä¼¼ç„¶é¡¹ã€‚</p>
  </li>
  <li>
    <p>å¯¼è‡´ç›®æ ‡å‡½æ•°æƒ©ç½šåŒ–ï¼ˆå²­å›å½’ï¼‰</p>
  </li>
</ul>

<h3 id="42-è´å¶æ–¯çº¿æ€§å›å½’">4.2 è´å¶æ–¯çº¿æ€§å›å½’</h3>
<ul>
  <li>
    <p>å›é€€ä¸€æ­¥ï¼Œè€ƒè™‘å®Œå…¨åéªŒ</p>

\[\begin{align}
p(\boldsymbol w|\boldsymbol X,\boldsymbol y,\sigma^2)
&amp;= \dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w,\sigma^2)p(\boldsymbol w)}{p(\boldsymbol y|\boldsymbol X,\sigma^2)} \\
&amp;= \dfrac{p(\boldsymbol y|\boldsymbol X,\boldsymbol w,\sigma^2)p(\boldsymbol w)}{\int \color{red}{\underbrace{\color{black}{p(\boldsymbol y|\boldsymbol X,\boldsymbol w,\sigma^2)p(\boldsymbol w)}}_{p(\boldsymbol y,\boldsymbol w|\boldsymbol X,\sigma^2)}} \text{ d} \boldsymbol w}
\end{align}\]

    <p>è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾å™ªå£°çš„æ–¹å·®å·²çŸ¥ã€‚</p>
  </li>
  <li>æˆ‘ä»¬å¯ä»¥è®¡ç®—åˆ†æ¯ï¼ˆ<span style="color:red">è¾¹ç¼˜ä¼¼ç„¶</span> æˆ–è€… <span style="color:red">è¯æ®</span>ï¼‰å—ï¼Ÿ
    <ul>
      <li>å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®Œå…¨åéªŒï¼Œè€Œéä»…ä»…æ˜¯å®ƒçš„ä¼—æ•°</li>
    </ul>
  </li>
  <li>æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ­£æ€åˆ†å¸ƒ
    <ul>
      <li>æ­£æ€ä¼¼ç„¶ $\times$ æ­£æ€å…ˆéªŒ</li>
    </ul>
  </li>
  <li>å®ƒä»¬çš„ä¹˜ç§¯ä¹Ÿæ˜¯ä¸€ä¸ªæ­£æ€åˆ†å¸ƒ
    <ul>
      <li><strong><span style="color:red">å…±è½­å…ˆéªŒï¼š</span></strong> å½“ä¼¼ç„¶å‡½æ•°å’Œå…ˆéªŒçš„ä¹˜ç§¯ç»“æœçš„åˆ†å¸ƒä¸å…ˆéªŒåˆ†å¸ƒç›¸åŒæ—¶ï¼ˆå³åéªŒåˆ†å¸ƒä¸å…ˆéªŒåˆ†å¸ƒå±äºåŒç±»ï¼‰ï¼Œåˆ™å…ˆéªŒåˆ†å¸ƒä¸åéªŒåˆ†å¸ƒè¢«ç§°ä¸º <strong>å…±è½­åˆ†å¸ƒ</strong>ï¼Œè€Œå…ˆéªŒåˆ†å¸ƒè¢«ç§°ä¸ºä¼¼ç„¶å‡½æ•°çš„ <strong>å…±è½­å…ˆéªŒ</strong>ã€‚<br />
ä¾‹å¦‚ï¼Œé«˜æ–¯åˆ†å¸ƒå®¶æ—åœ¨é«˜æ–¯ä¼¼ç„¶å‡½æ•°ä¸‹ä¸å…¶è‡ªèº«å…±è½­(è‡ªå…±è½­)ã€‚</li>
      <li>åˆ©ç”¨æ­£æ€åˆ†å¸ƒçš„å½’ä¸€åŒ–å¸¸æ•°å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¡ç®—å‡º <strong>è¯æ®ï¼ˆè¾¹ç¼˜ä¼¼ç„¶ï¼‰</strong></li>
    </ul>
  </li>
  <li><span style="color:red">åéªŒçš„é—­åˆè§£ï¼ˆClosed Form Solutionï¼‰</span></li>
</ul>

\[\begin{align}
  p(\boldsymbol w|\boldsymbol X,\boldsymbol y,\sigma^2) &amp;\propto \text{Normal}(\boldsymbol w|\boldsymbol 0,\gamma^2\boldsymbol I_D)\text{Normal}(\boldsymbol y|\boldsymbol {Xw},\sigma^2\boldsymbol I_N) \\
  &amp;\propto \text{Normal}(\boldsymbol w|\boldsymbol w_N,\boldsymbol V_N)
  \end{align}\]

<p>å…¶ä¸­ï¼Œ$\boldsymbol w_N=\dfrac{1}{\sigma^2}\boldsymbol V_N\boldsymbol Xâ€™\boldsymbol y \;,\quad \boldsymbol V_N=\sigma^2(\boldsymbol Xâ€™\boldsymbol X+\dfrac{\sigma^2}{\gamma^2}\boldsymbol I_D)^{-1}$</p>

<p><strong>æ³¨æ„ï¼š</strong> ä¹‹å‰çš„å‡å€¼ï¼ˆå’Œä¼—æ•°ï¼‰éƒ½æ˜¯ MAP çš„è§£ã€‚</p>

<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ä¸ªæ­£æ€åˆ†å¸ƒçš„ä¹˜ç§¯æ¥éªŒè¯ï¼šå°†æŒ‡æ•°éƒ¨åˆ†åˆå¹¶åœ¨ä¸€èµ·ï¼Œå¹¶å¯¹å¸¸ç³»æ•°éƒ¨åˆ† â€œå®Œæˆå¹³æ–¹â€ æ¥è¡¨ç¤ºä¸ºå¸¸ç³»æ•°çš„å¹³æ–¹ä¹˜ä»¥ä¸€ä¸ªæŒ‡æ•°éƒ¨åˆ†ï¼ˆå³æ­£æ€åˆ†å¸ƒï¼‰ã€‚</p>

<p>å›é¡¾ä¹‹å‰ <a href="https://andy-tk.top/2019/11/06/%E7%BB%9F%E8%AE%A1%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A002/">Lecture 02 çš„ 3.2 èŠ‚</a> ä¸­æåˆ°çš„ä¾‹å­ï¼š</p>
<ul>
  <li>æˆ‘ä»¬å¯¹ $X\mid\theta$ å»ºæ¨¡ä¸º $\text{N}(\theta,1)$ï¼Œå…ˆéªŒä¸º $N(0,1)$</li>
  <li>
    <p>å‡è®¾æˆ‘ä»¬è§‚æµ‹åˆ° $X=1$ï¼Œç„¶åæ›´æ–°å…ˆéªŒ<br /></p>

\[\begin{align}
P(\theta|X=1) &amp;= \dfrac{P(X=1| \theta)P(\theta)}{P(X=1)} \quad\quad\color{purple}{\text{ç›®æ ‡æ˜¯å°†åéªŒè½¬æ¢ä¸ºå·²çŸ¥åˆ†å¸ƒå½¢å¼ã€‚æŒ‡æ•°çš„äºŒæ¬¡æ–¹ä¸€å®šä¸ºæ­£æ€}}\\
&amp;\propto P(X=1| \theta)P(\theta) \\
&amp;=\left[\color{purple}{\dfrac{1}{\sqrt{2\pi}}}\exp\left(-\dfrac{(1-\theta)^2}{2}\right)\right]\left[\color{purple}{\dfrac{1}{\sqrt{2\pi}}}\exp\left(-\frac{\theta^2}{2}\right)\right] \quad\quad\color{purple}{\text{ä¸¢å¼ƒå…³äº }\theta\text{ çš„å¸¸æ•°é¡¹}}\\
&amp;\propto \exp\left(-\dfrac{(1-\theta)^2+\theta^2}{2}\right) \quad\quad\color{purple}{\text{åˆå¹¶æŒ‡æ•°é¡¹}}\\
&amp;= \exp\left(-\dfrac{2\theta^2-2\theta+1}{2}\right) \\
&amp;= \exp\left(-\dfrac{\theta^2-\theta+\frac{1}{2}}{2\times \color{purple}{\frac{1}{2}}}\right) \quad\quad\color{purple}{\text{å°†åˆ†å­é¡¹ä¸­ }\theta^2\text{ çš„ç³»æ•°ç§»åˆ°åˆ†æ¯ä¸Š}}\\
&amp;= \exp\left(-\dfrac{\theta^2-\theta+\color{purple}{\frac{1}{4}}}{2\times \frac{1}{2}}\right) \cdot \color{purple}{\exp\left(-\dfrac{\frac{1}{4}}{2\times \frac{1}{2}}\right)}  \quad\quad\color{purple}{\text{å°†åˆ†å­é¡¹å‡‘æˆå¹³æ–¹å½¢å¼ï¼šç§»é™¤å¤šä½™çš„å¸¸æ•°é¡¹}}\\
&amp;\propto \exp\left(-\dfrac{\theta^2-\theta+\frac{1}{4}}{2\times \frac{1}{2}}\right)\\
&amp;= \exp\left(-\dfrac{(\theta-\frac{1}{2})^2}{2\times \frac{1}{2}}\right)  \quad\quad\color{purple}{\text{å› å¼åˆ†è§£}}\\
&amp;\propto N(0.5,0.5) \quad\quad\quad\color{purple}{\text{å‘ç°ä¸ºï¼ˆéæ ‡å‡†ï¼‰æ­£æ€åˆ†å¸ƒ}}
\end{align}\]

    <p>æ³¨æ„ï¼šå…è®¸å°†å¸¸é‡æåˆ°å‰é¢ï¼Œå¹¶é€šè¿‡å½’ä¸€åŒ– â€œå¿½ç•¥â€</p>
  </li>
</ul>

<h3 id="43-è´å¶æ–¯çº¿æ€§å›å½’ä¾‹å­">4.3 è´å¶æ–¯çº¿æ€§å›å½’ä¾‹å­</h3>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200220-003722%402x.png" /></p>

<p><span style="font-size:10pt">ç¬¬ 1 æ­¥ï¼šé€‰æ‹©å…ˆéªŒï¼Œè¿™é‡Œæ˜¯ä¸­å¿ƒåœ¨åŸç‚¹ (0,0) é™„è¿‘çš„çƒå½¢</span> $\qquad \qquad \qquad \;$ <span style="font-size:10pt">ç¬¬ 2 æ­¥ï¼šè§‚æµ‹è®­ç»ƒæ•°æ®</span></p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200220-003757%402x.png" /></p>

<p>$\;\;$ <span style="font-size:10pt">ç¬¬ 3 æ­¥ï¼šæ ¹æ®å…ˆéªŒå’Œä¼¼ç„¶å‡½æ•°ï¼Œå†™å‡ºåéªŒçš„å½¢å¼</span> $\qquad \qquad \qquad \quad\;\;$ <span style="font-size:10pt">ç¬¬ 4 æ­¥ï¼šä»åéªŒä¸­é‡‡æ ·</span></p>

<h3 id="44-é¡ºåºè´å¶æ–¯æ›´æ–°">4.4 é¡ºåºè´å¶æ–¯æ›´æ–°</h3>
<ul>
  <li>
    <p>å¯ä»¥ä¸ºç»™å®šçš„æ•°æ®é›†æ„å»º 
\(p(\boldsymbol w|\boldsymbol X,\boldsymbol y,\sigma^2)\)</p>
  </li>
  <li>
    <p>å¦‚æœæˆ‘ä»¬è§‚å¯Ÿåˆ°è¶Šæ¥è¶Šå¤šçš„æ•°æ®ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
    <ol>
      <li>ä»å…ˆéªŒ $p(\boldsymbol w)$ å¼€å§‹</li>
      <li>è§‚æµ‹æ–°çš„å¸¦æ ‡ç­¾çš„æ•°æ®ç‚¹</li>
      <li>è®¡ç®—åéªŒ 
\(p(\boldsymbol w|\boldsymbol X,\boldsymbol y,\sigma^2)\)</li>
      <li><span style="color:red">å°†å¾—åˆ°çš„åéªŒè§†ä¸ºå½“å‰çš„å…ˆéªŒ</span>ï¼Œç„¶åå†ä»ç¬¬ 2 æ­¥å¼€å§‹é‡å¤è¿™ä¸ªè¿‡ç¨‹</li>
    </ol>
  </li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-19-WX20200220-010534%402x.png" width="80%" /></p>

<p><strong><center><span aligned="enter" style="font-size:10pt">ä¸€ä¸ªç®€å•çº¿æ€§æ¨¡å‹ $\,y(x,\boldsymbol w)=w_0+w_1x\,$ ä½¿ç”¨é¡ºåºè´å¶æ–¯å­¦ä¹ çš„ä¾‹å­</span></center></strong><center><span style="font-size:10pt">Source: <span style="font-style:italic">Pattern Recognition and Machine Learning (p.155)</span> by Bishop</span></center></p>

<ul>
  <li>åˆå§‹æ—¶ï¼Œæˆ‘ä»¬æŒæ¡çš„ä¿¡æ¯é‡å¾ˆå°‘ï¼Œå­˜åœ¨å¾ˆå¤šå¯èƒ½çš„å›å½’ç›´çº¿</li>
  <li>ä¼¼ç„¶å‡½æ•°çº¦æŸäº†å¯èƒ½å­˜åœ¨çš„æƒé‡ï¼Œä½¿å¾—å›å½’ç›´çº¿é è¿‘æ•°æ®ç‚¹</li>
  <li>éšç€æ›´å¤šæ•°æ®çš„å¼•å…¥ï¼ŒåéªŒå˜å¾—æ›´åŠ ç²¾ç¡® / è¾¾åˆ°å³°å€¼</li>
  <li><span style="color:red">æ¥è¿‘è´¨å¿ƒ</span></li>
</ul>

<h3 id="45-è®­ç»ƒé˜¶æ®µ">4.5 è®­ç»ƒé˜¶æ®µ</h3>
<p>$\,$1. å†³å®šæ¨¡å‹çš„æ•°å­¦è¡¨ç¤ºå’Œå…ˆéªŒ<br />
$\,$2. è®¡ç®—å‚æ•°çš„åéªŒ
\(p(\boldsymbol w|\boldsymbol X,\boldsymbol y)\)</p>

<p><strong>$\qquad \;$ <span style="color:red">MAP</span>  <span style="color:green">$\qquad \qquad \qquad \qquad$ approx.Bayes $\qquad \qquad \qquad$ exact Bayes</span></strong></p>

<p>$\,$3. å¯»æ‰¾ $\boldsymbol w$ çš„ä¼—æ•° $\qquad \quad \,$ 3. é‡‡ç”¨å¾ˆå¤š $\boldsymbol w$ $\qquad \qquad \qquad \quad\,$ 3. ä½¿ç”¨æ‰€æœ‰çš„ $\boldsymbol w$<br />
$\,$4. åœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œé¢„æµ‹ $\quad\;$ 4. åœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œ <strong>é›†æˆ</strong> å¹³å‡é¢„æµ‹ $\quad$ 4. åœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œ <strong>æœŸæœ›</strong> é¢„æµ‹</p>

<h3 id="46-åˆ©ç”¨ä¸ç¡®å®šçš„-boldsymbol-w-è¿›è¡Œé¢„æµ‹">4.6 åˆ©ç”¨ä¸ç¡®å®šçš„ $\boldsymbol w$ è¿›è¡Œé¢„æµ‹</h3>
<ul>
  <li>å¯ä»¥åˆ©ç”¨ç®€å•çš„å›å½’æ›²çº¿è¿›è¡Œé¢„æµ‹
    <ul>
      <li>é‡‡æ · $S$ ä¸ªå‚æ•°
\(\boldsymbol w^{(s)}\)ï¼Œå…¶ä¸­
\(s\in\{1,...,S\}\)</li>
      <li>å¯¹äºæ¯ä¸€ä¸ªæ ·æœ¬å‚æ•° \(\boldsymbol w^{(s)}\)ï¼Œåœ¨æµ‹è¯•é›†æ•°æ®ç‚¹
\(\boldsymbol x_*\) 
ä¸Šè®¡ç®—é¢„æµ‹å€¼
\(y_*^{(s)}\)</li>
      <li>è®¡ç®—è¿™äº›é¢„æµ‹å€¼çš„å‡å€¼ï¼ˆå’Œæ–¹å·®ï¼‰</li>
      <li>è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º <strong><span style="color:red">è’™ç‰¹å¡æ´›ç§¯åˆ†</span></strong></li>
    </ul>
  </li>
  <li>å¯¹äºè´å¶æ–¯å›å½’å­˜åœ¨ä¸€ä¸ªæ›´ç®€å•çš„è§£
    <ul>
      <li>
        <p>ç§¯åˆ†å¯ä»¥è¢«è§£æè®¡ç®—</p>

\[p(\hat y_*|\boldsymbol X,\boldsymbol y,\boldsymbol x_*,\sigma^2)=\int p(\boldsymbol w|\boldsymbol X,\boldsymbol y,\sigma^2)p(y_*|\boldsymbol x_*,\boldsymbol w,\sigma^2)\,\text{d}\boldsymbol w\]
      </li>
    </ul>
  </li>
  <li>
    <p>é«˜æ–¯åˆ†å¸ƒçš„è‰¯å¥½æ€§è´¨æ„å‘³ç€ç§¯åˆ†æ˜¯æ˜“äºå¤„ç†çš„</p>

\[\begin{align}
p(\hat y_*|\boldsymbol X,\boldsymbol y,\boldsymbol x_*,\sigma^2) &amp;= \int p(\boldsymbol w|\boldsymbol X,\boldsymbol y,\sigma^2)p(y_*|\boldsymbol x_*,\boldsymbol w,\sigma^2)\,\text{d}\boldsymbol w \\
&amp;= \int \text{Normal}(\boldsymbol w|\boldsymbol w_N,\;\boldsymbol V_N) \text{Normal}(y_*|\boldsymbol x_*'\boldsymbol w,\;\sigma^2)\,\text{d}\boldsymbol w\\
&amp;=\text{Normal}\left(y_*|\boldsymbol x_*'\boldsymbol w_N,\;\sigma_N^2(\boldsymbol x_*)\right)
\end{align}\]

    <p>å…¶ä¸­ï¼Œ</p>

\[\sigma_N^2(\boldsymbol x_*)=\sigma^2+\boldsymbol x_*'\boldsymbol V_N\boldsymbol x_*\]

    <ul>
      <li>åŸºäºè®­ç»ƒæ•°æ® $\boldsymbol x_*$ åŒ¹é…çš„åŠ æ€§æ–¹å·®</li>
      <li><span style="color:red">æ¯”è¾ƒ MLE / MAP ä¼°è®¡ï¼ˆå®ƒä»¬çš„æ–¹å·®å‡ä¸ºä¸€ä¸ªå›ºå®šçš„å¸¸æ•°ï¼‰</span></li>
    </ul>

    <p>ï¼ˆå½“è¿›è¡Œè´å¶æ–¯çº¿æ€§å›å½’æ‹Ÿåˆæ—¶ï¼Œ$\boldsymbol w_N$ å’Œ $\boldsymbol V_N$ åœ¨åéªŒä¸­å®šä¹‰ï¼‰</p>
  </li>
</ul>

<h3 id="47-è´å¶æ–¯é¢„æµ‹ä¾‹å­">4.7 è´å¶æ–¯é¢„æµ‹ä¾‹å­</h3>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-20-WX20200220-194107%402x.png" /></p>

<p>æ•°æ®ï¼š$y=x \sin(x)\qquad$ æ¨¡å‹ï¼šä¸‰é˜¶ç«‹æ–¹</p>

<h3 id="48-è¯´æ˜">4.8 è¯´æ˜</h3>
<ul>
  <li>å‡è®¾
    <ul>
      <li>æ•°æ®å™ªå£°å‚æ•°å·²çŸ¥ï¼Œ$\sigma^2$</li>
      <li>æ•°æ®æ¥æºäºæ¨¡å‹åˆ†å¸ƒ</li>
    </ul>
  </li>
  <li>åœ¨ç°å®è®¾å®šä¸­ï¼Œ$\sigma^2$ æ˜¯æœªçŸ¥çš„
    <ul>
      <li>å…·æœ‰è‡ªå·±çš„å…±è½­å…ˆéªŒ<br />
<span style="color:steelblue">Normal</span> likelihoodï¼ˆæ­£æ€ä¼¼ç„¶ï¼‰$\times$ <span style="color:red">InverseGamma</span> priorï¼ˆé€†ä¼½é©¬å…ˆéªŒï¼‰<br />
ç»“æœä¸º <span style="color:red">InverseGamma</span> posteriorï¼ˆé€†ä¼½é©¬åéªŒï¼‰</li>
      <li>é—­åˆå½¢å¼çš„é¢„æµ‹åˆ†å¸ƒï¼Œå…·æœ‰ student-T likelihoodï¼ˆå­¦ç”Ÿ-T ä¼¼ç„¶ï¼‰</li>
    </ul>
  </li>
</ul>

<h2 id="æ€»ç»“">æ€»ç»“</h2>
<ul>
  <li>ç‚¹ä¼°è®¡ï¼ˆMLEï¼ŒMAPï¼‰æ²¡æœ‰æ•æ‰åˆ°çš„ä¸ç¡®å®šæ€§</li>
  <li>è´å¶æ–¯æ–¹æ³•ä¿ç•™äº†ä¸ç¡®å®šæ€§
    <ul>
      <li>å…³æ³¨é¢„æµ‹è€Œéå‚æ•°</li>
      <li>é€‰æ‹©å‚æ•°ç©ºé—´ä¸Šçš„å…ˆéªŒï¼Œç„¶åå¯¹åéªŒå»ºæ¨¡</li>
    </ul>
  </li>
  <li>æ–°çš„æ¦‚å¿µï¼š
    <ul>
      <li>é¡ºåºè´å¶æ–¯æ›´æ–°</li>
      <li>å…±è½­å…ˆéªŒï¼ˆNormal-Normalï¼‰</li>
    </ul>
  </li>
  <li>åˆ©ç”¨åéªŒåœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œè´å¶æ–¯é¢„æµ‹</li>
</ul>

<p>ä¸‹èŠ‚å†…å®¹ï¼šè´å¶æ–¯åˆ†ç±»</p>
:ET