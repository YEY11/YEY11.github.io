I"4<!-- 数学公式 -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>

<h1 id="lecture-04-文本分类">Lecture 04 文本分类</h1>

<p>本节课我们将学习 <strong>文本分类（text classification）</strong>。</p>

<p><strong>本节课程大纲</strong></p>
<ul>
  <li>分类的基本原理</li>
  <li>文本分类任务</li>
  <li>分类算法</li>
  <li>评估</li>
</ul>

<h2 id="1-分类的基本原理">1. 分类的基本原理</h2>
<ul>
  <li>输入
    <ul>
      <li>一个文档 $d$
        <ul>
          <li>通常表示为一个特征向量</li>
        </ul>
      </li>
      <li>一个固定的类别输出集合 <script type="math/tex">C=\{c_1,c_2,\dots,c_k\}</script>
        <ul>
          <li>分类的（Categorical），不是连续的（continuous，例如：regression）或者序数的（ordinal，例如：ranking）</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>输出
    <ul>
      <li>一个预测的类别 $c\in C$</li>
    </ul>
  </li>
</ul>

<p>在分类任务中，我们的输入通常是一个文档的集合或者单个的文档，其中包含一些文本数据。另外，我们知道我们的任务所对应的一个封闭集合（closed set），例如对于主题分类任务，我们可能一共有 100 个不同的主题用于分类，这些可能的主题组成了一个封闭的集合，并且该集合里的元素通常是分类标签（categorical labels），而不是用于回归（regression）任务的连续数值或者用于排序的序数型数据（ordinal data）。</p>

<p>而我们希望输出一个关于文档 $d$ 的预测类别 $c$，它应该是来自封闭集合 $C$ 中的一个元素。在一些其他类型的分类任务变体中，我们想要预测的可能不是一个类别，而是多个类别，我们称之为 <strong>多标签分类（multi-label classification）</strong>，但是今天我们不会讨论它。本节课中，我们假设在我们要处理的应用中，正确的标签类别只有一个。</p>

<h2 id="2-文本分类任务">2. 文本分类任务</h2>
<p>有很多不同种类的文本分类任务，这节课我们主要通过一些例子介绍以下几种：</p>
<ul>
  <li>
    <p><strong>主题分类（Topic classification）</strong><br />
关于试图理解给定文档的主题是什么，例如：我们可能想知道一篇给定的文章是关于体育的还是国际新闻的。</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>情感分析（Sentiment analysis）</strong><br />
尝试分析作者对于某种产品或者一些其他事情的情感，经常用于评论领域，例如：影评、购物点评、产品测评等。</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>作者身份识别（Authorship attribution）</strong><br />
目标是试图发现某段文本的原作者是谁，例如：司法语言学、抄袭检测等。</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>母语识别（Native-language identification）</strong><br />
类似于作者身份识别，我们也是希望通过一段文本推测出作者相关的一些信息，不同的是，在母语识别中，我们关心的不是作者的确切身份，而是其使用的母语是什么。例如：非英语母语者在进行英文写作时，往往会倾向于采用一种不同于英语母语者的风格，我们可能希望知道其母语是什么。母语识别可以用于教育领域，因为它可以帮助教师发现一些特定学生群体在用非母语写作时可能会犯的一些共同错误。</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>自动事实检测（Automatic fact-checking）</strong><br />
自动事实检测是一个目前需求非常迫切的领域，同时也是一个非常困难的领域。其目的是帮助人们识别社交网络媒体上的一些虚假新闻和信息。</p>
  </li>
</ul>

<p>另外，请注意我们的 <strong>输入不一定是完整的 “文本”</strong>：尽管我们一直说输入是一个文档，但这并不意味着它总是像一篇新闻这种相对比较长的文档，它也可以是像一条推特这种非常短的文本（例如：基于推特的情感极性分析）。当我们谈到 “文档” 或者 “文本” 时，我们并不能假设输入的内容很长，它很有可能只有一句话，甚至可能只是一些 emoji 表情符号。</p>

<h3 id="21-主题分类">2.1 主题分类</h3>
<ul>
  <li>
    <p><strong>应用场景</strong>：图书馆学（library science）和信息检索（information retrieval）<br />
例子：想象你有一个在线图书馆，你试图整理你拥有的这些电子书和数字文档中的知识，如果有一种方法可以帮助你对这些成百上千的文档自动进行分类，那么用户就可以更轻松地在里面浏览和搜索信息。</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>标签类别</strong>：不同的主题类别（例如：体育、财经）<br />
例子：媒体出版物中可能会有很多不同的主题分类，像 “工作”、“国际新闻” 等等。具体分类类别取决于你的数据来自的领域。</p>

    <p><br /></p>
  </li>
  <li><strong>特征</strong>：
    <ul>
      <li><strong>词袋模型（bag of words, BOW）</strong><br />
词袋模型表示是一个很好的选择，通常 unigram 已经足够了。另外，我们可能希望移除一些功能词和停用词，它们并没有包含太多与内容相关的信息。因为在主题分类任务中，我们希望提取到的是一些与内容相关的单词，这些单词可以帮助我们确定文本的主题。</li>
      <li><strong>更长的 N-grams 模型用于词组（phrases）</strong><br />
另外，对于词组（phrases），我们有时也会使用一些更长的 n-grams 模型（例如：bigrams、trigrams），所以我们也可以有 a bag of bigrams 或者 a bag of trigrams。</li>
    </ul>

    <p><br /></p>
  </li>
  <li><strong>语料库的例子</strong>：
    <ul>
      <li>Reuters news corpus（RCV1，路透社新闻语料库，请参阅 NLTK 示例）</li>
      <li>Pubmed abstracts（一个提供生物医学方面的论文搜索和摘要的数据库）</li>
      <li>Tweets with hashtags（带有话题标签的推文）</li>
    </ul>
  </li>
</ul>

<h3 id="22-主题分类的例子">2.2 主题分类的例子</h3>
<p>请问以下来自路透社新闻语录中的文本的主题是 <strong>收购（acquisitions）</strong> 还是 <strong>收益（earnings）</strong>？</p>

<blockquote>
  <p>LIEBERT CORP APPROVES MERGER<br />
Liebert Corp said its shareholders approved the merger of a wholly-owned subsidiary of Emerson Electric Co. Under the terms of the merger, each Liebert shareholder will receive .3322 shares of Emerson stock for each Liebert share.</p>
</blockquote>

<p>这段文本中提到了 “<em>股东（shareholders）</em>”、“<em>合并（merge）</em>”、“<em>子公司（subsidiary）</em>”、“<em>分配股票（share stock）</em>” 这些词，所以我们可以判断这段文本的主题应该是 <strong>收购（acquisitions）</strong>。</p>

<h3 id="23-情感分析">2.3 情感分析</h3>
<ul>
  <li>
    <p><strong>应用场景</strong>：意见挖掘（opinion mining）、商业分析（business analytics）<br />
例如：你所在的公司最近发布了一个新产品，你希望获得一些用户反馈。如今，社交媒体是一个用来挖掘用户意见的好地方，这些从网络渠道挖掘到的用户反馈将有助于产品的改善。</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>标签类别</strong>：正面（Positive）/ 负面（Negative）/ 中性（Neutral）<br />
通常，情感分析的结果可以分为正面和负面两种情况，但是有时我们也会考虑中性的情况。</p>

    <p><br /></p>
  </li>
  <li><strong>特征</strong>：
    <ul>
      <li>
        <p><strong>N-grams</strong><br />
这里我们不用词袋模型，而是采用 n-grams 特征。原因是在之前的主题分类任务中，我们并不关心单词之间的顺序；但是在情感分析任务中，单词之间的顺序非常重要。例如：我们的句子中有一个非常正面的词 “$\textit{happy}$”，假如我们像之前词袋模型中一样丢弃单词之间的顺序信息，那么预测的效果将不会太好。</p>
      </li>
      <li>
        <p><strong>极性词典（Polarity lexicons）</strong><br />
极限词典本质上是一个包含了一堆正面极性和负面极性的单词的字典。通常是由人们手工创建的，它的精度很高，但是覆盖范围很小，很适用于通过 bootstrap 的方式来提升我们算法的表现。</p>
      </li>
    </ul>

    <p><br /></p>
  </li>
  <li><strong>语料库的例子</strong>：
    <ul>
      <li>Polarity movie review dataset (NLTK 中的极性影评数据集)</li>
      <li>SEMEVAL Twitter polarity datasets（基于推特的情感极性分析数据集）</li>
    </ul>
  </li>
</ul>

<h3 id="24-情感分析的例子">2.4 情感分析的例子</h3>
<p>请问以下来自 SEMEVAL Twitter polarity datasets 中的推文的 <strong>极性（+/-）</strong> 是什么?</p>

<blockquote>
  <p>anyone having problems with Windows 10? may be coincidental but since i downloaded, my WiFi keeps dropping out. Itunes had a malfunction</p>
</blockquote>

<p>可以看到，该用户表示自己的 Windows 10 总是出现 WiFi 掉线的问题。显然，对于 Windows 10 来说，这不是什么积极的评价。所以我们可以判断这段文本的情感极性应该是 <strong>负面的（Negative）</strong>。</p>

<h3 id="25-作者身份识别">2.5 作者身份识别</h3>
<ul>
  <li>
    <p><strong>应用场景</strong>：司法语言学（forensic linguistics）、抄袭检测（plagiarism detection）<br />
目标是试图发现某段文本的原作者是谁。例如：司法语言学中的收集网络犯罪证据；或者学术论文中的抄袭检测。</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>标签类别</strong>：作者（例如：莎士比亚）<br />
任务标签可以是一些著名的作者，例如莎士比亚。也可以是诸如推特用户 ID 等类似信息。</p>

    <p><br /></p>
  </li>
  <li><strong>特征</strong>：
    <ul>
      <li><strong>功能词（function words）的使用频率</strong><br />
关于特征选择，作者身份识别任务和其他任务有些区别：内容相关的单词在这里并没有那么重要，它们传达给我们的更多是关于主题的信息，但是当我们的目标是找出某段文本的作者时，我们实际上想要捕捉的是关于该作者写作风格的信息，所以句子中的功能词在这里更加重要一些。</li>
      <li><strong>字符 n-grams</strong><br />
相比那些和内容相关的单词，我们希望给句子中的功能词以更高的权重，尤其是这些功能词在句子中的使用方式，所以像关于功能词的字符 n-grams 在这里会非常有用 。</li>
      <li><strong>话语结构（Discourse structure）</strong><br />
让我们脱离单词层面来看这个任务，话语结构可能会很有用。不同的作者可能会采用不同的叙述方式：有些作者的叙述方式可能很有逻辑性，而有些可能比较跳跃。所以这种更高层次的话语结构对于识别作者身份是非常有帮助的。</li>
    </ul>

    <p><br /></p>
  </li>
  <li><strong>语料库的例子</strong>：
    <ul>
      <li>Project Gutenberg corpus（古腾堡语料库，请参阅 NLTK 示例）</li>
    </ul>
  </li>
</ul>

<h3 id="26-作者身份识别的例子">2.6 作者身份识别的例子</h3>
<p>请问以下这段来自 Project Gutenberg 的文本是由哪位著名的 <strong>小说家</strong> 写的？</p>

<blockquote>
  <p>Mr. Dashwood’s disappointment was, at first, severe; but his temper was cheerful and sanguine; and he might reasonably hope to live many years, and by living economically, lay by a considerable sum from the produce of an estate already large, and capable of almost immediate improvement. But the fortune, which had been so tardy in coming, was his only one twelvemonth. He survived his uncle no longer; and ten thousand pounds, including the late legacies, was all that remained for his widow and daughters.</p>
</blockquote>

<p>如果你阅读过很多小说，你应该能够很快给出答案：Jane Austen（简$\cdot$奥斯汀）</p>

<hr />
<hr />

<h2 id="6-总结">6. 总结</h2>

<h2 id="7-思考">7. 思考</h2>

<p><strong><span style="color:steelblue">思考：</span></strong> Interpolation、Interpolated Kneser-Ney 和 Kneser-Ney 之间有什么区别？我们应当如何判断应该采用哪种方法？</p>

<p>首先，我们应该明确一点：Interpolated（插值）、Smoothing（平滑）和 Backoff（回退）</p>

<h2 id="8-扩展阅读">8. 扩展阅读</h2>
<ul>
  <li><em><a href="https://canvas.lms.unimelb.edu.au/courses/17601/files/2586500/download">Natural Language Processing, Draft 15/10/18</a></em>, by Eisenstein
    <ul>
      <li>Chapter 6 (skip 6.3)</li>
    </ul>
  </li>
</ul>

<p>下节内容：文本分类</p>

:ET