I"»%<h1 id="lecture-15-è´å¶æ–¯åˆ†ç±»">Lecture 15 è´å¶æ–¯åˆ†ç±»</h1>
<h2 id="ä¸»è¦å†…å®¹">ä¸»è¦å†…å®¹</h2>
<ul>
  <li><strong>ç¦»æ•£è®¾å®šä¸‹çš„è´å¶æ–¯æ€æƒ³</strong>
    <ul>
      <li>Beta-Binomial å…±è½­</li>
    </ul>
  </li>
  <li><strong>è´å¶æ–¯åˆ†ç±»</strong>
    <ul>
      <li>éå…±è½­çš„æ¸è¿›å¿…è¦æ€§</li>
    </ul>
  </li>
</ul>

<h2 id="1-ç¦»æ•£è®¾å®šä¸‹çš„è´å¶æ–¯æ€æƒ³">1. ç¦»æ•£è®¾å®šä¸‹çš„è´å¶æ–¯æ€æƒ³</h2>
<h3 id="11-å¦‚ä½•å°†è´å¶æ–¯è§‚ç‚¹åº”ç”¨äºç¦»æ•£æ•°æ®">1.1 å¦‚ä½•å°†è´å¶æ–¯è§‚ç‚¹åº”ç”¨äºç¦»æ•£æ•°æ®ï¼Ÿ</h3>
<ul>
  <li>ä¼˜å…ˆè€ƒè™‘ <strong>ç”Ÿæˆ</strong> è¾“å…¥çš„ <strong>ç”Ÿæˆå¼æ¨¡å‹</strong>
    <ul>
      <li>
        <p>å¯¹æ¯” <strong>åˆ¤åˆ«å¼æ¨¡å‹</strong>ï¼Œå…¶å°†è¾“å…¥ä½œä¸º <strong>æ¡ä»¶</strong></p>

        <table>
          <thead>
            <tr>
              <th>ç”Ÿæˆå¼æ¨¡å‹</th>
              <th>åˆ¤åˆ«å¼æ¨¡å‹</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>å¯¹è¾“å…¥ $\boldsymbol x$ å’Œæ ‡ç­¾ $y$ çš„è”åˆåˆ†å¸ƒ $p(\boldsymbol x,y)$è¿›è¡Œå»ºæ¨¡ï¼Œå¹¶é€šè¿‡è´å¶æ–¯è§„åˆ™æ¥è®¡ç®— $p(y\mid \boldsymbol x)$ï¼Œç„¶åé€‰æ‹©æœ€å¯èƒ½çš„æ ‡ç­¾ $y$ è¿›è¡Œé¢„æµ‹</td>
              <td>ç›´æ¥å¯¹åéªŒæ¡ä»¶æ¦‚ç‡ $p(y\mid \boldsymbol x)$ å»ºæ¨¡ï¼Œæˆ–è€…ä»è¾“å…¥ $\boldsymbol x$ å­¦ä¹ ä¸€ä¸ªç›´æ¥æ˜ å°„åˆ°ç±»åˆ«çš„æ ‡ç­¾ $y$</td>
            </tr>
            <tr>
              <td>ä¾‹å¦‚ï¼šæœ´ç´ è´å¶æ–¯</td>
              <td>ä¾‹å¦‚ï¼šLogistic å›å½’</td>
            </tr>
          </tbody>
        </table>
      </li>
    </ul>
  </li>
  <li>ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬ä»æœ€åŸºç¡€çš„è®¾å®šå¼€å§‹
    <ul>
      <li>æŠ› $n$ æ¬¡ç¡¬å¸ï¼Œå…¶ä¸­æœ‰ $k$ æ¬¡æ­£é¢æœä¸Š</li>
      <li>åªæœ‰ $\boldsymbol x$ï¼ˆç»“æœçš„åºåˆ—ï¼‰ï¼Œæ²¡æœ‰ â€œç±»åˆ«â€ $y$</li>
    </ul>
  </li>
  <li>åœ¨ç¦»æ•£æ•°æ®ä¸Šåº”ç”¨ <span style="color:red">ç”Ÿæˆå¼æ¨¡å‹</span>
    <ul>
      <li>ä¾‹å¦‚ï¼Œ<a href="https://www.jiqizhixin.com/graph/technologies/e49b21d8-935a-4da6-910d-504c79b9785f">ä¸»é¢˜æ¨¡å‹</a>ã€ç”Ÿæˆå¼åˆ†ç±»å™¨ï¼ˆæœ´ç´ è´å¶æ–¯æ¨¡å‹ã€<a href="https://zhuanlan.zhihu.com/p/93732903">å¤šé¡¹å¼æ··åˆæ¨¡å‹</a>ï¼‰</li>
    </ul>
  </li>
</ul>

<h3 id="12-ç¦»æ•£å…±è½­å…ˆéªŒbeta-binomial">1.2 ç¦»æ•£å…±è½­å…ˆéªŒï¼šBeta-Binomial</h3>
<ul>
  <li>ç¦»æ•£ç©ºé—´ä¹Ÿå­˜åœ¨å…±è½­å…ˆéªŒ</li>
  <li>è€ƒè™‘æŠ› $n$ æ¬¡ç¡¬å¸ï¼Œå…¶ä¸­æœ‰ $k$ æ¬¡æ­£é¢æœä¸Š
    <ul>
      <li>ä»¤å•æ¬¡æŠ›æ·æ­£é¢æœä¸Šçš„æ¦‚ç‡ä¸º $p(Head)=q$ï¼ˆ<span style="color:red">ä¼¯åŠªåˆ©åˆ†å¸ƒ</span>ï¼‰</li>
      <li>æ¨æ–­é—®é¢˜ä¸ºï¼šç¡¬å¸æ˜¯å¦æ˜¯å…¬æ­£çš„ï¼ˆå³ $q \approx 0.5$ï¼‰ï¼Ÿ</li>
    </ul>
  </li>
  <li>
    <p>å¤šæ¬¡å°è¯•ï¼Œåˆ©ç”¨ <span style="color:red">äºŒé¡¹å¼åˆ†å¸ƒ</span></p>

\[p(k|n,q)= {n\choose k}q^k(1-q)^{n-k}\]

    <ul>
      <li>
        <p>ä»¥åŠå®ƒçš„å…±è½­å…ˆéªŒ <span style="color:red">Beta åˆ†å¸ƒ</span></p>

\[\begin{align}
p(q) &amp;= \text{Beta}(q;\alpha,\beta) \\
&amp;= \dfrac{\gamma(\alpha+\beta)}{\gamma(\alpha)\gamma(\beta)}q^{\alpha-1}(1-q)^{\beta-1}
\end{align}\]
      </li>
    </ul>
  </li>
</ul>

<h3 id="13-beta-åˆ†å¸ƒ">1.3 Beta åˆ†å¸ƒ</h3>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-21-730e0cf3d7ca7bcbee16a1b6b5096b63f624a83e.png" width="60%" /></p>

<center> <span style="font-size:10pt"> Source: <span style="font-style:italic"><a href="https://en.wikipedia.org/wiki/Beta_distribution/">https://en.wikipedia.org/wiki/Beta_distribution</a></span></span></center>

<h3 id="14-beta-binomial-å…±è½­">1.4 Beta-Binomial å…±è½­</h3>
<ul>
  <li>
    <p>äºŒé¡¹å¼ï¼ˆBinomialï¼‰åˆ†å¸ƒ</p>

\[p(k|n,q)= {n\choose k}q^k(1-q)^{n-k}\]
  </li>
  <li>
    <p>Beta åˆ†å¸ƒ</p>

\[\begin{align}
  p(q) &amp;= \text{Beta}(q;\alpha,\beta) \\
  &amp;= \color{red}{\dfrac{\gamma(\alpha+\beta)}{\gamma(\alpha)\gamma(\beta)}}q^{\alpha-1}(1-q)^{\beta-1}  \qquad \color{red}{\text{å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“äº† Beta åˆ†å¸ƒçš„å½’ä¸€åŒ–ç®—å­}}
  \end{align}\]
  </li>
  <li>
    <p>è¯æ˜äºŒè€…å…±è½­ï¼š</p>

\[\begin{eqnarray}
\color{green}{\text{è´å¶æ–¯åéªŒ} \qquad p(q|k,n)}\; &amp;{\color{purple}\propto}&amp; p(k|n,q)p(q) \\
&amp;{\color{purple}\propto}&amp; q^k(1-q)^{n-k}q^{\alpha-1}(1-q)^{\beta-1} \\
&amp;{\color{black}=}&amp; q^{k+\alpha-1}(1-q)^{n-k+\beta-1} \\
&amp;{\color{purple}\propto}&amp; \color{red}{\text{Beta}}(q;k+\alpha,n-k+\beta) \qquad \color{purple}{\text{æŠ€å·§ï¼šå¿½ç•¥å¸¸æ•°é¡¹å› å­ï¼ˆå½’ä¸€åŒ–ç®—å­ï¼‰}}
\end{eqnarray}\]
  </li>
</ul>

<h3 id="15-å½’ä¸€åŒ–çš„å”¯ä¸€æ€§">1.5 å½’ä¸€åŒ–çš„å”¯ä¸€æ€§</h3>
<ul>
  <li>æˆ‘ä»¬å¤šæ¬¡ç”¨åˆ°äº†ä¸€ç§æŠ€å·§ï¼š
å½“ä¸€ä¸ªéè§„èŒƒåˆ†å¸ƒï¼ˆunnormalized distributionï¼‰å’ŒæŸä¸€å·²çŸ¥åˆ†å¸ƒæˆæ¯”ä¾‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå…¶å°±æ˜¯è¯¥åˆ†å¸ƒã€‚</li>
  <li>å¦‚æœ $f(\theta) \propto g(\theta)$ï¼Œå…¶ä¸­ $g$ ä¸ºæŸä¸€å·²çŸ¥åˆ†å¸ƒï¼Œé‚£ä¹ˆ $\dfrac{f(\theta)}{\int_{\boldsymbol \Theta} f(\theta)\,\text{d}\theta}=g(\theta)$</li>
  <li>
    <p><strong><span style=" color:steelblue">è¯æ˜ï¼š</span></strong> $f(\theta) \propto g(\theta)$ æ„å‘³ç€</p>

\[f(\theta) = C\cdot g(\theta) \tag{1}\]

\[\int_{\boldsymbol \Theta} f(\theta)\,\text{d}\theta = C\cdot \int_{\boldsymbol \Theta} g(\theta)\,\text{d}\theta = C \tag{2}\]

    <p>å°† $(1)$ å’Œ $(2)$ çš„ç­‰å·ä¸¤è¾¹çš„å¯¹åº”é¡¹ç›¸é™¤ï¼Œå³å¯å¾—åˆ°</p>

\[\dfrac{f(\theta)}{\int_{\boldsymbol \Theta} f(\theta)\,\text{d}\theta}=g(\theta)\]
  </li>
</ul>

<h3 id="16-æ‹‰æ™®æ‹‰æ–¯çš„æ—¥å‡ºé—®é¢˜">1.6 æ‹‰æ™®æ‹‰æ–¯çš„æ—¥å‡ºé—®é¢˜</h3>

<blockquote>
  <p>æ¯å¤©æ¸…æ™¨ï¼Œä½ éƒ½è§‚å¯Ÿåˆ°å¤ªé˜³å‡èµ·ã€‚ä»…åŸºäºè¿™ä¸€äº‹å®ï¼Œæ˜å¤©å¤ªé˜³ä¼šå‡èµ·çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ</p>
</blockquote>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-21-sunrise.jpg" width="30%" /></p>

<ul>
  <li>åˆ©ç”¨ Beta-Binomial å…±è½­ï¼Œå…¶ä¸­ $q$ ä¸ºå¤ªé˜³æ—©ä¸Šå‡èµ·çš„æ¦‚ç‡ $\Pr($ <em>â€œå¤ªé˜³æ—©ä¸Šå‡èµ·â€</em> $)$
    <ul>
      <li>åéªŒ
\(p(q|k.n)=\text{Beta}(q;k+\alpha,n-k+\beta)\)</li>
      <li>$n=k=$ è§‚å¯Ÿè€…çš„å¹´é¾„ï¼ˆæŒ‰å¤©æ•°è®¡ç®—ï¼‰</li>
      <li>ä»¤ $\alpha=\beta=1$ï¼ˆç­‰åŒäºå‡åŒ€åˆ†å¸ƒå…ˆéªŒï¼‰</li>
    </ul>
  </li>
  <li>
    <p>åŸºäºä¸Šé¢è¿™äº›å‡è®¾ï¼Œå¯ä»¥å¾—åˆ°åéªŒ</p>

\[p(q|k)=\text{Beta}(q;\color{purple}{k+1},\color{purple}{1}) \qquad \color{purple}{\text{â€œè‡ªç„¶åœ°â€è®¡ç®—å¤ªé˜³å‡èµ· / æ²¡æœ‰å‡èµ·çš„å¤©æ•°}}\]

    <p>æ‰€ä»¥ï¼Œæ˜å¤©æ—©ä¸Šå¤ªé˜³å‡èµ·çš„æ¦‚ç‡çš„æœŸæœ›ä¸º</p>

\[E_{p(q|k)}[q]=\dfrac{k+1}{k+2}\qquad\qquad\]
  </li>
</ul>

<p>è€ƒè™‘è§‚å¯Ÿè€…çš„å¹´é¾„ï¼š</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-21-WX20200222-015836%402x.png" /></p>

<p>éšç€æ•°æ®çš„å¢åŠ ï¼Œ<strong>å…ˆéªŒçš„å½±å“é€æ¸å‡å°ï¼Œä½†æ°¸è¿œä¸ä¼šæ¶ˆå¤±</strong>ã€‚</p>

<h3 id="17-å¸¸è§çš„å…±è½­å…ˆéªŒ">1.7 å¸¸è§çš„å…±è½­å…ˆéªŒ</h3>
<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-21-WX20200222-014957%402x.png" width="80%" /></p>

<h2 id="2-è´å¶æ–¯-logistic-å›å½’">2. è´å¶æ–¯ Logistic å›å½’</h2>
<p><strong>åˆ¤åˆ«å¼åˆ†ç±»å™¨ï¼Œå°†è¾“å…¥ä½œä¸ºæ¡ä»¶å¯¹åéªŒå»ºæ¨¡ã€‚åœ¨è¿™æ ·çš„è®¾å®šä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•è¿›è¡Œè´å¶æ–¯æ¨æ–­ï¼Ÿ</strong></p>
<h3 id="21-å†çœ‹-logistic-å›å½’">2.1 å†çœ‹ Logistic å›å½’</h3>
<ul>
  <li>ä¸å›å½’é—®é¢˜ç›¸æ¯”ï¼ŒåŒæ ·å­˜åœ¨ç±»ä¼¼çš„å‚æ•°ä¸ç¡®å®šæ€§é—®é¢˜
    <ul>
      <li>å°½ç®¡å†…ç½®äº†é¢„æµ‹ä¸ç¡®å®šæ€§å¯¹è¾“å‡ºå»ºæ¨¡</li>
    </ul>
  </li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-22-WX20200222-115957%402x.png" /></p>

<center><span style="font-size:10pt">Source: <span style="font-style:italic">Machine Learning A Probabilistic Perspective, MLAPP (p.257-258)</span> by Murphy</span></center>

<h3 id="22-å…±è½­ä¸å­˜åœ¨çš„æƒ…å†µ">2.2 å…±è½­ä¸å­˜åœ¨çš„æƒ…å†µ</h3>
<ul>
  <li>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…±è½­å…ˆéªŒå—ï¼Ÿä¾‹å¦‚ï¼š
    <ul>
      <li>ç”ŸæˆäºŒåˆ†ç±»æ¨¡å‹ï¼ˆgenerative binary modelsï¼‰çš„ Beta-Binomial å…±è½­</li>
      <li>å¤šåˆ†ç±»æ¨¡å‹çš„ Dirichlet-Multinomial å…±è½­ï¼ˆç±»ä¼¼çš„å…¬å¼ï¼‰</li>
    </ul>
  </li>
  <li>
    <p>æ¨¡å‹æ˜¯ <span style="color:red">åˆ¤åˆ«å¼çš„</span>ï¼ŒLogistic å›å½’çš„å‚æ•°ç”±  sigmoid å‡½æ•°å®šä¹‰ï¼ˆæˆ–è€…ï¼Œå¯¹äºå¤šåˆ†ç±»æ¨¡å‹ï¼Œå‚æ•°ç”± softmax å‡½æ•°å®šä¹‰ï¼›ç±»ä¼¼çš„é—®é¢˜å’Œç±»ä¼¼çš„è§£ï¼‰</p>

\[p(y|q,\boldsymbol x)=q^y(1-q)^{1-y}\]

\[q=\sigma(\boldsymbol x'\boldsymbol w)\]

    <ul>
      <li>éœ€è¦ $\boldsymbol w$ çš„å…ˆéªŒï¼Œè€Œä¸æ˜¯ $q$</li>
      <li><span style="color:red">æ²¡æœ‰å·²çŸ¥çš„å…±è½­å…ˆéªŒ</span>ï¼Œæ‰€ä»¥ä½¿ç”¨é«˜æ–¯å…ˆéªŒ</li>
    </ul>
  </li>
</ul>

<h3 id="23-è¿‘ä¼¼">2.3 è¿‘ä¼¼</h3>
<ul>
  <li>
    <p>å½’ä¸€åŒ–å¸¸æ•°æ²¡æœ‰å·²çŸ¥çš„è§£</p>

\[\begin{align}
p(\boldsymbol w|\boldsymbol X,\boldsymbol y) &amp;\propto p(\boldsymbol w)p(\boldsymbol y|\boldsymbol X,\boldsymbol w) \\
&amp;= \text{Normal}(\boldsymbol 0,\sigma^2 \boldsymbol I)\prod_{i=1}^{n}\sigma(\boldsymbol x_i'\boldsymbol w)^{y_i}\left(1-\sigma(\boldsymbol x_i'\boldsymbol w)\right)^{1-y_i}
\end{align}\]
  </li>
  <li>
    <p>é€šè¿‡è¿‘ä¼¼æ±‚è§£<br />
<strong><span style="color:steelblue">æ‹‰æ™®æ‹‰æ–¯è¿‘ä¼¼ï¼š</span></strong></p>
    <ul>
      <li>å‡å®šä¼—æ•°çš„åéªŒæœä»æ¸è¿›æ­£æ€</li>
      <li>å¯ä»¥è®¡ç®—å½’ä¸€åŒ–å¸¸æ•°ã€æŠ½æ ·ç­‰</li>
    </ul>

    <p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-02-22-WX20200222-130306%402x.png" width="50%" /></p>

    <center><span style="font-size:10pt">Source: <span style="font-style:italic">Machine Learning A Probabilistic Perspective, MLAPP (p.258)</span> by Murphy</span></center>
  </li>
</ul>

<h2 id="æ€»ç»“">æ€»ç»“</h2>
<ul>
  <li>ç¦»æ•£è®¾å®šä¸‹çš„è´å¶æ–¯æ€æƒ³
    <ul>
      <li>Beta-Binomial å…±è½­</li>
    </ul>
  </li>
  <li>è´å¶æ–¯åˆ†ç±»
    <ul>
      <li>éå…±è½­çš„æ¸è¿›å¿…è¦æ€§</li>
    </ul>
  </li>
</ul>

<p>ä¸‹èŠ‚å†…å®¹ï¼šæ¦‚ç‡å›¾æ¨¡å‹</p>
:ET