I"<h1 id="lecture-09-transforms-å›¾åƒå˜æ¢æ–¹æ³•æ“ä½œåŠè‡ªå®šä¹‰æ–¹æ³•">Lecture 09 transforms å›¾åƒå˜æ¢ã€æ–¹æ³•æ“ä½œåŠè‡ªå®šä¹‰æ–¹æ³•</h1>

<p>ä¸ŠèŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº† transforms ä¸­çš„è£å‰ªã€æ—‹è½¬å’Œç¿»è½¬ï¼Œæœ¬èŠ‚è¯¾æˆ‘ä»¬å°†ç»§ç»­å­¦ä¹  transforms ä¸­çš„å…¶ä»–æ•°æ®å¢å¼ºæ–¹æ³•ã€‚</p>

<h2 id="1-transforms-å›¾åƒå˜æ¢">1. transforms å›¾åƒå˜æ¢</h2>

<h4 id="transformspad"><code class="language-plaintext highlighter-rouge">transforms.Pad</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šå¯¹å›¾ç‰‡è¾¹ç¼˜è¿›è¡Œå¡«å……ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">Pad</span><span class="p">(</span>
    <span class="n">padding</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">padding_mode</span><span class="o">=</span><span class="s">'constant'</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">padding</code>ï¼šè®¾ç½®å¡«å……å¤§å°ã€‚
    <ul>
      <li>å½“ä¸º <code class="language-plaintext highlighter-rouge">a</code> æ—¶ï¼Œä¸Šä¸‹å·¦å³å‡å¡«å…… <code class="language-plaintext highlighter-rouge">a</code> ä¸ªåƒç´ ã€‚</li>
      <li>å½“ä¸º <code class="language-plaintext highlighter-rouge">(a, b)</code> æ—¶ï¼Œä¸Šä¸‹å¡«å…… <code class="language-plaintext highlighter-rouge">b</code> ä¸ªåƒç´ ï¼Œå·¦å³å¡«å…… <code class="language-plaintext highlighter-rouge">a</code> ä¸ªåƒç´ ã€‚</li>
      <li>å½“ä¸º <code class="language-plaintext highlighter-rouge">(a, b, c, d)</code> æ—¶ï¼Œå·¦ã€ä¸Šã€å³ã€ä¸‹åˆ†åˆ«å¡«å…… <code class="language-plaintext highlighter-rouge">a</code>ã€<code class="language-plaintext highlighter-rouge">b</code>ã€<code class="language-plaintext highlighter-rouge">c</code>ã€<code class="language-plaintext highlighter-rouge">d</code> ä¸ªåƒç´ ã€‚</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">padding_mode</code>ï¼šå¡«å……æ¨¡å¼ï¼Œæœ‰ 4 ç§æ¨¡å¼ï¼š
    <ul>
      <li><code class="language-plaintext highlighter-rouge">constant</code></li>
      <li><code class="language-plaintext highlighter-rouge">edge</code></li>
      <li><code class="language-plaintext highlighter-rouge">reflect</code></li>
      <li><code class="language-plaintext highlighter-rouge">symmetric</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">fill</code>ï¼šå½“ <code class="language-plaintext highlighter-rouge">padding_mode='constant'</code> æ—¶ï¼Œè®¾ç½®å¡«å……çš„åƒç´ å€¼ï¼Œ<code class="language-plaintext highlighter-rouge">(R, G, B)</code> æˆ– <code class="language-plaintext highlighter-rouge">(Gray)</code>ã€‚</li>
</ul>

<h4 id="transformscolorjitter"><code class="language-plaintext highlighter-rouge">transforms.ColorJitter</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šè°ƒæ•´äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦å’Œè‰²ç›¸ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">ColorJitter</span><span class="p">(</span>
    <span class="n">brightness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">saturation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">brightness</code>ï¼šäº®åº¦è°ƒæ•´å› å­ã€‚
    <ul>
      <li>å½“ä¸º <code class="language-plaintext highlighter-rouge">a</code> æ—¶ï¼Œ ä» <code class="language-plaintext highlighter-rouge">[max(0, 1-a), 1+a]</code> ä¸­éšæœºé€‰æ‹©ã€‚</li>
      <li>å½“ä¸º <code class="language-plaintext highlighter-rouge">(a, b)</code> æ—¶ï¼Œ ä» <code class="language-plaintext highlighter-rouge">[a, b]</code> ä¸­éšæœºé€‰æ‹©ã€‚</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">contrast</code> ï¼šå¯¹æ¯”åº¦å‚æ•°ï¼ŒåŒ <code class="language-plaintext highlighter-rouge">brightness</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">saturation</code>ï¼šé¥±å’Œåº¦å‚æ•°ï¼ŒåŒ <code class="language-plaintext highlighter-rouge">brightness</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">hue</code>ï¼šè‰²ç›¸å‚æ•°ã€‚
    <ul>
      <li>å½“ä¸º <code class="language-plaintext highlighter-rouge">a</code> æ—¶ï¼Œä» <code class="language-plaintext highlighter-rouge">[-a, a]</code> ä¸­é€‰æ‹©å‚æ•°ã€‚æ³¨ï¼š<code class="language-plaintext highlighter-rouge">0 &lt;= a &lt;= 0.5</code>ã€‚</li>
      <li>å½“ä¸º <code class="language-plaintext highlighter-rouge">(a, b)</code> æ—¶ï¼Œä» <code class="language-plaintext highlighter-rouge">[a, b]</code> ä¸­é€‰æ‹©å‚æ•°ã€‚æ³¨ï¼š<code class="language-plaintext highlighter-rouge">-0.5 &lt;= a &lt;= b &lt;= 0.5</code>ã€‚</li>
    </ul>
  </li>
</ul>

<h4 id="transformsgrayscale"><code class="language-plaintext highlighter-rouge">transforms.Grayscale</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šå°†å›¾ç‰‡è½¬æ¢ä¸ºç°åº¦å›¾ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">Grayscale</span><span class="p">(</span><span class="n">num_output_channels</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">num_ouput_channels</code>ï¼šè¾“å‡ºé€šé“æ•°ï¼Œåªèƒ½è®¾ä¸º 1 æˆ– 3ã€‚</li>
</ul>

<h4 id="transformsrandomgrayscale"><code class="language-plaintext highlighter-rouge">transforms.RandomGrayscale</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾æ¦‚ç‡å°†å›¾ç‰‡è½¬æ¢ä¸ºç°åº¦å›¾ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">RandomGrayscale</span><span class="p">(</span>
    <span class="n">num_output_channels</span><span class="p">,</span>
    <span class="n">p</span><span class="o">=</span><span class="mf">0.1</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">num_ouput_channels</code>ï¼šè¾“å‡ºé€šé“æ•°ï¼Œåªèƒ½è®¾ä¸º 1 æˆ– 3ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">p</code>ï¼šæ¦‚ç‡å€¼ï¼Œå›¾åƒè¢«è½¬æ¢ä¸ºç°åº¦å›¾çš„æ¦‚ç‡ã€‚</li>
</ul>

<h4 id="transformsrandomaffine"><code class="language-plaintext highlighter-rouge">transforms.RandomAffine</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šå¯¹å›¾åƒè¿›è¡Œä»¿å°„å˜æ¢ï¼Œä»¿å°„å˜æ¢æ˜¯äºŒç»´çš„çº¿æ€§å˜æ¢ï¼Œç”±äº”ç§åŸºæœ¬åŸå­å˜æ¢æ„æˆï¼š<strong>æ—‹è½¬</strong>ã€<strong>å¹³ç§»</strong>ã€<strong>ç¼©æ”¾</strong>ã€<strong>é”™åˆ‡</strong> å’Œ <strong>ç¿»è½¬</strong>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">RandomAffine</span><span class="p">(</span>
    <span class="n">degrees</span><span class="p">,</span>
    <span class="n">translate</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">shear</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">resample</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">fillcolor</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">degrees</code>ï¼šæ—‹è½¬è§’åº¦è®¾ç½®ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">translate</code>ï¼šå¹³ç§»åŒºé—´è®¾ç½®ï¼Œå¦‚ <code class="language-plaintext highlighter-rouge">(a, b)</code>, <code class="language-plaintext highlighter-rouge">a</code> è®¾ç½®å®½ (width)ï¼Œ<code class="language-plaintext highlighter-rouge">b</code> è®¾ç½®é«˜ (height)ã€‚å›¾åƒåœ¨å®½ç»´åº¦å¹³ç§»çš„åŒºé—´ä¸º <code class="language-plaintext highlighter-rouge">-img_width * a &lt; dx &lt; img_width * a</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">scale</code>ï¼šç¼©æ”¾æ¯”ä¾‹ (ä»¥é¢ç§¯ä¸ºå•ä½)ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">fill_color</code>ï¼šå¡«å……é¢œè‰²è®¾ç½®ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">shear</code>ï¼šé”™åˆ‡è§’åº¦è®¾ç½®ï¼Œæœ‰æ°´å¹³é”™åˆ‡å’Œå‚ç›´é”™åˆ‡ã€‚
    <ul>
      <li>è‹¥ä¸º <code class="language-plaintext highlighter-rouge">a</code>ï¼Œåˆ™ä»…åœ¨ x è½´é”™åˆ‡ï¼Œé”™åˆ‡è§’åº¦åœ¨ <code class="language-plaintext highlighter-rouge">(-a, a)</code> ä¹‹é—´ã€‚</li>
      <li>è‹¥ä¸º <code class="language-plaintext highlighter-rouge">(a, b)</code>ï¼Œåˆ™ <code class="language-plaintext highlighter-rouge">a</code> è®¾ç½® x è½´è§’åº¦ï¼Œ<code class="language-plaintext highlighter-rouge">b</code> è®¾ç½® y è½´è§’åº¦ã€‚</li>
      <li>è‹¥ä¸º <code class="language-plaintext highlighter-rouge">(a, b, c, d)</code>ï¼Œåˆ™ <code class="language-plaintext highlighter-rouge">a</code>ã€<code class="language-plaintext highlighter-rouge">b</code> è®¾ç½® x è½´è§’åº¦ï¼Œ<code class="language-plaintext highlighter-rouge">c</code>ã€<code class="language-plaintext highlighter-rouge">d</code> è®¾ç½® y è½´è§’åº¦ã€‚</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">resample</code>ï¼šé‡é‡‡æ ·æ–¹å¼ï¼Œæœ‰ <code class="language-plaintext highlighter-rouge">NEAREST</code>ã€<code class="language-plaintext highlighter-rouge">BILINEAR</code>ã€<code class="language-plaintext highlighter-rouge">BICUBIC</code> ä¸‰ç§ã€‚</li>
</ul>

<h4 id="transformsrandomerasing"><code class="language-plaintext highlighter-rouge">transforms.RandomErasing</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šå¯¹å›¾åƒè¿›è¡Œéšæœºé®æŒ¡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">RandomErasing</span><span class="p">(</span>
    <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">),</span>
    <span class="n">ratio</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">p</code>ï¼šæ¦‚ç‡å€¼ï¼Œæ‰§è¡Œè¯¥æ“ä½œçš„æ¦‚ç‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">scale</code>ï¼šé®æŒ¡åŒºåŸŸçš„é¢ç§¯ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">ratio</code>ï¼šé®æŒ¡åŒºåŸŸé•¿å®½æ¯”ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">value</code>ï¼šè®¾ç½®é®æŒ¡åŒºåŸŸçš„åƒç´ å€¼ï¼Œ<code class="language-plaintext highlighter-rouge">(R, G, B)</code> æˆ–è€… <code class="language-plaintext highlighter-rouge">(Gray)</code>ã€‚</li>
</ul>

<p><strong>å‚è€ƒæ–‡çŒ®</strong>ï¼š<em><a href="https://arxiv.org/abs/1708.04896">Random Erasing Data Augmentation</a></em></p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-12-080901.png" width="80%" /></p>

<h4 id="transformslambda"><code class="language-plaintext highlighter-rouge">transforms.Lambda</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šç”¨æˆ·è‡ªå®šä¹‰ lambda æ–¹æ³•ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">Lambda</span><span class="p">(</span><span class="n">lambd</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">lambd</code>ï¼šlambda åŒ¿åå‡½æ•°ï¼Œ<code class="language-plaintext highlighter-rouge">lambda [arg1 [,arg2, ... , argn]]: expression</code>ã€‚</li>
</ul>

<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">TenCrop</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">vertical_flip</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
<span class="n">transforms</span><span class="p">.</span><span class="n">Lambda</span><span class="p">(</span><span class="k">lambda</span> <span class="n">crops</span><span class="p">:</span> <span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">([</span><span class="n">transforms</span><span class="p">.</span><span class="n">Totensor</span><span class="p">()(</span><span class="n">crop</span><span class="p">)</span> <span class="k">for</span> <span class="n">crop</span> <span class="ow">in</span> <span class="n">crops</span><span class="p">]))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="2-transforms-é€‰æ‹©æ“ä½œ">2. transforms é€‰æ‹©æ“ä½œ</h2>

<p>æˆ‘ä»¬å·²ç»å­¦ä¹ äº† transforms ä¸­å¯¹å›¾åƒçš„å„ç§å¢å¼ºæ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬å°†ä»‹ç»å¯¹ transforms æ–¹æ³•çš„ä¸‰ç§é€‰æ‹©æ“ä½œï¼Œå®ƒä»¬å¯ä»¥ä½¿ transforms æ•°æ®å¢å¼ºæ–¹æ³•æ›´åŠ çµæ´»ã€ä¸°å¯Œã€å¤šæ ·ã€‚</p>

<h4 id="transformsrandomchoice"><code class="language-plaintext highlighter-rouge">transforms.RandomChoice</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä»ä¸€ç³»åˆ— transforms æ–¹æ³•ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ªã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">RandomChoice</span><span class="p">([</span><span class="n">transforms1</span><span class="p">,</span> <span class="n">transforms2</span><span class="p">,</span> <span class="n">transforms3</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="transformsrandomapply"><code class="language-plaintext highlighter-rouge">transforms.RandomApply</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾æ®æ¦‚ç‡æ‰§è¡Œä¸€ç»„ transforms æ“ä½œã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">RandomApply</span><span class="p">([</span><span class="n">transforms1</span><span class="p">,</span> <span class="n">transforms2</span><span class="p">,</span> <span class="n">transforms3</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="transformsrandomorder"><code class="language-plaintext highlighter-rouge">transforms.RandomOrder</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šå¯¹ä¸€ç»„ transforms æ“ä½œæ‰“ä¹±é¡ºåºã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">transforms</span><span class="p">.</span><span class="n">RandomOrder</span><span class="p">([</span><span class="n">transforms1</span><span class="p">,</span> <span class="n">transforms2</span><span class="p">,</span> <span class="n">transforms3</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="3-è‡ªå®šä¹‰-transforms">3. è‡ªå®šä¹‰ transforms</h2>

<p>å°½ç®¡ PyTorch æä¾›äº†è®¸å¤š transforms æ–¹æ³•ï¼Œç„¶è€Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯èƒ½è¿˜éœ€è¦æ ¹æ®é¡¹ç›®éœ€æ±‚æ¥è‡ªå®šä¹‰ä¸€äº› transforms æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•è‡ªå®šä¹‰ transforms æ–¹æ³•åŠå…¶æ³¨æ„äº‹é¡¹ã€‚</p>

<p>ä¸ºäº†è‡ªå®šä¹‰ transforms æ–¹æ³•ï¼Œé¦–å…ˆéœ€è¦äº†è§£å…¶è¿è¡Œæœºåˆ¶ï¼Œåœ¨ä¹‹å‰ä»‹ç»æ•°æ®è¯»å–æœºåˆ¶ <code class="language-plaintext highlighter-rouge">DataLoader</code> å’Œ <code class="language-plaintext highlighter-rouge">Dataset</code> æ—¶ï¼Œæˆ‘ä»¬æåˆ°è¿‡ transforms æ–¹æ³•æ˜¯åœ¨ <code class="language-plaintext highlighter-rouge">Compose</code> ç±»ä¸­çš„ <code class="language-plaintext highlighter-rouge">__call__</code> å‡½æ•°ä¸­è¢«è°ƒç”¨çš„ã€‚æˆ‘ä»¬å¯¹ä¸€ç»„ transforms æ–¹æ³•è¿›è¡Œ <code class="language-plaintext highlighter-rouge">for</code> å¾ªç¯ï¼Œæ¯æ¬¡æŒ‰é¡ºåºæŒ‘é€‰å‡ºæˆ‘ä»¬çš„ transforms æ–¹æ³• <code class="language-plaintext highlighter-rouge">t</code> å¹¶æ‰§è¡Œå®ƒã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ª transforms æ–¹æ³•ä»…æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‚æ•°ã€‚å¦å¤–æ³¨æ„ï¼Œç”±äºæ˜¯é€šè¿‡ <code class="language-plaintext highlighter-rouge">for</code> å¾ªç¯è°ƒç”¨ï¼Œå½“å‰ transforms æ–¹æ³•çš„è¾“å‡ºå°±æ˜¯ä¸‹ä¸€ä¸ª transforms æ–¹æ³•çš„è¾“å…¥ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Compose</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">transforms</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>è‡ªå®šä¹‰ transforms è¦ç´ </strong>ï¼š</p>

<ol>
  <li>ä»…æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå‚æ•°ã€‚</li>
  <li>æ³¨æ„ä¸Šä¸‹æ¸¸çš„è¾“å‡ºä¸è¾“å…¥ä¹‹é—´çš„æ•°æ®ç±»å‹å¿…é¡»è¦åŒ¹é…ã€‚</li>
</ol>

<p>æˆ‘ä»¬åœ¨è®¾è®¡ transforms æ–¹æ³•çš„æ—¶å€™å¯èƒ½éœ€è¦å¤šä¸ªå‚æ•°ï¼Œæ¯”å¦‚è®¾ç½®æ¦‚ç‡å€¼ã€ä¿¡å™ªæ¯”ç­‰ï¼Œè¿™äº›å¯ä»¥é€šè¿‡ç±»æ–¹æ³•å®ç°ã€‚</p>

<p><strong>é€šè¿‡ç±»å®ç°å¤šå‚æ•°ä¼ å…¥</strong>ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">YourTransforms</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">...):</span>
        <span class="p">...</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="p">...</span>
        <span class="k">return</span> <span class="n">img</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¸Šé¢æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ transforms æ–¹æ³•çš„åŸºæœ¬ç»“æ„ã€‚é¦–å…ˆæ˜¯ä¸€ä¸ªåˆå§‹åŒ– <code class="language-plaintext highlighter-rouge">__init__</code> æ–¹æ³•ï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ä¼ å…¥æƒ³è¦çš„å‚æ•°ï¼Œæ¯”å¦‚æ¦‚ç‡å€¼ã€ä¿¡å™ªæ¯”ç­‰ç­‰ã€‚ç„¶åï¼Œè¿™ä¸ªç±»ä¸­è¿˜å¿…é¡»æœ‰ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">__call__</code> å‡½æ•°ï¼Œå³è¿™ä¸ªç±»çš„å®ä¾‹å¯ä»¥è¢«è°ƒç”¨ï¼Œ<code class="language-plaintext highlighter-rouge">__call__</code> å‡½æ•°åªæ¥å—ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">input</code> å‚æ•°ï¼Œç„¶åæ‰§è¡Œè‡ªå®šä¹‰çš„ä¸€äº›åŠŸèƒ½ï¼Œæœ€åè¿”å›ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">output</code>ï¼Œå¹¶ä¸”è¾“å…¥ä¸è¾“å‡ºçš„æ•°æ®ç±»å‹å¿…é¡»åŒ¹é…ï¼Œæ¯”å¦‚éƒ½æ˜¯ <code class="language-plaintext highlighter-rouge">img</code>ã€<code class="language-plaintext highlighter-rouge">tensor</code>ã€<code class="language-plaintext highlighter-rouge">list</code>ã€<code class="language-plaintext highlighter-rouge">turple</code> æˆ–è€… <code class="language-plaintext highlighter-rouge">dict</code> ç­‰ã€‚</p>

<h4 id="ä¾‹å­æ¤’ç›å™ªå£°">ä¾‹å­ï¼šæ¤’ç›å™ªå£°</h4>

<p><strong>æ¤’ç›å™ªå£° (salt pepper noise)</strong> åˆç§°ä¸º <strong>è„‰å†²å™ªå£°</strong>ï¼Œæ˜¯ä¸€ç§éšæœºå‡ºç°çš„ç™½ç‚¹æˆ–è€…é»‘ç‚¹ï¼Œç™½ç‚¹ç§°ä¸º <strong>ç›å™ªå£°</strong>ï¼Œé»‘ç‚¹ç§°ä¸º <strong>æ¤’å™ªå£°</strong>ã€‚</p>

<p><strong>ä¿¡å™ªæ¯” (Signal-Noise Rate, SNR)</strong> æ˜¯è¡¡é‡å™ªå£°çš„æ¯”ä¾‹ï¼Œåœ¨å›¾åƒä¸­ä¸ºå›¾åƒåƒç´ çš„å æ¯”ã€‚</p>

<p>ä¸‹é¢æ˜¯å¯¹ä¸€å¼ å°çŒ«å›¾åƒå¢åŠ ä¸åŒä¿¡å™ªæ¯”çš„æ¤’ç›å™ªå£°çš„æ•ˆæœå›¾ï¼š</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-12-WX20201212-170903%402x.png" width="90%" /></p>

<p>ä»å·¦åˆ°å³ä¿¡å™ªæ¯”ä¾æ¬¡ä¸º 0.9ã€0.7ã€0.5ã€0.3ã€‚å¯ä»¥çœ‹åˆ°ï¼Œéšç€ä¿¡å™ªæ¯”çš„å‡å°ï¼Œå³ä¿¡å·çš„å‡å°‘ï¼Œå›¾ç‰‡ä¸¢å¤±çš„ä¿¡æ¯è¶Šæ¥è¶Šå¤šã€‚å½“ä¿¡å™ªæ¯”ä¸º 0.9 æ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°è¿™æ˜¯ä¸€å¼ å°çŒ«çš„å›¾åƒï¼›è€Œå½“ä¿¡å™ªæ¯”é™ä½åˆ° 0.3 æ—¶ï¼Œæˆ‘ä»¬å·²ç»å¾ˆéš¾è¾¨åˆ«å›¾åƒçš„çœŸå®å†…å®¹äº†ã€‚</p>

<p>ä¸‹é¢ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå®šä¹‰ transforms æ–¹æ³•å¯¹å›¾åƒæ·»åŠ æ¤’ç›å™ªå£°ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">AddPepperNoise</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snr</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">snr</span> <span class="o">=</span> <span class="n">snr</span>  <span class="c1"># è®¾ç½®ä¿¡å™ªæ¯”
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span>  <span class="c1"># è®¾ç½®æ¦‚ç‡å€¼
</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>

        <span class="p">...</span>  <span class="c1"># æ·»åŠ æ¤’ç›å™ªå£°å…·ä½“å®ç°è¿‡ç¨‹
</span>
        <span class="k">return</span> <span class="n">img</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Python ä»£ç ç¤ºä¾‹</strong>ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">AddPepperNoise</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s">"""å¢åŠ æ¤’ç›å™ªå£°
    Args:
        snr ï¼ˆfloatï¼‰: ä¿¡å™ªæ¯”ï¼ŒSignal Noise Rate
        p (float): æ¦‚ç‡å€¼ï¼Œä¾æ¦‚ç‡æ‰§è¡Œè¯¥æ“ä½œ
    """</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snr</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snr</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">snr</span> <span class="o">=</span> <span class="n">snr</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="s">"""
        Args:
            img (PIL Image): PIL Image
        Returns:
            PIL Image: PIL image.
        """</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">:</span>
            <span class="n">img_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">).</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">img_</span><span class="p">.</span><span class="n">shape</span>
            <span class="n">signal_pct</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">snr</span>
            <span class="n">noise_pct</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">snr</span><span class="p">)</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="n">signal_pct</span><span class="p">,</span> <span class="n">noise_pct</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">noise_pct</span><span class="o">/</span><span class="mf">2.</span><span class="p">])</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">img_</span><span class="p">[</span><span class="n">mask</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>   <span class="c1"># ç›å™ªå£°
</span>            <span class="n">img_</span><span class="p">[</span><span class="n">mask</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c1"># æ¤’å™ªå£°
</span>            <span class="k">return</span> <span class="n">Image</span><span class="p">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img_</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'uint8'</span><span class="p">)).</span><span class="n">convert</span><span class="p">(</span><span class="s">'RGB'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">img</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="4-transforms-æ–¹æ³•æ€»ç»“">4. transforms æ–¹æ³•æ€»ç»“</h2>

<p><strong>è£å‰ª</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">transforms.CenterCrop</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomCrop</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomResizedCrop</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.FiveCrop</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.TenCrop</code></li>
</ul>

<p><strong>ç¿»è½¬å’Œæ—‹è½¬</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomHorizontalFlip</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomVerticalFlip</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomRotation</code></li>
</ul>

<p><strong>å›¾åƒå˜æ¢</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">transforms.Pad</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.ColorJitter</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.Grayscale</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomGrayscale</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomAffine</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.LinearTransformation</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomErasing</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.Lambda</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.Resize</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.Totensor</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.Normalize</code></li>
</ul>

<p><strong>transforms æ“ä½œ</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomChoice</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomApply</code></li>
  <li><code class="language-plaintext highlighter-rouge">transforms.RandomOrder</code></li>
</ul>

<h2 id="5-æ•°æ®å¢å¼ºå®æˆ˜åº”ç”¨">5. æ•°æ®å¢å¼ºå®æˆ˜åº”ç”¨</h2>

<p><strong>åŸåˆ™</strong>ï¼šè®©è®­ç»ƒé›†ä¸æµ‹è¯•é›†æ›´æ¥è¿‘ã€‚</p>

<ul>
  <li>ç©ºé—´ä½ç½®ï¼šå¹³ç§»</li>
  <li>è‰²å½©ï¼šç°åº¦å›¾ï¼Œè‰²å½©æŠ–åŠ¨</li>
  <li>å½¢çŠ¶ï¼šä»¿å°„å˜æ¢</li>
  <li>ä¸Šä¸‹æ–‡åœºæ™¯ï¼šé®æŒ¡ï¼Œ å¡«å……</li>
  <li>â€¦â€¦</li>
</ul>

<p><strong>ä¾‹å­</strong>ï¼š</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-12-WX20201212-175853%402x.png" width="60%" /></p>

<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨è®­ç»ƒé›†ä¸­ï¼ŒçŒ«åŸºæœ¬éƒ½å¤„äºå›¾ç‰‡çš„ä¸­å¤®ä½ç½®ï¼Œè€Œåœ¨æµ‹è¯•é›†ä¸­çš„çŒ«å¤„äºåå·¦/å³ï¼Œæˆ–è€…åœ¨è§’è½çš„æƒ…å†µã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®å¢å¼ºæ—¶æ”¹å˜è®­ç»ƒé›†ä¸­çš„ç©ºé—´ä½ç½®ï¼Œä¾‹å¦‚å¹³ç§»ï¼Œæ¥é€¼è¿‘æµ‹è¯•é›†çš„å›¾ç‰‡ã€‚</p>

<p><strong>ä¾‹å­</strong>ï¼š</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-12-WX20201212-180459%402x.png" width="60%" /></p>

<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨è®­ç»ƒé›†ä¸­ï¼ŒçŒ«åŸºæœ¬éƒ½æ˜¯ç™½è‰²çš„ï¼Œè€Œåœ¨æµ‹è¯•é›†ä¸­çš„çŒ«æ˜¯é»‘è‰²çš„ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®å¢å¼ºæ—¶å¯¹è®­ç»ƒé›†ä¸­çš„å›¾ç‰‡è¿›è¡Œè‰²å½©æŠ–åŠ¨æˆ–è€…å˜æ¢å¤„ç†ï¼Œæ¥é€¼è¿‘æµ‹è¯•é›†çš„å›¾ç‰‡ã€‚æœ‰æ—¶ï¼Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çŒ«çš„å§¿æ€å·®å¼‚å¾ˆå¤§ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹è®­ç»ƒé›†å›¾ç‰‡è¿›è¡Œä»¿å°„å˜æ¢å¤„ç†æ¥æ”¹å˜çŒ«çš„å½¢çŠ¶ã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥å¯¹æ¯”çœ‹ä¸‹æµ‹è¯•é›†ä¸­æœ‰æ— é®æŒ¡æƒ…å†µï¼Œå¯ä»¥å¯¹è®­ç»ƒé›†è¿›è¡Œé®æŒ¡ã€å¡«å……ç­‰ç›¸åº”å¤„ç†ã€‚</p>

<h4 id="äººæ°‘å¸åˆ†ç±»">äººæ°‘å¸åˆ†ç±»</h4>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-12-WX20201212-181527%402x.png" width="90%" /></p>

<p>åœ¨ä¹‹å‰çš„äººæ°‘å¸åˆ†ç±»ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†æ˜¯é¢é¢ä¸º 1 å…ƒä¸ 100 å…ƒçš„ç¬¬å››å¥—äººæ°‘å¸å„ 100 å¼ ï¼Œé‚£ä¹ˆåŸºäºè¯¥æ•°æ®é›†è®­ç»ƒå‡ºçš„æ¨¡å‹æ˜¯å¦å¯ä»¥å¯¹ç¬¬äº”å¥—äººæ°‘å¸çš„ 100 å…ƒè¿›è¡Œæ­£ç¡®åˆ†ç±»å‘¢ï¼Ÿ</p>

<p>ç›´è§‚ä¸Šï¼Œç¬¬äº”å¥—äººæ°‘å¸çš„ 100 å…ƒä¸ç¬¬å››å¥—äººæ°‘å¸çš„ 1 å…ƒåœ¨é¢œè‰²ä¸Šæ¯”è¾ƒç›¸è¿‘ï¼Œè€Œåœ¨é¢é¢ä¸Šä¸ç¬¬å››å¥—äººæ°‘å¸çš„ 1 00 å…ƒä¸€æ ·ã€‚å®éªŒè¯æ˜ï¼Œå¦‚æœä¸è¿›è¡Œé¢å¤–çš„æ•°æ®å¢å¼ºï¼Œæ¨¡å‹ä¼šå°†ç¬¬äº”å¥—äººæ°‘å¸çš„ 100 å…ƒè¯†åˆ«ä¸º 1 å…ƒï¼Œè¿™å¾ˆå¯èƒ½æ˜¯ç”±äºäºŒè€…åœ¨é¢œè‰²ä¸Šçš„ç›¸ä¼¼æ€§å¯¼è‡´çš„ã€‚å½“æˆ‘ä»¬å¯¹å›¾åƒè¿›è¡Œç°åº¦å¤„ç†åï¼Œæ¨¡å‹å°†å¯ä»¥å¯¹ç¬¬äº”å¥—äººæ°‘å¸çš„ 100 å…ƒè¿›è¡Œæ­£ç¡®åˆ†ç±»ã€‚</p>

<h2 id="6-æ€»ç»“">6. æ€»ç»“</h2>

<p>åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†æ•°æ®é¢„å¤„ç† transforms çš„å›¾åƒå˜æ¢ã€æ“ä½œæ–¹æ³•ï¼Œä»¥åŠè‡ªå®šä¹‰ transformsã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒPyTorch ä¸­çš„æ•°æ®æ¨¡å—æˆ‘ä»¬å·²ç»å­¦ä¹ å®Œæ¯•ï¼Œåœ¨ä¸‹èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹  PyTorch ä¸­çš„æ¨¡å‹æ¨¡å—ã€‚</p>

<p>ä¸‹èŠ‚å†…å®¹ï¼šæ¨¡å‹åˆ›å»ºæ­¥éª¤ä¸ nn.Module</p>
:ET