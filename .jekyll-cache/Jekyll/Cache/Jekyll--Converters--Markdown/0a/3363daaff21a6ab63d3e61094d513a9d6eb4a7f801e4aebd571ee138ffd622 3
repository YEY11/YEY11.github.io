I"ô¤<h1 id="lecture-02-å¼ é‡ç®€ä»‹åŠåˆ›å»º">Lecture 02 å¼ é‡ç®€ä»‹åŠåˆ›å»º</h1>

<h2 id="1-å¼ é‡æ˜¯ä»€ä¹ˆ">1. å¼ é‡æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<h3 id="11-å¼ é‡æ˜¯ä»€ä¹ˆ">1.1 å¼ é‡æ˜¯ä»€ä¹ˆï¼Ÿ</h3>

<p><strong>å¼ é‡ (Tensor)</strong> æ˜¯ä¸€ä¸ªå¤šç»´æ•°ç»„ ï¼Œ å®ƒæ˜¯æ ‡é‡ã€å‘é‡ã€çŸ©é˜µçš„é«˜ç»´æ‹“å±•ã€‚</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-09-WX20201209-184407%402x.png" width="90%" /></p>

<p>å¸¸è§çš„ç°åº¦å›¾åƒå¯ä»¥ç”¨ä¸€ä¸ªçŸ©é˜µ (2 ç»´å¼ é‡) è¡¨ç¤ºï¼›è€Œ RGB å½©è‰²å›¾åƒåˆ™éœ€è¦ç”¨ä¸€ä¸ª 3 ç»´å¼ é‡è¡¨ç¤º (3 ä¸ªç»´åº¦åˆ†åˆ«è¡¨ç¤ºå›¾åƒçš„é«˜åº¦ã€å®½åº¦å’Œ RGB è‰²å½©é€šé“)ã€‚</p>

<h3 id="12-tensor-ä¸-variable">1.2 Tensor ä¸ Variable</h3>

<p>Variable æ˜¯ <code class="language-plaintext highlighter-rouge">torch.autograd</code> ä¸­çš„æ•°æ®ç±»å‹ï¼Œä¸»è¦ç”¨äºå°è£… Tensorï¼Œè¿›è¡Œ <strong>è‡ªåŠ¨æ±‚å¯¼</strong>ã€‚</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">data</code>ï¼šè¢«åŒ…è£…çš„ Tensorã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">grad</code>ï¼š<code class="language-plaintext highlighter-rouge">data</code> çš„æ¢¯åº¦ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">grad_fn</code>ï¼šåˆ›å»º Tensor çš„ Functionï¼Œæ˜¯è‡ªåŠ¨æ±‚å¯¼çš„å…³é”®ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">requires_grad</code>ï¼šæŒ‡ç¤ºæ˜¯å¦éœ€è¦æ¢¯åº¦ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">is_leaf</code>ï¼šæŒ‡ç¤ºæ˜¯å¦æ˜¯ (è®¡ç®—å›¾ä¸­çš„) å¶å­ç»“ç‚¹ï¼ˆå¼ é‡ï¼‰ã€‚</li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-09-WX20201209-184916%402x.png" width="38%" /></p>

<p>PyTorch 0.4.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒVariable å¹¶å…¥ Tensorã€‚</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">dtype</code>ï¼šå¼ é‡çš„æ•°æ®ç±»å‹ï¼Œå¦‚ <code class="language-plaintext highlighter-rouge">torch.FloatTensor</code>ã€<code class="language-plaintext highlighter-rouge">torch.cuda.FloatTensor</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">shape</code>ï¼šå¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚ <code class="language-plaintext highlighter-rouge">(64, 3, 224, 224)</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">device</code>ï¼šå¼ é‡æ‰€åœ¨è®¾å¤‡ï¼ŒGPU/CPUï¼Œæ˜¯åŠ é€Ÿçš„å…³é”®ã€‚</li>
</ul>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-09-WX20201209-190443%402x.png" width="52%" /></p>

<p>å¯ä»¥çœ‹åˆ°ï¼Œç›®å‰çš„ Tensor åŒ…å«äº† 8 ä¸ªä¸»è¦å±æ€§ï¼Œå…¶ä¸­ 4 ä¸ªä¸æ•°æ®ç›¸å…³ï¼Œå¦å¤– 4 ä¸ªä¸æ¢¯åº¦æ±‚å¯¼ç›¸å…³ã€‚</p>

<p>PyTorch ä¸»è¦æä¾›äº†ä»¥ä¸‹ 9 ç§æ•°æ®ç±»å‹ï¼š</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-09-WX20201209-191038%402x.png" width="90%" /></p>

<p>é€šå¸¸ï¼Œä½¿ç”¨æœ€å¤šçš„æ•°æ®ç±»å‹æ˜¯ <code class="language-plaintext highlighter-rouge">torch.float32</code>ï¼Œå¸¸ç”¨äºå·ç§¯å±‚çš„æƒé‡å€¼ï¼Œæˆ–è€…å›¾åƒé¢„å¤„ç†ä¹‹åéƒ½æ˜¯é»˜è®¤ä¸º 32 ä½çš„æµ®ç‚¹æ•°ã€‚å¦å¤–ï¼Œ<code class="language-plaintext highlighter-rouge">torch.int64</code> ä¹Ÿç”¨çš„æ¯”è¾ƒå¤šï¼Œé€šå¸¸ç”¨ 64 ä½æ•´å‹æ¥è¡¨ç¤ºå›¾åƒæ ‡ç­¾ï¼Œåœ¨è®¡ç®—äº¤å‰ç†µçš„æŸå¤±å‡½æ•°æ—¶éœ€è¦æ³¨æ„è¿™ç‚¹ã€‚</p>

<h2 id="2-å¼ é‡çš„åˆ›å»º">2. å¼ é‡çš„åˆ›å»º</h2>

<h3 id="21-ç›´æ¥åˆ›å»º">2.1 ç›´æ¥åˆ›å»º</h3>

<h4 id="torchtensor"><code class="language-plaintext highlighter-rouge">torch.tensor()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä» <code class="language-plaintext highlighter-rouge">data</code> åˆ›å»º <code class="language-plaintext highlighter-rouge">tensor</code>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">pin_memory</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">data</code>ï¼šæ•°æ®ï¼Œå¯ä»¥æ˜¯ <code class="language-plaintext highlighter-rouge">list</code> æˆ–è€… <code class="language-plaintext highlighter-rouge">numpy</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">dtype</code>ï¼šæ•°æ®ç±»å‹ï¼Œé»˜è®¤ä¸ <code class="language-plaintext highlighter-rouge">data</code> çš„ä¸€è‡´ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">device</code>ï¼šæ‰€åœ¨è®¾å¤‡ï¼Œ<code class="language-plaintext highlighter-rouge">cuda</code> æˆ–è€… <code class="language-plaintext highlighter-rouge">cpu</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">requires_grad</code>ï¼šæ˜¯å¦éœ€è¦æ¢¯åº¦ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">pin_memory</code>ï¼šæ˜¯å¦å­˜äºé”é¡µå†…å­˜ï¼Œä¸è½¬æ¢æ•ˆç‡æœ‰å…³ï¼Œé€šå¸¸è®¾ä¸º <code class="language-plaintext highlighter-rouge">False</code>ã€‚</li>
</ul>

<h4 id="torchfrom_numpyndarray"><code class="language-plaintext highlighter-rouge">torch.from_numpy(ndarray)</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä» <code class="language-plaintext highlighter-rouge">numpy</code> åˆ›å»º <code class="language-plaintext highlighter-rouge">tensor</code>ã€‚</p>

<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šä» <code class="language-plaintext highlighter-rouge">torch.from_numpy</code> åˆ›å»ºçš„ <code class="language-plaintext highlighter-rouge">tensor</code> ä¸åŸ <code class="language-plaintext highlighter-rouge">ndarray</code> <strong>å…±äº«å†…å­˜</strong>ï¼Œå½“ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªçš„æ•°æ®ï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿå°†ä¼šè¢«æ”¹åŠ¨ã€‚</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-12-09-WX20201209-201008%402x.png" width="50%" /></p>

<h3 id="22-ä¾æ®æ•°å€¼åˆ›å»º">2.2 ä¾æ®æ•°å€¼åˆ›å»º</h3>

<h4 id="torchzeros"><code class="language-plaintext highlighter-rouge">torch.zeros()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾ <code class="language-plaintext highlighter-rouge">size</code> åˆ›å»ºå…¨ 0 å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="o">*</span><span class="n">size</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">size</code>ï¼šå¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚ <code class="language-plaintext highlighter-rouge">(3, 3)</code>ã€<code class="language-plaintext highlighter-rouge">(3, 224, 224)</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">out</code>ï¼šè¾“å‡ºçš„å¼ é‡ï¼Œå³å°†ç”Ÿæˆçš„å…¨ 0 å¼ é‡èµ‹å€¼ç»™ <code class="language-plaintext highlighter-rouge">out</code> å‚æ•°çš„å˜é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ï¼Œæœ‰ <code class="language-plaintext highlighter-rouge">strided</code>ã€<code class="language-plaintext highlighter-rouge">sparse_coo</code> ç­‰ã€‚é€šå¸¸é‡‡ç”¨é»˜è®¤çš„ <code class="language-plaintext highlighter-rouge">strided</code>ï¼›å¦‚æœæ¶‰åŠç¨€ç–å¼ é‡å¯èƒ½éœ€è¦è®¾ç½®ä¸º <code class="language-plaintext highlighter-rouge">sparse_coo</code> ä»¥æå‡è¯»å–æ•ˆç‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">device</code>ï¼šæ‰€åœ¨è®¾å¤‡ï¼Œgpu / cpuã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">requires_grad</code>ï¼šæ˜¯å¦éœ€è¦æ¢¯åº¦ã€‚</li>
</ul>

<h4 id="torchzeros_like"><code class="language-plaintext highlighter-rouge">torch.zeros_like()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾ <code class="language-plaintext highlighter-rouge">input</code> å½¢çŠ¶åˆ›å»ºå…¨ 0 å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">zeros_like</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">intput</code>ï¼šåˆ›å»ºä¸ <code class="language-plaintext highlighter-rouge">input</code> åŒå½¢çŠ¶çš„å…¨ 0 å¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">dtype</code>ï¼šæ•°æ®ç±»å‹ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
</ul>

<h4 id="torchones"><code class="language-plaintext highlighter-rouge">torch.ones()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾ <code class="language-plaintext highlighter-rouge">size</code> åˆ›å»ºå…¨ 1 å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span>
    <span class="o">*</span><span class="n">size</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">size</code>ï¼šå¼ é‡çš„å½¢çŠ¶ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">out</code>ï¼šè¾“å‡ºçš„å¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">device</code>ï¼šæ‰€åœ¨è®¾å¤‡ï¼Œgpu / cpuã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">requires_grad</code>ï¼šæ˜¯å¦éœ€è¦æ¢¯åº¦ã€‚</li>
</ul>

<h4 id="torchones_like"><code class="language-plaintext highlighter-rouge">torch.ones_like()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾ <code class="language-plaintext highlighter-rouge">input</code> å½¢çŠ¶åˆ›å»ºå…¨ 1 å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">intput</code>ï¼šåˆ›å»ºä¸ <code class="language-plaintext highlighter-rouge">input</code> åŒå½¢çŠ¶çš„å…¨ 1 å¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">dtype</code>ï¼šæ•°æ®ç±»å‹ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
</ul>

<h4 id="torchfull"><code class="language-plaintext highlighter-rouge">torch.full()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾ <code class="language-plaintext highlighter-rouge">size</code> åˆ›å»ºå…¨éƒ¨å€¼å‡ä¸º <code class="language-plaintext highlighter-rouge">fill_value</code> çš„å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">full</span><span class="p">(</span>
    <span class="n">size</span><span class="p">,</span>
    <span class="n">fill_value</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">size</code>ï¼šå¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚ <code class="language-plaintext highlighter-rouge">(3, 3)</code>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">fill_value</code>ï¼šå¼ é‡çš„å€¼ã€‚</li>
</ul>

<h4 id="torchfull_like"><code class="language-plaintext highlighter-rouge">torch.full_like()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾ <code class="language-plaintext highlighter-rouge">input</code> å½¢çŠ¶åˆ›å»ºæŒ‡å®šæ•°æ®çš„å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">full_like</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">,</span>
    <span class="n">fill_value</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">intput</code>ï¼šåˆ›å»ºä¸ <code class="language-plaintext highlighter-rouge">input</code> åŒå½¢çŠ¶çš„å…¨éƒ¨å€¼å‡ä¸º <code class="language-plaintext highlighter-rouge">fill_value</code> çš„å¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">fill_value</code>ï¼šå¼ é‡çš„å€¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">dtype</code>ï¼šæ•°æ®ç±»å‹ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
</ul>

<h4 id="torcharange"><code class="language-plaintext highlighter-rouge">torch.arange()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šåˆ›å»ºç­‰å·®çš„ 1 ç»´å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span>
    <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">end</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">start</code>ï¼šæ•°åˆ—èµ·å§‹å€¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">end</code>ï¼šæ•°åˆ— â€œç»“æŸå€¼â€ï¼ˆæ— æ³•å–åˆ°ï¼‰ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">step</code>ï¼šæ•°åˆ—å…¬å·®ï¼Œé»˜è®¤ä¸º 1ã€‚</li>
</ul>

<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šæ•°å€¼åŒºé—´ä¸º <code class="language-plaintext highlighter-rouge">[start, end)</code>ã€‚</p>

<h4 id="torchlinspace"><code class="language-plaintext highlighter-rouge">torch.linspace()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šåˆ›å»ºå‡åˆ†çš„ 1 ç»´å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span>
    <span class="n">start</span><span class="p">,</span>
    <span class="n">end</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">start</code>ï¼šæ•°åˆ—èµ·å§‹å€¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">end</code>ï¼šæ•°åˆ—ç»“æŸå€¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">steps</code>ï¼šæ•°åˆ—é•¿åº¦ã€‚</li>
</ul>

<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šæ•°å€¼åŒºé—´ä¸º <code class="language-plaintext highlighter-rouge">[start, end]</code>ã€‚</p>

<h4 id="torchlogspace"><code class="language-plaintext highlighter-rouge">torch.logspace()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šåˆ›å»ºå¯¹æ•°å‡åˆ†çš„ 1 ç»´å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">logspace</span><span class="p">(</span>
    <span class="n">start</span><span class="p">,</span>
    <span class="n">end</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">start</code>ï¼šæ•°åˆ—èµ·å§‹å€¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">end</code>ï¼šæ•°åˆ—ç»“æŸå€¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">steps</code>ï¼šæ•°åˆ—é•¿åº¦ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">base</code>ï¼šå¯¹æ•°å‡½æ•°çš„åº•ï¼Œé»˜è®¤ä¸º 10ã€‚</li>
</ul>

<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šé•¿åº¦ä¸º <code class="language-plaintext highlighter-rouge">steps</code>ï¼Œåº•ä¸º <code class="language-plaintext highlighter-rouge">base</code>ã€‚</p>

<h4 id="torcheye"><code class="language-plaintext highlighter-rouge">torch.eye()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šåˆ›å»ºå•ä½å¯¹è§’çŸ©é˜µï¼ˆ2 ç»´å¼ é‡ï¼‰ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">eye</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span>
    <span class="n">m</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">n</code>ï¼šçŸ©é˜µè¡Œæ•°ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">m</code>ï¼šçŸ©é˜µåˆ—æ•°ã€‚</li>
</ul>

<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šé»˜è®¤ä¸ºæ–¹é˜µã€‚</p>

<h3 id="23-ä¾æ¦‚ç‡åˆ†å¸ƒåˆ›å»ºå¼ é‡">2.3 ä¾æ¦‚ç‡åˆ†å¸ƒåˆ›å»ºå¼ é‡</h3>

<h4 id="torchnormal"><code class="language-plaintext highlighter-rouge">torch.normal()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šç”Ÿæˆæ­£æ€åˆ†å¸ƒï¼ˆé«˜æ–¯åˆ†å¸ƒï¼‰ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c1"># mean å’Œ std ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯å¼ é‡ï¼Œä»ä¸åŒçš„æ­£æ€åˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°ï¼Œæ— éœ€æŒ‡å®š sizeã€‚
</span><span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span>
    <span class="n">mean</span><span class="p">,</span>
    <span class="n">std</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span>
<span class="p">)</span>

<span class="c1"># mean å’Œ std å‡ä¸ºæ ‡é‡ï¼Œä»ç›¸åŒçš„æ­£æ€åˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°ï¼Œéœ€è¦æŒ‡å®š sizeã€‚
</span><span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span>
    <span class="n">mean</span><span class="p">,</span>
    <span class="n">std</span><span class="p">,</span>
    <span class="n">size</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">mean</code>ï¼šå‡å€¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">std</code>ï¼šæ ‡å‡†å·®ã€‚</li>
</ul>

<p><strong>å››ç§æ¨¡å¼</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">mean</code> ä¸º <strong>æ ‡é‡</strong>ï¼Œ<code class="language-plaintext highlighter-rouge">std</code> ä¸º <strong>æ ‡é‡</strong>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">mean</code> ä¸º <strong>æ ‡é‡</strong>ï¼Œ<code class="language-plaintext highlighter-rouge">std</code> ä¸º <strong>å¼ é‡</strong>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">mean</code> ä¸º <strong>å¼ é‡</strong>ï¼Œ<code class="language-plaintext highlighter-rouge">std</code> ä¸º <strong>æ ‡é‡</strong>ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">mean</code> ä¸º <strong>å¼ é‡</strong>ï¼Œ<code class="language-plaintext highlighter-rouge">std</code> ä¸º <strong>å¼ é‡</strong>ã€‚</li>
</ul>

<h4 id="torchrandn"><code class="language-plaintext highlighter-rouge">torch.randn()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾ <code class="language-plaintext highlighter-rouge">size</code> ç”Ÿæˆ <strong>æ ‡å‡†æ­£æ€åˆ†å¸ƒ</strong> å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span>
    <span class="o">*</span><span class="n">size</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">size</code>ï¼šå¼ é‡çš„å½¢çŠ¶ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">out</code>ï¼šè¾“å‡ºçš„å¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">device</code>ï¼šæ‰€åœ¨è®¾å¤‡ï¼Œgpu / cpuã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">requires_grad</code>ï¼šæ˜¯å¦éœ€è¦æ¢¯åº¦ã€‚</li>
</ul>

<h4 id="torchrandn_like"><code class="language-plaintext highlighter-rouge">torch.randn_like()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä¾ <code class="language-plaintext highlighter-rouge">input</code> ç”Ÿæˆ <strong>æ ‡å‡†æ­£æ€åˆ†å¸ƒ</strong> å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">randn_like</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">intput</code>ï¼šåˆ›å»ºä¸ <code class="language-plaintext highlighter-rouge">input</code> åŒå½¢çŠ¶çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒå¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">dtype</code>ï¼šæ•°æ®ç±»å‹ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
</ul>

<h4 id="torchrand"><code class="language-plaintext highlighter-rouge">torch.rand()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šåœ¨åŒºé—´ [0, 1) ä¸Šï¼Œä¾ <code class="language-plaintext highlighter-rouge">size</code> ç”Ÿæˆ <strong>å‡åŒ€åˆ†å¸ƒ</strong> å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span>
    <span class="o">*</span><span class="n">size</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">size</code>ï¼šå¼ é‡çš„å½¢çŠ¶ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">out</code>ï¼šè¾“å‡ºçš„å¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">device</code>ï¼šæ‰€åœ¨è®¾å¤‡ï¼Œgpu / cpuã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">requires_grad</code>ï¼šæ˜¯å¦éœ€è¦æ¢¯åº¦ã€‚</li>
</ul>

<h4 id="torchrand_like"><code class="language-plaintext highlighter-rouge">torch.rand_like()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šåœ¨åŒºé—´ [0, 1) ä¸Šï¼Œä¾ <code class="language-plaintext highlighter-rouge">input</code> ç”Ÿæˆ <strong>å‡åŒ€åˆ†å¸ƒ</strong> å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">rand_like</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">intput</code>ï¼šåˆ›å»ºä¸ <code class="language-plaintext highlighter-rouge">input</code> åŒå½¢çŠ¶çš„ [0, 1) å‡åŒ€åˆ†å¸ƒå¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">dtype</code>ï¼šæ•°æ®ç±»å‹ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
</ul>

<h4 id="torchrandint"><code class="language-plaintext highlighter-rouge">torch.randint()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šåŒºé—´ [low, high) ä¸Šï¼Œä¾ <code class="language-plaintext highlighter-rouge">size</code> ç”Ÿæˆ <strong>æ•´æ•°å‡åŒ€åˆ†å¸ƒ</strong> å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span>
    <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">high</span><span class="p">,</span>
    <span class="n">size</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">low</code>ï¼šåŒºé—´ä¸‹ç•Œã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">high</code>ï¼šåŒºé—´ä¸Šç•Œã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">size</code>ï¼šå¼ é‡çš„å½¢çŠ¶ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">out</code>ï¼šè¾“å‡ºçš„å¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">device</code>ï¼šæ‰€åœ¨è®¾å¤‡ï¼Œgpu / cpuã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">requires_grad</code>ï¼šæ˜¯å¦éœ€è¦æ¢¯åº¦ã€‚</li>
</ul>

<h4 id="torchrandint_like"><code class="language-plaintext highlighter-rouge">torch.randint_like()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šåœ¨åŒºé—´ [low, high) ä¸Šï¼Œä¾ <code class="language-plaintext highlighter-rouge">input</code> ç”Ÿæˆ <strong>æ•´æ•°å‡åŒ€åˆ†å¸ƒ</strong> å¼ é‡ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">rand_like</span><span class="p">(</span>
    <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">high</span><span class="p">,</span>
    <span class="nb">input</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">low</code>ï¼šåŒºé—´ä¸‹ç•Œã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">high</code>ï¼šåŒºé—´ä¸Šç•Œã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">intput</code>ï¼šåˆ›å»ºä¸ <code class="language-plaintext highlighter-rouge">input</code> åŒå½¢çŠ¶çš„ [low, high) æ•´æ•°å‡åŒ€åˆ†å¸ƒå¼ é‡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">dtype</code>ï¼šæ•°æ®ç±»å‹ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">layout</code>ï¼šå†…å­˜ä¸­å¸ƒå±€å½¢å¼ã€‚</li>
</ul>

<h4 id="torchrandperm"><code class="language-plaintext highlighter-rouge">torch.randperm()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šç”Ÿæˆç”Ÿæˆä» 0 åˆ° n-1 çš„éšæœºæ’åˆ—å¼ é‡ï¼Œé€šå¸¸ç”¨æ¥ç”Ÿæˆä¹±åºçš„ç´¢å¼•ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">randperm</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">int64</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">n</code>ï¼šå¼ é‡çš„é•¿åº¦ã€‚</li>
</ul>

<h4 id="torchbernoulli"><code class="language-plaintext highlighter-rouge">torch.bernoulli()</code></h4>

<p><strong>åŠŸèƒ½</strong>ï¼šä»¥ <code class="language-plaintext highlighter-rouge">input</code> ä¸ºæ¦‚ç‡ï¼Œç”Ÿæˆä¼¯åŠªåŠ›åˆ†å¸ƒï¼ˆ0-1 åˆ†å¸ƒï¼Œä¸¤ç‚¹åˆ†å¸ƒï¼‰ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">torch</span><span class="p">.</span><span class="n">bernoulli</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">generator</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="bp">None</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">input</code>ï¼šæ¦‚ç‡å€¼ã€‚</li>
</ul>

<h2 id="3-æ€»ç»“">3. æ€»ç»“</h2>

<p>æœ¬èŠ‚è¯¾ä»‹ç»äº† PyTorch ä¸­çš„æ•°æ®ç»“æ„ â€”â€” å¼ é‡ (Tensor)ï¼Œå®ƒæ˜¯ PyTorch ä¸­æœ€åŸºç¡€çš„æ¦‚å¿µï¼Œå…¶å‚ä¸äº†æ•´ä¸ªè¿ç®—è¿‡ç¨‹ã€‚è¿™é‡Œæˆ‘ä»¬ä»‹ç»äº†å¼ é‡çš„æ¦‚å¿µå’Œå±æ€§ï¼Œå¦‚ <code class="language-plaintext highlighter-rouge">data</code>ã€<code class="language-plaintext highlighter-rouge">device</code>ã€<code class="language-plaintext highlighter-rouge">dtype</code> ç­‰ï¼Œå¹¶ä»‹ç»äº†å¼ é‡çš„åŸºæœ¬åˆ›å»ºæ–¹æ³•ï¼Œå¦‚ç›´æ¥åˆ›å»ºã€ä¾æ•°å€¼åˆ›å»ºå’Œä¾æ¦‚ç‡åˆ†å¸ƒåˆ›å»ºç­‰ã€‚</p>

<p>ä¸‹èŠ‚å†…å®¹ï¼šå¼ é‡æ“ä½œä¸çº¿æ€§å›å½’</p>
:ET