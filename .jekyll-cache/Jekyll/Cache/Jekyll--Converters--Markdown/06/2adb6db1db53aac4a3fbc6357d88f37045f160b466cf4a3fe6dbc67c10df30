I"ô<!-- æ•°å­¦å…¬å¼ -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>

<h1 id="lecture-09-å¹¿ä¹‰çº¿æ€§æ¨¡å‹glm">Lecture 09 å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGLMï¼‰</h1>
<p>æˆ‘ä»¬å·²ç»è§è¿‡äº†å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„ä¸€äº›ç‰¹ä¾‹ï¼Œå…¶ä¸­ï¼Œå“åº”å˜é‡ $Y$ æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æ›´åŠ å¹¿ä¹‰çš„æƒ…å†µï¼Œå“åº”å˜é‡ $Y$ ä¸å†æ˜¯æ­£æ€çš„ã€‚æœ¬ç« å°†åŒ…å«ä»¥ä¸‹ä¸‰éƒ¨åˆ†ï¼š</p>

<ul>
  <li>ä»‹ç»</li>
  <li>ä¼°è®¡</li>
  <li>æ¨æ–­</li>
</ul>

<h2 id="1-ä»‹ç»">1. ä»‹ç»</h2>
<p>ä»¤ $Y_1,Y_2,\dots,Y_n$ ä¸ºéšæœºå˜é‡ $Y$ çš„ç‹¬ç«‹è§‚æµ‹ï¼Œå…¶å…³è”çš„åå˜é‡å‘é‡ä¸º $\mathbf x_1,\mathbf x_2,\dots,\mathbf x_n$ã€‚</p>

<p>å¦‚æœéšæœºå˜é‡ $Y$ çš„è¿™äº›ç‹¬ç«‹è§‚æµ‹æœä»æ­£æ€åˆ†å¸ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨çº¿æ€§æ¨¡å‹æ¥å»ºç«‹éšæœºå˜é‡ $Y$ å’Œå…¶å…³è”çš„åå˜é‡ä¹‹é—´çš„è”ç³»ã€‚å¯¹äº $i=1,\dots,n$ï¼Œæˆ‘ä»¬æœ‰</p>

<script type="math/tex; mode=display">Y_i\overset{\mathrm{d}}{=}N(\mu_i,\sigma^2) \quad \text{å½¼æ­¤ç‹¬ç«‹ï¼Œå¹¶ä¸”} \quad \mu_i=\mathbf x_i^{\mathrm{T}}\boldsymbol \beta</script>

<p>å…¶ä¸­ï¼Œå“åº”å˜é‡ $Y_i$ çš„æœŸæœ› $\mu_i$ æ˜¯å…³äºåå˜é‡ $\mathbf x_i$ çš„çº¿æ€§å‡½æ•°ã€‚</p>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬è¯•å›¾å°†è¯¥æ¨¡å‹ä»æ­£æ€åˆ†å¸ƒæ¨å¹¿åˆ° <strong>æŒ‡æ•°æ—ï¼ˆexponential famil yï¼‰</strong> åˆ†å¸ƒï¼šæˆ‘ä»¬å‡è®¾</p>

<script type="math/tex; mode=display">Y_i\overset{\mathrm{d}}{=}\mathcal {EF}(\mathrm{mean}=\mu_i)  \quad \text{å½¼æ­¤ç‹¬ç«‹ï¼Œå¹¶ä¸”} \quad g(\mu_i)=\eta_i=\mathbf x_i^{\mathrm{T}}\boldsymbol \beta</script>

<p>å…¶ä¸­ï¼Œ$\eta_i=\mathbf x_i^{\mathrm{T}}\boldsymbol \beta$ æ˜¯ <strong>çº¿æ€§é¢„æµ‹å˜é‡ï¼ˆlinear predictorï¼‰</strong>ã€‚</p>

<p>å‡½æ•° $g(.)$ è¢«ç§°ä¸º <strong>è¿æ¥å‡½æ•°ï¼ˆlink functionï¼‰</strong>ï¼šå®ƒæä¾›äº†çº¿æ€§é¢„æµ‹å˜é‡å’Œå“åº” $Y$ çš„å‡å€¼ä¹‹é—´çš„è¿æ¥ã€‚</p>

<p>å¦‚æœ $g(\mu_i)$ è¢«è®¾ç½®ä¸ºç­‰äºæŒ‡æ•°æ—ä¸­çš„ <strong>å…¸èŒƒå‚æ•°ï¼ˆcanonical parameterï¼‰</strong>ï¼Œåˆç§° <strong>è‡ªç„¶å‚æ•°ï¼ˆnatural parameterï¼‰</strong>ï¼Œé‚£ä¹ˆï¼Œ$g(.)$ è¢«ç§°ä¸º <strong>è‡ªç„¶è¿æ¥ï¼ˆnatural linkï¼‰</strong> æˆ–è€… <strong>å…¸èŒƒè¿æ¥ï¼ˆcanonical linkï¼‰</strong>ã€‚</p>

<p><br /></p>

<p>å¦‚æœ $Y$ çš„åˆ†å¸ƒæ˜¯ <strong>å…¸èŒƒå½¢å¼ï¼ˆcanonical formï¼‰</strong>ï¼Œé‚£ä¹ˆï¼Œå®ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆpdfï¼‰$f(y\mid \theta,\phi)$ æ»¡è¶³</p>

<script type="math/tex; mode=display">\ln f(y\mid \theta,\phi)=\dfrac{y\theta-b(\theta)}{a(\phi)}+c(y,\phi)</script>

<p>å…¶ä¸­ï¼Œ$\theta$ è¢«ç§°ä¸º <strong>å…¸èŒƒå‚æ•°ï¼ˆcanonical parameterï¼‰</strong>æˆ–è€… <strong>è‡ªç„¶å‚æ•°ï¼ˆnatural parameterï¼‰</strong>ï¼Œä»£è¡¨äº† <strong>ä½ç½®ï¼ˆlocationï¼‰</strong>ï¼›è€Œ $\phi$ è¢«ç§°ä¸º <strong>æ•£å¸ƒå‚æ•°ï¼ˆdispersion parameterï¼‰</strong>ï¼Œä»£è¡¨äº† <strong>å°ºåº¦ï¼ˆscaleï¼‰</strong>ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šå‡½æ•° $a,b,c$ æ¥å®šä¹‰ä¸åŒçš„æŒ‡æ•°æ—åˆ†å¸ƒã€‚é€šå¸¸ï¼Œ$a(\phi)=\phi \big/ w$ï¼Œå…¶ä¸­ï¼Œ$w$ æ˜¯å·²çŸ¥çš„ <strong>æƒé‡ï¼ˆweightï¼‰</strong>ã€‚</p>

<p>å¯ä»¥æ¨å¯¼å‡º</p>

<script type="math/tex; mode=display">\dfrac{\partial \ln f(y\mid \theta,\phi)}{\partial \theta}=\dfrac{y-b'(\theta)}{a(\phi)}\;, \qquad \dfrac{\partial^2 \ln f(y\mid \theta,\phi)}{\partial \theta^2}=-\dfrac{b''(\theta)}{a(\phi)}</script>

<p><br /></p>

<p>å¦ä¸€æ–¹é¢ï¼Œ</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\mathbb{E}\left[\dfrac{\partial \ln f(y\mid \theta,\phi)}{\partial \theta} \right] &= \int \dfrac{\partial \ln f(y\mid \theta,\phi)}{\partial \theta} \cdot f(y\mid \theta,\phi)dy\\
&=\dfrac{\partial}{\partial \theta}\int f(y\mid \theta,\phi)dy=\dfrac{\partial}{\partial \theta}1=0\\\\

\mathbb{E}\left[\dfrac{\partial^2 \ln f(y\mid \theta,\phi)}{\partial \theta^2} \right] &= \int \dfrac{\partial}{\partial \theta} \left(\dfrac{f_{\theta}'(y\mid \theta,\phi)}{f(y\mid \theta,\phi)} \right)\cdot f(y\mid \theta,\phi)dy\\
&= \int f_{\theta}''(y\mid \theta,\phi)dy-\int \left(\dfrac{\partial \ln f(y\mid \theta,\phi)}{\partial \theta}\right)^2 f(y\mid \theta,\phi)dy\\
&= 0-\mathbb{E}\left[\left(\dfrac{\partial \ln f(y\mid \theta,\phi)}{\partial \theta} \right)^2\right]
\end{align} %]]></script>

<p>æ³¨æ„ï¼Œè¿™é‡Œæœ‰ä¸ªæŠ€å·§æ˜¯åˆ©ç”¨ $(\ln f)â€™=fâ€™\big/f$ çš„æ€§è´¨ã€‚</p>

<p><br /></p>

<p>ç»“åˆä¸Šé¢çš„æ¨å¯¼ï¼Œå¯ä»¥å¾—åˆ°</p>

<script type="math/tex; mode=display">\mu=\mathbb{E}(Y)=b'(\theta)\;, \qquad \sigma^2=\mathrm{var}(Y)=a(\phi)b''(\theta)</script>

<ul>
  <li>
    <p><strong>ä¾‹å­ï¼šæ³Šæ¾åˆ†å¸ƒ</strong><br />
å¦‚æœ $Y\overset{\mathrm d}{=}\mathrm{Poi}(\lambda)$ï¼Œé‚£ä¹ˆ $\ln f(y\mid \lambda)=-\lambda + y\ln \lambda - \ln y!$ï¼Œæ‰€ä»¥ $\theta=\ln \lambda$ã€‚</p>

    <p>å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ $\ln f(y\mid \lambda)=-e^{\theta}+y\theta-\ln y!$ï¼›æ‰€ä»¥ï¼Œ$b(\theta)=e^{\theta}$ï¼Œå¹¶ä¸” $a(\phi)=1$ã€‚</p>

    <p>ç”±ä¸Šé¢çš„ç»“æœå¯å¾—</p>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\mu &= \mathbb{E}(Y)=b'(\theta)=e^{\theta}=\lambda \\\\
\sigma^2 &= \mathrm{var}(Y)=a(\phi)b''(\theta)=e^{\theta}=\lambda
\end{align} %]]></script>
  </li>
  <li>
    <p><strong>ä¾‹å­ï¼šäºŒé¡¹åˆ†å¸ƒ</strong><br />
å¦‚æœ $Y\overset{\mathrm d}{=}\mathrm{Bin}(m,p)$ï¼Œé‚£ä¹ˆ $\ln f(y\mid m,p)=\text{const}+y\ln \frac{p}{1-p} + m\ln(1-p)$ï¼Œæ‰€ä»¥ $p=\frac{e^{\theta}}{1+e^{\theta}}$</p>

    <p>$\theta=\ln \frac{p}{1-p}$ï¼Œå¹¶ä¸” $b(\theta)=-m\ln(1-p)=m\ln(1+e^{\theta})$ã€‚</p>

    <p>å› æ­¤ï¼Œæˆ‘ä»¬æœ‰</p>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\mu &= \mathbb{E}(Y)=b'(\theta)=\dfrac{me^{\theta}}{1+e^{\theta}}=mp \\\\
\sigma^2 &= \mathrm{var}(Y)=a(\phi)b''(\theta)=\dfrac{me^{\theta}}{(1+e^{\theta})^2}=mp(1-p)
\end{align} %]]></script>
  </li>
</ul>

<p>ä¸‹èŠ‚å†…å®¹ï¼šå¯¼è®º (4)</p>
:ET