I"â)<h1 id="lecture-06-ä¸»æˆåˆ†åˆ†æ-ä¸‰">Lecture 06 ä¸»æˆåˆ†åˆ†æ (ä¸‰)</h1>

<p><strong>å‚è€ƒæ•™æ</strong>ï¼š</p>

<ul>
  <li><em>Hardle, W. and Simar, L (2015). Applied multivariate statistical analysis, 4th edition.</em></li>
  <li><em>Hastie, T. Tibshirani, R. and Friedman, J. (2009). The elements of statistical learning, 2nd edition</em></li>
</ul>

<h2 id="1-ä¸»æˆåˆ†å›å½’">1. ä¸»æˆåˆ†å›å½’</h2>

<p>åœ¨ä¸ŠèŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† <strong>ä¸»æˆåˆ†å›å½’ (principal component regression, PCR)</strong> (å‚è§æ•™æ <em>Elements of Statistical Learning, section 3.5</em>)ï¼Œä¸‹é¢æˆ‘ä»¬å¯¹å…¶è¿›è¡Œä¸€äº›ç®€å•çš„å›é¡¾ï¼š</p>

<p>å¯¹äºä¸­å¿ƒåŒ–çš„ $\underbrace{Z}_{1\times 1}$ å’Œ $\underbrace{X}_{p\times 1}$ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å›å½’æ¨¡å‹</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
Z &= \beta^{\mathrm T}X + \epsilon \\[2ex]
&= \beta^{\mathrm T}\Gamma Y + \epsilon \\[2ex]
&= \beta^{\mathrm T}\underbrace{\Gamma_{(1)}}_{p\times q} \underbrace{Y_{(1)}}_{q\times 1} + \beta^{\mathrm T} \underbrace{\Gamma_{(2)}}_{p\times (p-q)\;} \underbrace{Y_{(2)}}_{\;(p-q)\times 1} + \epsilon
\end{align} %]]></script>

<p>ç”¨ä»¥ä¸‹æ¨¡å‹è¿‘ä¼¼</p>

<script type="math/tex; mode=display">Z = \beta_{\mathrm{PC}}^{\mathrm T} Y_{(1)} + \eta</script>

<p>å¹¶ä¸”æˆ‘ä»¬ç›¸ä¿¡æ¥è‡ª $Y_{(2)}$ çš„å¯å˜æ€§æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ (å³ $X\approx \Gamma_{(1)}Y_{(1)}$)ã€‚</p>

<p>å½“ç„¶ï¼Œåœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬åªèƒ½åŸºäºæ ·æœ¬åæ–¹å·®çŸ©é˜µ $S$ è·å¾— $\Gamma$ å’Œ $Y$ çš„ â€œç»éªŒç‰ˆæœ¬â€ã€‚åŸºäºä¸€èˆ¬çš„æœ€å°äºŒä¹˜å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºä¸€ä¸ª $\hat \beta_{\mathrm{PC}}$ ä¼°è®¡ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°† $\beta$ çš„ â€œPCR ä¼°è®¡â€ å®šä¹‰ä¸º</p>

<script type="math/tex; mode=display">\hat \beta^{\mathrm{PCR}}(q) = \hat \Gamma_{(1)} \hat \beta_{\mathrm{PC}}</script>

<p>å…¶ä¸­ï¼Œ$\hat \Gamma_{(1)}$ æ˜¯ $\Gamma_{(1)}$ åœ¨å®è·µä¸­çš„ä¼°è®¡ç‰ˆæœ¬ã€‚</p>

<p>å›å¿†ä¸€ä¸‹ï¼Œå¦‚æœ $\mathcal X^{\mathrm T}\mathcal X$ æ˜¯å¯é€†çš„ä½†ç‰¹å¾å€¼è¾ƒå°ï¼Œé‚£ä¹ˆ</p>

<script type="math/tex; mode=display">\hat \beta_{\mathrm{LS}} = (\mathcal X^{\mathrm T}\mathcal X)^{-1}\mathcal X^{\mathrm T} \mathcal Z</script>

<p>å¯ä»¥å…·æœ‰è¾ƒå¤§çš„ (å) æ–¹å·®ã€‚</p>

<p>å¯ä»¥è¯æ˜ï¼Œå½“ $q &lt; p$ æ—¶ï¼Œ</p>

<script type="math/tex; mode=display">\mathrm{Cov}(\hat \beta_{\mathrm{LS}}) - \mathrm{Cov}(\hat \beta^{\mathrm{PCR}}(q)) \ge 0</script>

<p>(å›å¿†ä¸€ä¸‹ï¼Œè¿™æ„å‘³ç€ â€œæ­£å®šâ€)</p>

<p>å‚è§ <a href="https://en.wikipedia.org/wiki/Principal_component_regression">https://en.wikipedia.org/wiki/Principal_component_regression</a></p>

<p>ä½†æ˜¯è¯·æ³¨æ„ï¼Œä¸ $\hat \beta_{\mathrm{LS}}$ ä¸åŒï¼Œ$\hat \beta^{\mathrm{PCR}}(q))$ æ˜¯æœ‰åçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡å¢åŠ ä¸€äº›åå·®ä¸ºä»£ä»·ï¼Œå‡å°äº†ä¼°è®¡é‡çš„æ–¹å·®ã€‚</p>

<h2 id="2-åæœ€å°äºŒä¹˜æ³•">2. åæœ€å°äºŒä¹˜æ³•</h2>

<p>è€ƒè™‘ä¸€ä¸ªå…·æœ‰ $E(X)=0$ å’Œ $E(Z)=0$ çš„çº¿æ€§å›å½’æ¨¡å‹ï¼š</p>

<script type="math/tex; mode=display">Z=m(X) + \epsilon\; , \quad m(x)= E(Z\mid X=x) =  \beta^{\mathrm T}x</script>

<p>å…¶ä¸­ï¼Œ$\beta$ã€$X=(X_1,\dots,X_p)^{\mathrm T}$ å’Œ $x$ éƒ½æ˜¯ $p$ ç»´å‘é‡ï¼Œå¹¶ä¸” $\beta$ æ˜¯æœªçŸ¥çš„ã€‚</p>

<p>åœ¨ PCA ä¸­ï¼Œæˆ‘ä»¬æ„é€ äº†ä¸€ä¸ªå…³äº $X_j$ çš„ç‰¹å®šçº¿æ€§ç»„åˆï¼š</p>

<script type="math/tex; mode=display">Y_j = \gamma_j^{\mathrm T}X \, , \;\; Y=\Gamma^{\mathrm T}X</script>

<p>å…¶ä¸­ï¼Œæƒé‡çŸ©é˜µ $\Gamma$ ä»…ä»…é€šè¿‡ $\Sigma=\mathrm{Var}(X)$ æ„é€ ã€‚</p>

<p>æˆ‘ä»¬å¸Œæœ›å‰å‡ ä¸ª $Y_j$ åŒ…å« <strong>å…³äº $X$</strong> çš„å¤§éƒ¨åˆ†ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬å–ä»¥ä¸‹è¿‘ä¼¼ï¼š</p>

<script type="math/tex; mode=display">m(x) = \beta^{\mathrm T}x \approx m_{\mathrm{PC}}(y_{(1)}) = \beta_{\mathrm{PC}}^{\mathrm T}y_{(1)}</script>

<p><strong>é—®é¢˜</strong>ï¼šè¿™ç§æ–¹å¼åˆ†è§£å¾—åˆ°çš„è¿ç»­ PC $Y_1,\dots,Y_p$ ä»…åŸºäº $\mathrm{Var}(X)$ çš„ç‰¹å¾å‘é‡ï¼Œè€Œå®Œå…¨å¿½ç•¥äº† $Z$ã€‚</p>

<p>åœ¨ <strong>åæœ€å°äºŒä¹˜æ³• (partial least squares, PLS)</strong> ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©å°† $X$ åˆ†è§£ä¸ºè¿ç»­çš„çº¿æ€§æŠ•å½±</p>

<script type="math/tex; mode=display">T_1,T_2,\dots,T_p</script>

<p>å¹¶ä¸”å®ƒä»¬è¯•å›¾ä¿ç•™ <strong>å…³äº $Z$ å’Œ $X$ ä¹‹é—´å…³ç³»</strong> çš„å¤§éƒ¨åˆ†ä¿¡æ¯ã€‚</p>

<p>ç”±äºæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡ $X$ å’Œ $Z$ ä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤è¿™ç§æ–¹æ³•ä¼¼ä¹è¦æ›´å¥½ä¸€äº›ã€‚</p>

<ul>
  <li>
    <p>åœ¨ PCA ä¸­ï¼Œç¬¬ä¸€ä¸ªæˆåˆ† $Y_1$ é€šè¿‡ä¸‹å¼æ„é€ ï¼š</p>

    <script type="math/tex; mode=display">Y_1 = \gamma_1^{\mathrm T} X</script>

    <p>å…¶ä¸­ï¼Œ<script type="math/tex">\|\gamma_1\| = 1</script>ï¼Œå¹¶ä¸” $\mathrm{Var}(Y_1)$ å°½å¯èƒ½å¤§ã€‚</p>

    <p><br /></p>
  </li>
  <li>
    <p>åœ¨ PLS ä¸­ï¼Œç¬¬ä¸€ä¸ªæˆåˆ† $T_1$ é€šè¿‡ä¸‹å¼æ„é€ ï¼š</p>

    <script type="math/tex; mode=display">T_1 = \phi_1^{\mathrm T} X</script>

    <p>å…¶ä¸­ï¼Œ$\|\phi_1 \| = 1$ï¼Œå¹¶ä¸” $|\mathrm{Cov}(Z,T_1) |$ å°½å¯èƒ½å¤§ã€‚</p>

    <p><strong>æ³¨æ„</strong>ï¼š$Z$ å’Œ $T_1$ éƒ½æ˜¯ $1$ ç»´çš„ï¼Œè€Œ $\phi_1$ æ˜¯ä¸€ä¸ª $p$ ç»´å‘é‡ã€‚</p>

    <p><br /></p>
  </li>
  <li>
    <p>ç„¶åï¼Œå¯¹äº $k=2,\dots,p$ï¼Œç¬¬ $k$ ä¸ªæˆåˆ† $T_k$ é€šè¿‡ä¸‹å¼æ„é€ ï¼š</p>

    <script type="math/tex; mode=display">T_k = \phi_k^{\mathrm T} X</script>

    <p>å…¶ä¸­ï¼Œ$\|\phi_k \| = 1$ï¼Œ</p>

    <script type="math/tex; mode=display">\phi_k^{\mathrm T} \Sigma \phi_j =0 \quad \text{for}\; j=1,\dots,k-1</script>

    <p>å¹¶ä¸” $|\mathrm{Cov}(Z,T_k) |$ å°½å¯èƒ½å¤§ã€‚</p>

    <p><strong>æ³¨æ„</strong>ï¼š$Z$ å’Œ $T_k$ éƒ½æ˜¯ $1$ ç»´çš„ï¼Œè€Œ $\phi_k$ æ˜¯ä¸€ä¸ª $p$ ç»´å‘é‡ã€‚</p>
  </li>
</ul>

<p>$X$ åœ¨ $T_j$ ä¸Šçš„æŠ•å½±è¢«æ„é€ ä¸ºä»ç„¶ä¿æŒ $X$ çš„çº¿æ€§ç»„åˆçš„å½¢å¼ï¼Œå¹¶ä¸”è¿™äº›çº¿æ€§ç»„åˆè§£é‡Šäº† $Z$ å’Œ $X$ ä¹‹é—´çš„å¤§éƒ¨åˆ†çº¿æ€§å…³ç³»ã€‚</p>

<p>ä»¤ $\Phi = (\phi_1,\dots,\phi_p)$ ä¸ºä¸€ä¸ª $p\times p$ çš„çŸ©é˜µã€‚æˆ‘ä»¬å¸Œæœ› $p$ ç»´å‘é‡ $T=(T_1,\dots,T_p)^{\mathrm T} = \Phi^{\mathrm T}X$ çš„å‰å‡ ä¸ª (ä¾‹å¦‚å‰ $q$ ä¸ª) æˆåˆ†åŒ…å«äº†ä¸ $X$ ç›¸å…³å¹¶ä¸”èƒ½å¤Ÿç”¨äºä¼°è®¡ $X$ å’Œ $Z$ ä¹‹é—´çº¿æ€§å…³ç³» $m(X)$ çš„å¤§éƒ¨åˆ†ä¿¡æ¯ã€‚</p>

<p>ç„¶åï¼Œæˆ‘ä»¬å¯¹ $T_1,\dots,T_q$ (è€Œä¸æ˜¯å¯¹ $X_1,\dots,X_p$) è¿›è¡Œçº¿æ€§å›å½’ã€‚</p>

<p>ç‰¹åˆ«åœ°ï¼Œå›å¿†ä¸€ä¸‹ï¼Œå¯¹äº $x$ã€$X$ å’Œ $\beta \in \mathbb R^p$ï¼Œæˆ‘ä»¬çš„çº¿æ€§æ¨¡å‹ä¸º</p>

<script type="math/tex; mode=display">m(x) = E(Z\mid X=x) = \beta^{\mathrm T}x</script>

<p>å°† $p$ ç»´å‘é‡ $t$ å®šä¹‰ä¸º</p>

<script type="math/tex; mode=display">t=(t_1,\dots,t_p)^{\mathrm T} =\Phi^{\mathrm T} x</script>

<p>å¹¶ä¸”å¯¹äº $q &lt; p$ï¼Œå®šä¹‰ $q$ ç»´å‘é‡</p>

<script type="math/tex; mode=display">T_{(1)} = (T_1,\dots,T_q)^{\mathrm T} \quad \text{and} \quad t_{(1)} = (t_1,\dots,t_q)^{\mathrm T}</script>

<p>æˆ‘ä»¬é‡‡ç”¨ä»¥ä¸‹è¿‘ä¼¼ï¼š</p>

<script type="math/tex; mode=display">m(x) = \beta^{\mathrm T}x \approx E(Z\mid T_{(1)}=t_{(1)}) \equiv m_{\mathrm{PLS}}(t_{(1)}) = \beta_{\mathrm{PLS}}^{\mathrm T} t_{(1)}</script>

<p>$\beta_{\mathrm{PLS}}$ çš„æœ€å°äºŒä¹˜ä¼°è®¡é‡ç­‰äº</p>

<script type="math/tex; mode=display">\hat \beta_{\mathrm{PLS}} =\mathop{\operatorname{arg\,min}}\limits_{b\in \mathbb R^q} \sum_{i=1}^{n}(Z_i - b^{\mathrm T} T_{(1),i})^2 = (\mathcal T_{(1)}^{\mathrm T}\mathcal T_{(1)})^{-1} \mathcal T_{(1)}^{\mathrm T} \mathcal Z</script>

<p>å…¶ä¸­ï¼Œ$\mathcal Z=(Z_1,\dots,Z_n)^{\mathrm T}$ æ˜¯ä¸€ä¸ª $n$ ç»´å‘é‡ï¼Œè€Œ</p>

<script type="math/tex; mode=display">T_{(1),i} = (T_{i1},\dots,T_{iq})^{\mathrm T}</script>

<p>æ˜¯ä¸€ä¸ª $q$ ç»´å‘é‡ï¼Œå¯¹åº”äºç¬¬ $i$ ä¸ªä¸ªä½“ï¼Œå¹¶ä¸”</p>

<script type="math/tex; mode=display">% <![CDATA[
\mathcal T_{(1)} = \begin{pmatrix}T_{11} & \cdots & T_{1q} \\ \vdots & \ddots & \vdots \\ T_{n1} & \cdots & T_{nq}\end{pmatrix} %]]></script>

<p>å’Œ PCA ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡äº¤å‰éªŒè¯æ¥é€‰æ‹© $q$ï¼š</p>

<script type="math/tex; mode=display">q=\mathop{\operatorname{arg\,min}}\limits_{k=1,\dots,p} CV(k)</script>

<p>å…¶ä¸­ï¼Œ</p>

<script type="math/tex; mode=display">CV(k) = \sum_{i=1}^{n} \{Z_i - \hat \beta_{\mathrm{PLS},k}^{-i} T_{(1),i}\}^2</script>

<p>å¹¶ä¸” $\hat \beta_{\mathrm{PLS},k}^{-i}$ è¡¨ç¤º $\beta_{\mathrm{PLS}}$ çš„ LS ä¼°è®¡é‡</p>

<p>è¡¨ç¤ºæŒ‰ç…§ä¸Šé¢å…¬å¼å– $q=k$ è®¡ç®—å‡ºçš„ $\beta_{\mathrm{PLS}}$ çš„ LS ä¼°è®¡é‡ï¼Œåªæ˜¯è¿™é‡Œæˆ‘ä»¬å°†ç¬¬ $i$ ä¸ªä¸ªä½“ä» $\mathcal Z$ å’Œ $\mathcal T_{(1)}$ ä¸­ç§»é™¤äº†ã€‚</p>

<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åœ¨æ€»ä½“çº§åˆ«ä¸Šå±•ç¤ºäº† PLS çš„æ‰€æœ‰å†…å®¹ã€‚è¯·å‚é˜… ESL ä¸­çš„ç®—æ³• 3.3ï¼Œä»¥äº†è§£åœ¨å®è·µä¸­å¦‚ä½•å®ç° PLS (ç»éªŒç‰ˆæœ¬)ã€‚</p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-21-WX20201121-235639%402x.png" width="80%" /></p>

<h2 id="3-è®¨è®ºpca-vs-pls">3. è®¨è®ºï¼šPCA vs. PLS</h2>

<p>PCA å’Œ PLS ä¹Ÿå¯ä»¥ç”¨äºéçº¿æ€§å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥å°† $m(x) = E(Z\mid X=x)$ è¿‘ä¼¼ä¸ºï¼š</p>

<script type="math/tex; mode=display">m_{\mathrm{PLS}}(t_{(1)}) = E(Z\mid T_{(1)} = t_{(1)}) \quad \text{or} \quad m_{\mathrm{PC}}(y_{(1)}) = E(Z\mid Y_{(1)} = y_{(1)})</script>

<p>å¯¹äºå›å½’ä¼°è®¡ï¼Œå¦‚å‰æ‰€è¿°ï¼Œé€šè¿‡ PLS é™ç»´é€šå¸¸è¦æ¯”é€šè¿‡ PCA é™ç»´æ›´å¥½ã€‚</p>

<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œè¦ä¹ˆ $m_{\mathrm{PLS}}(t_{(1)})$ æ¯” $m_{\mathrm{PC}}(y_{(1)})$ å¯¹ $m(x)$ è¿‘ä¼¼å¾—æ›´å¥½ï¼Œæˆ–è€…å¦‚æœå®ƒä»¬è¾¾åˆ°ç›¸åŒçš„è¿‘ä¼¼æ•ˆæœï¼Œé‚£ä¹ˆ PLS ä½¿ç”¨çš„æˆåˆ†æ•°é‡é€šå¸¸è¦æ¯” PC ä½¿ç”¨çš„æˆåˆ†æ•°é‡æ›´å°‘ $\quad \Longrightarrow \quad$ è®¡ç®—æ•ˆç‡æ›´é«˜ã€‚</p>

<h3 id="ä¾‹å­éŸ³ç´ æ•°æ®-phoneme-data">ä¾‹å­ï¼šéŸ³ç´ æ•°æ® (Phoneme data)</h3>

<p>æ¥æºï¼š<a href="http://www-stat.stanford.edu/ElemStatLearn">http://www-stat.stanford.edu/ElemStatLearn</a></p>

<p>$X_i \in \mathbb R^{256}$ ä»£è¡¨ç”±éŸ³ç´  â€œaaâ€ (ä¾‹å¦‚ â€œdarkâ€) å’Œ â€œaoâ€ (ä¾‹å¦‚â€œwaterâ€) å½•éŸ³æ„æˆçš„å¯¹æ•°å‘¨æœŸã€‚</p>

<p>å¯¹äºæ¯ä¸ª $i$ï¼Œæˆ‘ä»¬å°† $Z_i$ æ¨¡æ‹Ÿä¸º</p>

<script type="math/tex; mode=display">Z_i = m(X_i) + \epsilon_i = \beta^{\mathrm T}X_i + \epsilon_i</script>

<p>å…¶ä¸­ï¼Œ$\epsilon_i \sim N(0,\sigma^2)$ï¼Œå¹¶ä¸”å¯¹äºæ„é€ çš„å„ç§ $p$ ç»´å‘é‡ $\beta$ï¼Œä½¿å¾— $X$ å’Œ $Z$ ä¹‹é—´çš„æ‰€æœ‰äº¤äº’ä½œç”¨ä»…å–å†³äº 5 ä¸ªPC (å…¶ä½™ä¸èµ·ä½œç”¨)ã€‚</p>

<p>æ³¨æ„ï¼šå›å¿†ä¸€ä¸‹ï¼Œ$X_i =\Gamma Y_i$ï¼Œå› æ­¤é€šè¿‡é€‰æ‹©åˆé€‚çš„ $\beta$ï¼Œå¯ä»¥ä½¿å¾— $\beta^{\mathrm T}\Gamma$ ä»…å…·æœ‰äº”ä¸ªéé›¶åæ ‡ã€‚</p>

<ul>
  <li>æƒ…å†µ (i)ï¼šä¿¡æ¯åŒ…å«åœ¨å‰ 5 ä¸ª PC ä¸­</li>
  <li>æƒ…å†µ (ii)ï¼šä¿¡æ¯åŒ…å«åœ¨ç¬¬ 6 åˆ°ç¬¬ 1o ä¸ª PC ä¸­</li>
  <li>æƒ…å†µ (i)ï¼šä¿¡æ¯åŒ…å«åœ¨å‰ 5 ä¸ª PC ä¸­</li>
  <li>æƒ…å†µ (i)ï¼šä¿¡æ¯åŒ…å«åœ¨å‰ 5 ä¸ª PC ä¸­</li>
</ul>

<p><span style="margin:auto; display:table; font-size:10pt"> <span style="color:steelblue;font-weight:bold">è¡¨ 1</span>ï¼šç‘å£«çº¸å¸æ•°æ®ï¼šç‰¹å¾å€¼ã€è§£é‡Šæ–¹å·®æ¯”ä¾‹å’Œç´¯ç§¯æ¯”ä¾‹ã€‚</span></p>

<p><img src="http://andy-blog.oss-cn-beijing.aliyuncs.com/blog/2020-11-20-WX20201120-144300%402x.png" width="65%" /></p>

<p>ä¸‹èŠ‚å†…å®¹ï¼šå› å­åˆ†æ</p>

:ET